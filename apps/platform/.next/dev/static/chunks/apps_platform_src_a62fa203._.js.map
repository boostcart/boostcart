{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/bobkata/Projects/boostcart/apps/platform/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\";\n\nimport { cn } from \"@/lib/utils\";\n\nconst Card = React.forwardRef<\n\tHTMLDivElement,\n\tReact.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n\t<div\n\t\tref={ref}\n\t\tclassName={cn(\n\t\t\t\"rounded-lg border bg-card text-card-foreground shadow-sm\",\n\t\t\tclassName,\n\t\t)}\n\t\t{...props}\n\t/>\n));\nCard.displayName = \"Card\";\n\nconst CardHeader = React.forwardRef<\n\tHTMLDivElement,\n\tReact.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n\t<div\n\t\tref={ref}\n\t\tclassName={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n\t\t{...props}\n\t/>\n));\nCardHeader.displayName = \"CardHeader\";\n\nconst CardTitle = React.forwardRef<\n\tHTMLDivElement,\n\tReact.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n\t<div\n\t\tref={ref}\n\t\tclassName={cn(\n\t\t\t\"text-2xl font-semibold leading-none tracking-tight\",\n\t\t\tclassName,\n\t\t)}\n\t\t{...props}\n\t/>\n));\nCardTitle.displayName = \"CardTitle\";\n\nconst CardDescription = React.forwardRef<\n\tHTMLDivElement,\n\tReact.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n\t<div\n\t\tref={ref}\n\t\tclassName={cn(\"text-sm text-muted-foreground\", className)}\n\t\t{...props}\n\t/>\n));\nCardDescription.displayName = \"CardDescription\";\n\nconst CardContent = React.forwardRef<\n\tHTMLDivElement,\n\tReact.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n\t<div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n));\nCardContent.displayName = \"CardContent\";\n\nconst CardFooter = React.forwardRef<\n\tHTMLDivElement,\n\tReact.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n\t<div\n\t\tref={ref}\n\t\tclassName={cn(\"flex items-center p-6 pt-0\", className)}\n\t\t{...props}\n\t/>\n));\nCardFooter.displayName = \"CardFooter\";\n\nexport {\n\tCard,\n\tCardHeader,\n\tCardFooter,\n\tCardTitle,\n\tCardDescription,\n\tCardContent,\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,qBAAO,2KAAgB,MAG3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC3B,6LAAC;QACA,KAAK;QACL,WAAW,IAAA,gJAAE,EACZ,4DACA;QAEA,GAAG,KAAK;;;;;;;AAGX,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,2KAAgB,OAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC3B,6LAAC;QACA,KAAK;QACL,WAAW,IAAA,gJAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGX,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,2KAAgB,OAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC3B,6LAAC;QACA,KAAK;QACL,WAAW,IAAA,gJAAE,EACZ,sDACA;QAEA,GAAG,KAAK;;;;;;;AAGX,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,2KAAgB,OAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC3B,6LAAC;QACA,KAAK;QACL,WAAW,IAAA,gJAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGX,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC3B,6LAAC;QAAI,KAAK;QAAK,WAAW,IAAA,gJAAE,EAAC,YAAY;QAAa,GAAG,KAAK;;;;;;;AAE/D,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,2KAAgB,QAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC3B,6LAAC;QACA,KAAK;QACL,WAAW,IAAA,gJAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;;AAGX,WAAW,WAAW,GAAG"}},
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"sources":["file:///Users/bobkata/Projects/boostcart/apps/platform/src/components/ui/select.tsx"],"sourcesContent":["\"use client\";\n\nimport { cva, type VariantProps } from \"class-variance-authority\";\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\";\nimport { Select as SelectPrimitive } from \"radix-ui\";\nimport * as React from \"react\";\nimport { isValidElement, type ReactNode } from \"react\";\nimport { cn } from \"@/lib/utils\";\n\n// Create a Context for `indicatorPosition` and `indicator` control\nconst SelectContext = React.createContext<{\n\tindicatorPosition: \"left\" | \"right\";\n\tindicatorVisibility: boolean;\n\tindicator: ReactNode;\n}>({ indicatorPosition: \"left\", indicator: null, indicatorVisibility: true });\n\n// Root Component\nconst Select = ({\n\tindicatorPosition = \"left\",\n\tindicatorVisibility = true,\n\tindicator,\n\t...props\n}: {\n\tindicatorPosition?: \"left\" | \"right\";\n\tindicatorVisibility?: boolean;\n\tindicator?: ReactNode;\n} & React.ComponentProps<typeof SelectPrimitive.Root>) => {\n\tconst contextValue = React.useMemo(\n\t\t() => ({ indicatorPosition, indicatorVisibility, indicator }),\n\t\t[indicatorPosition, indicatorVisibility, indicator],\n\t);\n\n\treturn (\n\t\t<SelectContext.Provider value={contextValue}>\n\t\t\t<SelectPrimitive.Root {...props} />\n\t\t</SelectContext.Provider>\n\t);\n};\n\nfunction SelectGroup({\n\t...props\n}: React.ComponentProps<typeof SelectPrimitive.Group>) {\n\treturn <SelectPrimitive.Group data-slot=\"select-group\" {...props} />;\n}\n\nfunction SelectValue({\n\t...props\n}: React.ComponentProps<typeof SelectPrimitive.Value>) {\n\treturn <SelectPrimitive.Value data-slot=\"select-value\" {...props} />;\n}\n\n// Define size variants for SelectTrigger\nconst selectTriggerVariants = cva(\n\t`\n    flex bg-background w-full items-center justify-between outline-none border border-input shadow-xs shadow-black/5 transition-shadow \n    text-foreground data-placeholder:text-muted-foreground focus-visible:border-ring focus-visible:outline-none focus-visible:ring-[3px] \n    focus-visible:ring-ring/30 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1 \n    aria-invalid:border-destructive/60 aria-invalid:ring-destructive/10 dark:aria-invalid:border-destructive dark:aria-invalid:ring-destructive/20\n    [[data-invalid=true]_&]:border-destructive/60 [[data-invalid=true]_&]:ring-destructive/10  dark:[[data-invalid=true]_&]:border-destructive dark:[[data-invalid=true]_&]:ring-destructive/20\n  `,\n\t{\n\t\tvariants: {\n\t\t\tsize: {\n\t\t\t\tsm: \"h-7 px-2.5 text-xs gap-1 rounded-md\",\n\t\t\t\tmd: \"h-8.5 px-3 text-[0.8125rem] leading-(--text-sm--line-height) gap-1 rounded-md\",\n\t\t\t\tlg: \"h-10 px-4 text-sm gap-1.5 rounded-md\",\n\t\t\t},\n\t\t},\n\t\tdefaultVariants: {\n\t\t\tsize: \"md\",\n\t\t},\n\t},\n);\n\nexport interface SelectTriggerProps\n\textends React.ComponentProps<typeof SelectPrimitive.Trigger>,\n\t\tVariantProps<typeof selectTriggerVariants> {}\n\nfunction SelectTrigger({\n\tclassName,\n\tchildren,\n\tsize,\n\t...props\n}: SelectTriggerProps) {\n\treturn (\n\t\t<SelectPrimitive.Trigger\n\t\t\tdata-slot=\"select-trigger\"\n\t\t\tclassName={cn(selectTriggerVariants({ size }), className)}\n\t\t\t{...props}\n\t\t>\n\t\t\t{children}\n\t\t\t<SelectPrimitive.Icon asChild>\n\t\t\t\t<ChevronDown className=\"h-4 w-4 opacity-60 -me-0.5\" />\n\t\t\t</SelectPrimitive.Icon>\n\t\t</SelectPrimitive.Trigger>\n\t);\n}\n\nfunction SelectScrollUpButton({\n\tclassName,\n\t...props\n}: React.ComponentProps<typeof SelectPrimitive.ScrollUpButton>) {\n\treturn (\n\t\t<SelectPrimitive.ScrollUpButton\n\t\t\tdata-slot=\"select-scroll-up-button\"\n\t\t\tclassName={cn(\n\t\t\t\t\"flex cursor-default items-center justify-center py-1\",\n\t\t\t\tclassName,\n\t\t\t)}\n\t\t\t{...props}\n\t\t>\n\t\t\t<ChevronUp className=\"h-4 w-4\" />\n\t\t</SelectPrimitive.ScrollUpButton>\n\t);\n}\n\nfunction SelectScrollDownButton({\n\tclassName,\n\t...props\n}: React.ComponentProps<typeof SelectPrimitive.ScrollDownButton>) {\n\treturn (\n\t\t<SelectPrimitive.ScrollDownButton\n\t\t\tdata-slot=\"select-scroll-down-button\"\n\t\t\tclassName={cn(\n\t\t\t\t\"flex cursor-default items-center justify-center py-1\",\n\t\t\t\tclassName,\n\t\t\t)}\n\t\t\t{...props}\n\t\t>\n\t\t\t<ChevronDown className=\"h-4 w-4\" />\n\t\t</SelectPrimitive.ScrollDownButton>\n\t);\n}\n\nfunction SelectContent({\n\tclassName,\n\tchildren,\n\tposition = \"popper\",\n\t...props\n}: React.ComponentProps<typeof SelectPrimitive.Content>) {\n\treturn (\n\t\t<SelectPrimitive.Portal>\n\t\t\t<SelectPrimitive.Content\n\t\t\t\tdata-slot=\"select-content\"\n\t\t\t\tclassName={cn(\n\t\t\t\t\t\"relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-border bg-popover shadow-md shadow-black/5 text-secondary-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n\t\t\t\t\tposition === \"popper\" &&\n\t\t\t\t\t\t\"data-[side=bottom]:translate-y-1.5 data-[side=left]:-translate-x-1.5 data-[side=right]:translate-x-1.5 data-[side=top]:-translate-y-1.5\",\n\t\t\t\t\tclassName,\n\t\t\t\t)}\n\t\t\t\tposition={position}\n\t\t\t\t{...props}\n\t\t\t>\n\t\t\t\t<SelectScrollUpButton />\n\t\t\t\t<SelectPrimitive.Viewport\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\"p-1.5\",\n\t\t\t\t\t\tposition === \"popper\" &&\n\t\t\t\t\t\t\t\"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\",\n\t\t\t\t\t)}\n\t\t\t\t>\n\t\t\t\t\t{children}\n\t\t\t\t</SelectPrimitive.Viewport>\n\t\t\t\t<SelectScrollDownButton />\n\t\t\t</SelectPrimitive.Content>\n\t\t</SelectPrimitive.Portal>\n\t);\n}\n\nfunction SelectLabel({\n\tclassName,\n\t...props\n}: React.ComponentProps<typeof SelectPrimitive.Label>) {\n\treturn (\n\t\t<SelectPrimitive.Label\n\t\t\tdata-slot=\"select-label\"\n\t\t\tclassName={cn(\n\t\t\t\t\"py-1.5 ps-8 pe-2 text-xs text-muted-foreground font-medium\",\n\t\t\t\tclassName,\n\t\t\t)}\n\t\t\t{...props}\n\t\t/>\n\t);\n}\n\nfunction SelectItem({\n\tclassName,\n\tchildren,\n\t...props\n}: React.ComponentProps<typeof SelectPrimitive.Item>) {\n\tconst { indicatorPosition, indicatorVisibility, indicator } =\n\t\tReact.useContext(SelectContext);\n\n\treturn (\n\t\t<SelectPrimitive.Item\n\t\t\tdata-slot=\"select-item\"\n\t\t\tclassName={cn(\n\t\t\t\t\"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 text-sm outline-hidden text-foreground hover:bg-accent focus:bg-accent data-disabled:pointer-events-none data-disabled:opacity-50\",\n\t\t\t\tindicatorPosition === \"left\" ? \"ps-8 pe-2\" : \"pe-8 ps-2\",\n\t\t\t\tclassName,\n\t\t\t)}\n\t\t\t{...props}\n\t\t>\n\t\t\t{indicatorVisibility &&\n\t\t\t\t(indicator && isValidElement(indicator) ? (\n\t\t\t\t\tindicator\n\t\t\t\t) : (\n\t\t\t\t\t<span\n\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\"absolute flex h-3.5 w-3.5 items-center justify-center\",\n\t\t\t\t\t\t\tindicatorPosition === \"left\" ? \"start-2\" : \"end-2\",\n\t\t\t\t\t\t)}\n\t\t\t\t\t>\n\t\t\t\t\t\t<SelectPrimitive.ItemIndicator>\n\t\t\t\t\t\t\t<Check className=\"h-4 w-4 text-primary\" />\n\t\t\t\t\t\t</SelectPrimitive.ItemIndicator>\n\t\t\t\t\t</span>\n\t\t\t\t))}\n\t\t\t<SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n\t\t</SelectPrimitive.Item>\n\t);\n}\n\nfunction SelectIndicator({\n\tchildren,\n\tclassName,\n\t...props\n}: React.ComponentProps<typeof SelectPrimitive.ItemIndicator>) {\n\tconst { indicatorPosition } = React.useContext(SelectContext);\n\n\treturn (\n\t\t<span\n\t\t\tdata-slot=\"select-indicator\"\n\t\t\tclassName={cn(\n\t\t\t\t\"absolute flex top-1/2 -translate-y-1/2 items-center justify-center\",\n\t\t\t\tindicatorPosition === \"left\" ? \"start-2\" : \"end-2\",\n\t\t\t\tclassName,\n\t\t\t)}\n\t\t\t{...props}\n\t\t>\n\t\t\t<SelectPrimitive.ItemIndicator>{children}</SelectPrimitive.ItemIndicator>\n\t\t</span>\n\t);\n}\n\nfunction SelectSeparator({\n\tclassName,\n\t...props\n}: React.ComponentProps<typeof SelectPrimitive.Separator>) {\n\treturn (\n\t\t<SelectPrimitive.Separator\n\t\t\tdata-slot=\"select-separator\"\n\t\t\tclassName={cn(\"-mx-1.5 my-1.5 h-px bg-border\", className)}\n\t\t\t{...props}\n\t\t/>\n\t);\n}\n\nexport {\n\tSelect,\n\tSelectContent,\n\tSelectGroup,\n\tSelectIndicator,\n\tSelectItem,\n\tSelectLabel,\n\tSelectScrollDownButton,\n\tSelectScrollUpButton,\n\tSelectSeparator,\n\tSelectTrigger,\n\tSelectValue,\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 448, "column": 0}, "map": {"version":3,"sources":["file:///Users/bobkata/Projects/boostcart/apps/platform/src/server/api/internal/analytics.ts"],"sourcesContent":["\"use server\";\n\nimport { auth } from \"@/server/auth\";\nimport { db } from \"@/server/db\";\nimport { requireAdminTenant } from \"@/server/tenant\";\n\nasync function requireStoreAccess() {\n\tconst session = await auth();\n\tif (!session?.user?.id) {\n\t\tthrow new Error(\"Unauthorized\");\n\t}\n\n\tconst tenant = await requireAdminTenant();\n\n\tconst staffRecord = await db.tenantStaff.findFirst({\n\t\twhere: {\n\t\t\tuserId: session.user.id,\n\t\t\ttenantId: tenant.id,\n\t\t},\n\t});\n\n\tif (!staffRecord) {\n\t\tthrow new Error(\"Forbidden: No access to this store\");\n\t}\n\n\treturn {\n\t\tuserId: session.user.id,\n\t\ttenantId: tenant.id,\n\t\trole: staffRecord.role,\n\t};\n}\n\n// Get date range for analytics\nfunction getDateRange(period: string): { startDate: Date; endDate: Date } {\n\tconst endDate = new Date();\n\tconst startDate = new Date();\n\n\tswitch (period) {\n\t\tcase \"7days\":\n\t\t\tstartDate.setDate(endDate.getDate() - 7);\n\t\t\tbreak;\n\t\tcase \"30days\":\n\t\t\tstartDate.setDate(endDate.getDate() - 30);\n\t\t\tbreak;\n\t\tcase \"90days\":\n\t\t\tstartDate.setDate(endDate.getDate() - 90);\n\t\t\tbreak;\n\t\tcase \"year\":\n\t\t\tstartDate.setFullYear(endDate.getFullYear() - 1);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tstartDate.setDate(endDate.getDate() - 30);\n\t}\n\n\treturn { startDate, endDate };\n}\n\n// Get overview stats\nexport async function getAnalyticsOverview(period = \"30days\") {\n\tconst { tenantId } = await requireStoreAccess();\n\tconst { startDate, endDate } = getDateRange(period);\n\n\t// Get previous period for comparison\n\tconst periodLength = endDate.getTime() - startDate.getTime();\n\tconst previousStartDate = new Date(startDate.getTime() - periodLength);\n\tconst previousEndDate = startDate;\n\n\t// Current period orders\n\tconst currentOrders = await db.order.findMany({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: startDate,\n\t\t\t\tlte: endDate,\n\t\t\t},\n\t\t},\n\t\tselect: {\n\t\t\tid: true,\n\t\t\ttotalAmount: true,\n\t\t\tstatus: true,\n\t\t},\n\t});\n\n\t// Previous period orders\n\tconst previousOrders = await db.order.findMany({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: previousStartDate,\n\t\t\t\tlte: previousEndDate,\n\t\t\t},\n\t\t},\n\t\tselect: {\n\t\t\tid: true,\n\t\t\ttotalAmount: true,\n\t\t},\n\t});\n\n\t// Current period customers\n\tconst currentCustomers = await db.customer.count({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: startDate,\n\t\t\t\tlte: endDate,\n\t\t\t},\n\t\t},\n\t});\n\n\t// Previous period customers\n\tconst previousCustomers = await db.customer.count({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: previousStartDate,\n\t\t\t\tlte: previousEndDate,\n\t\t\t},\n\t\t},\n\t});\n\n\t// Current period products\n\tconst currentProducts = await db.product.count({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: startDate,\n\t\t\t\tlte: endDate,\n\t\t\t},\n\t\t},\n\t});\n\n\t// Total products\n\tconst totalProducts = await db.product.count({\n\t\twhere: { tenantId },\n\t});\n\n\t// Get products sold in current period\n\tconst currentOrderItems = await db.orderItem.findMany({\n\t\twhere: {\n\t\t\torder: {\n\t\t\t\ttenantId,\n\t\t\t\tcreatedAt: {\n\t\t\t\t\tgte: startDate,\n\t\t\t\t\tlte: endDate,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tselect: {\n\t\t\tquantity: true,\n\t\t},\n\t});\n\n\t// Get products sold in previous period\n\tconst previousOrderItems = await db.orderItem.findMany({\n\t\twhere: {\n\t\t\torder: {\n\t\t\t\ttenantId,\n\t\t\t\tcreatedAt: {\n\t\t\t\t\tgte: previousStartDate,\n\t\t\t\t\tlte: previousEndDate,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tselect: {\n\t\t\tquantity: true,\n\t\t},\n\t});\n\n\tconst currentProductsSold = currentOrderItems.reduce(\n\t\t(sum, item) => sum + item.quantity,\n\t\t0,\n\t);\n\tconst previousProductsSold = previousOrderItems.reduce(\n\t\t(sum, item) => sum + item.quantity,\n\t\t0,\n\t);\n\n\tconst productsSoldGrowth =\n\t\tpreviousProductsSold > 0\n\t\t\t? ((currentProductsSold - previousProductsSold) / previousProductsSold) *\n\t\t\t\t100\n\t\t\t: 0;\n\n\t// Calculate metrics\n\tconst currentRevenue = currentOrders.reduce(\n\t\t(sum, order) => sum + Number(order.totalAmount),\n\t\t0,\n\t);\n\tconst previousRevenue = previousOrders.reduce(\n\t\t(sum, order) => sum + Number(order.totalAmount),\n\t\t0,\n\t);\n\n\tconst revenueGrowth =\n\t\tpreviousRevenue > 0\n\t\t\t? ((currentRevenue - previousRevenue) / previousRevenue) * 100\n\t\t\t: 0;\n\n\tconst ordersGrowth =\n\t\tpreviousOrders.length > 0\n\t\t\t? ((currentOrders.length - previousOrders.length) /\n\t\t\t\t\tpreviousOrders.length) *\n\t\t\t\t100\n\t\t\t: 0;\n\n\tconst customersGrowth =\n\t\tpreviousCustomers > 0\n\t\t\t? ((currentCustomers - previousCustomers) / previousCustomers) * 100\n\t\t\t: 0;\n\n\tconst currentAverageOrderValue =\n\t\tcurrentOrders.length > 0 ? currentRevenue / currentOrders.length : 0;\n\n\tconst previousAverageOrderValue =\n\t\tpreviousOrders.length > 0 ? previousRevenue / previousOrders.length : 0;\n\n\tconst averageOrderValueGrowth =\n\t\tpreviousAverageOrderValue > 0\n\t\t\t? ((currentAverageOrderValue - previousAverageOrderValue) /\n\t\t\t\t\tpreviousAverageOrderValue) *\n\t\t\t\t100\n\t\t\t: 0;\n\n\treturn {\n\t\trevenue: {\n\t\t\ttotal: currentRevenue,\n\t\t\tprevious: previousRevenue,\n\t\t\tgrowth: Math.round(revenueGrowth * 10) / 10,\n\t\t},\n\t\torders: {\n\t\t\ttotal: currentOrders.length,\n\t\t\tprevious: previousOrders.length,\n\t\t\tgrowth: Math.round(ordersGrowth * 10) / 10,\n\t\t},\n\t\tcustomers: {\n\t\t\ttotal: currentCustomers,\n\t\t\tprevious: previousCustomers,\n\t\t\tgrowth: Math.round(customersGrowth * 10) / 10,\n\t\t},\n\t\tproducts: {\n\t\t\ttotal: totalProducts,\n\t\t\tnew: currentProducts,\n\t\t},\n\t\tproductsSold: {\n\t\t\ttotal: currentProductsSold,\n\t\t\tprevious: previousProductsSold,\n\t\t\tgrowth: Math.round(productsSoldGrowth * 10) / 10,\n\t\t},\n\t\taverageOrderValue: {\n\t\t\ttotal: Math.round(currentAverageOrderValue * 100) / 100,\n\t\t\tprevious: Math.round(previousAverageOrderValue * 100) / 100,\n\t\t\tgrowth: Math.round(averageOrderValueGrowth * 10) / 10,\n\t\t},\n\t};\n}\n\n// Get top products by revenue\nexport async function getTopProducts(period = \"30days\", limit = 5) {\n\tconst { tenantId } = await requireStoreAccess();\n\tconst { startDate, endDate } = getDateRange(period);\n\n\t// Get order items with product info\n\tconst orderItems = await db.orderItem.findMany({\n\t\twhere: {\n\t\t\torder: {\n\t\t\t\ttenantId,\n\t\t\t\tcreatedAt: {\n\t\t\t\t\tgte: startDate,\n\t\t\t\t\tlte: endDate,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tinclude: {\n\t\t\tproduct: {\n\t\t\t\tselect: {\n\t\t\t\t\tid: true,\n\t\t\t\t\tslug: true,\n\t\t\t\t\ttranslations: {\n\t\t\t\t\t\tselect: {\n\t\t\t\t\t\t\tname: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\t// Aggregate by product\n\tconst productStats = new Map<\n\t\tstring,\n\t\t{ name: string; revenue: number; sales: number }\n\t>();\n\n\tfor (const item of orderItems) {\n\t\tif (!item.product) continue;\n\n\t\tconst productId = item.product.id;\n\t\tconst productName = item.product.translations[0]?.name ?? item.product.slug;\n\t\tconst revenue = Number(item.price) * item.quantity;\n\n\t\tconst existing = productStats.get(productId);\n\t\tif (existing) {\n\t\t\texisting.revenue += revenue;\n\t\t\texisting.sales += item.quantity;\n\t\t} else {\n\t\t\tproductStats.set(productId, {\n\t\t\t\tname: productName,\n\t\t\t\trevenue,\n\t\t\t\tsales: item.quantity,\n\t\t\t});\n\t\t}\n\t}\n\n\t// Sort by revenue and take top N\n\tconst topProducts = Array.from(productStats.entries())\n\t\t.map(([id, stats]) => ({\n\t\t\tid,\n\t\t\t...stats,\n\t\t}))\n\t\t.sort((a, b) => b.revenue - a.revenue)\n\t\t.slice(0, limit);\n\n\treturn topProducts;\n}\n\n// Get top categories by revenue\nexport async function getTopCategories(period = \"30days\", limit = 5) {\n\tconst { tenantId } = await requireStoreAccess();\n\tconst { startDate, endDate } = getDateRange(period);\n\n\t// Get order items with product and category info\n\tconst orderItems = await db.orderItem.findMany({\n\t\twhere: {\n\t\t\torder: {\n\t\t\t\ttenantId,\n\t\t\t\tcreatedAt: {\n\t\t\t\t\tgte: startDate,\n\t\t\t\t\tlte: endDate,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tinclude: {\n\t\t\tproduct: {\n\t\t\t\tselect: {\n\t\t\t\t\tid: true,\n\t\t\t\t\tcategoryId: true,\n\t\t\t\t\tcategory: {\n\t\t\t\t\t\tselect: {\n\t\t\t\t\t\t\tid: true,\n\t\t\t\t\t\t\tslug: true,\n\t\t\t\t\t\t\ttranslations: {\n\t\t\t\t\t\t\t\tselect: {\n\t\t\t\t\t\t\t\t\tname: true,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\t// Aggregate by category\n\tconst categoryStats = new Map<\n\t\tstring,\n\t\t{ name: string; revenue: number; orders: Set<string> }\n\t>();\n\n\tfor (const item of orderItems) {\n\t\tif (!item.product?.category) continue;\n\n\t\tconst categoryId = item.product.category.id;\n\t\tconst categoryName =\n\t\t\titem.product.category.translations[0]?.name ?? item.product.category.slug;\n\t\tconst revenue = Number(item.price) * item.quantity;\n\n\t\tconst existing = categoryStats.get(categoryId);\n\t\tif (existing) {\n\t\t\texisting.revenue += revenue;\n\t\t\texisting.orders.add(item.orderId);\n\t\t} else {\n\t\t\tcategoryStats.set(categoryId, {\n\t\t\t\tname: categoryName,\n\t\t\t\trevenue,\n\t\t\t\torders: new Set([item.orderId]),\n\t\t\t});\n\t\t}\n\t}\n\n\t// Calculate total revenue for percentage\n\tconst totalRevenue = Array.from(categoryStats.values()).reduce(\n\t\t(sum, stats) => sum + stats.revenue,\n\t\t0,\n\t);\n\n\t// Sort by revenue and take top N\n\tconst topCategories = Array.from(categoryStats.entries())\n\t\t.map(([id, stats]) => ({\n\t\t\tid,\n\t\t\tname: stats.name,\n\t\t\trevenue: stats.revenue,\n\t\t\torders: stats.orders.size,\n\t\t\tshare:\n\t\t\t\ttotalRevenue > 0 ? Math.round((stats.revenue / totalRevenue) * 100) : 0,\n\t\t}))\n\t\t.sort((a, b) => b.revenue - a.revenue)\n\t\t.slice(0, limit);\n\n\treturn topCategories;\n}\n\n// Get recent activity\nexport async function getRecentActivity(limit = 10) {\n\tconst { tenantId } = await requireStoreAccess();\n\n\t// Get recent orders\n\tconst recentOrders = await db.order.findMany({\n\t\twhere: { tenantId },\n\t\torderBy: { createdAt: \"desc\" },\n\t\ttake: limit,\n\t\tselect: {\n\t\t\tid: true,\n\t\t\torderNumber: true,\n\t\t\ttotalAmount: true,\n\t\t\tstatus: true,\n\t\t\tcreatedAt: true,\n\t\t\tcustomer: {\n\t\t\t\tselect: {\n\t\t\t\t\tfirstName: true,\n\t\t\t\t\tlastName: true,\n\t\t\t\t\temail: true,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\t// Get recent customers\n\tconst recentCustomers = await db.customer.findMany({\n\t\twhere: { tenantId },\n\t\torderBy: { createdAt: \"desc\" },\n\t\ttake: limit,\n\t\tselect: {\n\t\t\tid: true,\n\t\t\tfirstName: true,\n\t\t\tlastName: true,\n\t\t\temail: true,\n\t\t\tcreatedAt: true,\n\t\t},\n\t});\n\n\t// Get recent reviews\n\tconst recentReviews = await db.review.findMany({\n\t\twhere: { tenantId },\n\t\torderBy: { createdAt: \"desc\" },\n\t\ttake: limit,\n\t\tselect: {\n\t\t\tid: true,\n\t\t\trating: true,\n\t\t\tcreatedAt: true,\n\t\t\tproduct: {\n\t\t\t\tselect: {\n\t\t\t\t\tslug: true,\n\t\t\t\t\ttranslations: {\n\t\t\t\t\t\tselect: {\n\t\t\t\t\t\t\tname: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\t// Combine and sort by date\n\ttype Activity = {\n\t\tid: string;\n\t\ttype: \"order\" | \"customer\" | \"review\";\n\t\taction: string;\n\t\tdetails: string;\n\t\ttimestamp: Date;\n\t};\n\n\tconst activities: Activity[] = [];\n\n\tfor (const order of recentOrders) {\n\t\tconst customerName = order.customer\n\t\t\t? `${order.customer.firstName ?? \"\"} ${order.customer.lastName ?? \"\"}`.trim() ||\n\t\t\t\torder.customer.email\n\t\t\t: \"Guest\";\n\n\t\tactivities.push({\n\t\t\tid: `order-${order.id}`,\n\t\t\ttype: \"order\",\n\t\t\taction:\n\t\t\t\torder.status === \"PENDING\"\n\t\t\t\t\t? \"New order\"\n\t\t\t\t\t: `Order ${order.status.toLowerCase()}`,\n\t\t\tdetails: `#${order.orderNumber} - ${customerName} - $${Number(order.totalAmount).toFixed(2)}`,\n\t\t\ttimestamp: order.createdAt,\n\t\t});\n\t}\n\n\tfor (const customer of recentCustomers) {\n\t\tconst customerName =\n\t\t\t`${customer.firstName ?? \"\"} ${customer.lastName ?? \"\"}`.trim() ||\n\t\t\tcustomer.email;\n\n\t\tactivities.push({\n\t\t\tid: `customer-${customer.id}`,\n\t\t\ttype: \"customer\",\n\t\t\taction: \"New customer\",\n\t\t\tdetails: `${customerName} registered`,\n\t\t\ttimestamp: customer.createdAt,\n\t\t});\n\t}\n\n\tfor (const review of recentReviews) {\n\t\tconst productName =\n\t\t\treview.product.translations[0]?.name ?? review.product.slug;\n\n\t\tactivities.push({\n\t\t\tid: `review-${review.id}`,\n\t\t\ttype: \"review\",\n\t\t\taction: \"Review posted\",\n\t\t\tdetails: `${review.rating} stars - ${productName}`,\n\t\t\ttimestamp: review.createdAt,\n\t\t});\n\t}\n\n\t// Sort by timestamp and take top N\n\tactivities.sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime());\n\n\treturn activities.slice(0, limit).map((activity) => ({\n\t\t...activity,\n\t\ttime: getRelativeTime(activity.timestamp),\n\t}));\n}\n\n// Helper function to get relative time\nfunction getRelativeTime(date: Date): string {\n\tconst now = new Date();\n\tconst diffMs = now.getTime() - date.getTime();\n\tconst diffMins = Math.floor(diffMs / 60000);\n\tconst diffHours = Math.floor(diffMs / 3600000);\n\tconst diffDays = Math.floor(diffMs / 86400000);\n\n\tif (diffMins < 1) return \"Just now\";\n\tif (diffMins < 60) return `${diffMins} minute${diffMins > 1 ? \"s\" : \"\"} ago`;\n\tif (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? \"s\" : \"\"} ago`;\n\tif (diffDays < 7) return `${diffDays} day${diffDays > 1 ? \"s\" : \"\"} ago`;\n\n\treturn date.toLocaleDateString();\n}\n\n// Get orders by status\nexport async function getOrdersByStatus(period = \"30days\") {\n\tconst { tenantId } = await requireStoreAccess();\n\tconst { startDate, endDate } = getDateRange(period);\n\n\tconst orders = await db.order.groupBy({\n\t\tby: [\"status\"],\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: startDate,\n\t\t\t\tlte: endDate,\n\t\t\t},\n\t\t},\n\t\t_count: {\n\t\t\tid: true,\n\t\t},\n\t});\n\n\treturn orders.map((o) => ({\n\t\tstatus: o.status,\n\t\tcount: o._count.id,\n\t}));\n}\n\n// Get revenue by day for chart\nexport async function getRevenueByDay(period = \"30days\") {\n\tconst { tenantId } = await requireStoreAccess();\n\tconst { startDate, endDate } = getDateRange(period);\n\n\tconst orders = await db.order.findMany({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: startDate,\n\t\t\t\tlte: endDate,\n\t\t\t},\n\t\t},\n\t\tselect: {\n\t\t\ttotalAmount: true,\n\t\t\tcreatedAt: true,\n\t\t},\n\t\torderBy: {\n\t\t\tcreatedAt: \"asc\",\n\t\t},\n\t});\n\n\t// Group by day\n\tconst dailyRevenue = new Map<string, number>();\n\n\tfor (const order of orders) {\n\t\tconst day = order.createdAt.toISOString().split(\"T\")[0];\n\t\tif (!day) continue;\n\t\tconst amount = Number(order.totalAmount);\n\n\t\tdailyRevenue.set(day, (dailyRevenue.get(day) ?? 0) + amount);\n\t}\n\n\treturn Array.from(dailyRevenue.entries()).map(([date, revenue]) => ({\n\t\tdate,\n\t\trevenue: Math.round(revenue * 100) / 100,\n\t}));\n}\n"],"names":[],"mappings":";;;;;;;MA0DsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,wDAAA"}},
    {"offset": {"line": 465, "column": 0}, "map": {"version":3,"sources":["file:///Users/bobkata/Projects/boostcart/apps/platform/src/server/api/internal/analytics.ts"],"sourcesContent":["\"use server\";\n\nimport { auth } from \"@/server/auth\";\nimport { db } from \"@/server/db\";\nimport { requireAdminTenant } from \"@/server/tenant\";\n\nasync function requireStoreAccess() {\n\tconst session = await auth();\n\tif (!session?.user?.id) {\n\t\tthrow new Error(\"Unauthorized\");\n\t}\n\n\tconst tenant = await requireAdminTenant();\n\n\tconst staffRecord = await db.tenantStaff.findFirst({\n\t\twhere: {\n\t\t\tuserId: session.user.id,\n\t\t\ttenantId: tenant.id,\n\t\t},\n\t});\n\n\tif (!staffRecord) {\n\t\tthrow new Error(\"Forbidden: No access to this store\");\n\t}\n\n\treturn {\n\t\tuserId: session.user.id,\n\t\ttenantId: tenant.id,\n\t\trole: staffRecord.role,\n\t};\n}\n\n// Get date range for analytics\nfunction getDateRange(period: string): { startDate: Date; endDate: Date } {\n\tconst endDate = new Date();\n\tconst startDate = new Date();\n\n\tswitch (period) {\n\t\tcase \"7days\":\n\t\t\tstartDate.setDate(endDate.getDate() - 7);\n\t\t\tbreak;\n\t\tcase \"30days\":\n\t\t\tstartDate.setDate(endDate.getDate() - 30);\n\t\t\tbreak;\n\t\tcase \"90days\":\n\t\t\tstartDate.setDate(endDate.getDate() - 90);\n\t\t\tbreak;\n\t\tcase \"year\":\n\t\t\tstartDate.setFullYear(endDate.getFullYear() - 1);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tstartDate.setDate(endDate.getDate() - 30);\n\t}\n\n\treturn { startDate, endDate };\n}\n\n// Get overview stats\nexport async function getAnalyticsOverview(period = \"30days\") {\n\tconst { tenantId } = await requireStoreAccess();\n\tconst { startDate, endDate } = getDateRange(period);\n\n\t// Get previous period for comparison\n\tconst periodLength = endDate.getTime() - startDate.getTime();\n\tconst previousStartDate = new Date(startDate.getTime() - periodLength);\n\tconst previousEndDate = startDate;\n\n\t// Current period orders\n\tconst currentOrders = await db.order.findMany({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: startDate,\n\t\t\t\tlte: endDate,\n\t\t\t},\n\t\t},\n\t\tselect: {\n\t\t\tid: true,\n\t\t\ttotalAmount: true,\n\t\t\tstatus: true,\n\t\t},\n\t});\n\n\t// Previous period orders\n\tconst previousOrders = await db.order.findMany({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: previousStartDate,\n\t\t\t\tlte: previousEndDate,\n\t\t\t},\n\t\t},\n\t\tselect: {\n\t\t\tid: true,\n\t\t\ttotalAmount: true,\n\t\t},\n\t});\n\n\t// Current period customers\n\tconst currentCustomers = await db.customer.count({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: startDate,\n\t\t\t\tlte: endDate,\n\t\t\t},\n\t\t},\n\t});\n\n\t// Previous period customers\n\tconst previousCustomers = await db.customer.count({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: previousStartDate,\n\t\t\t\tlte: previousEndDate,\n\t\t\t},\n\t\t},\n\t});\n\n\t// Current period products\n\tconst currentProducts = await db.product.count({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: startDate,\n\t\t\t\tlte: endDate,\n\t\t\t},\n\t\t},\n\t});\n\n\t// Total products\n\tconst totalProducts = await db.product.count({\n\t\twhere: { tenantId },\n\t});\n\n\t// Get products sold in current period\n\tconst currentOrderItems = await db.orderItem.findMany({\n\t\twhere: {\n\t\t\torder: {\n\t\t\t\ttenantId,\n\t\t\t\tcreatedAt: {\n\t\t\t\t\tgte: startDate,\n\t\t\t\t\tlte: endDate,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tselect: {\n\t\t\tquantity: true,\n\t\t},\n\t});\n\n\t// Get products sold in previous period\n\tconst previousOrderItems = await db.orderItem.findMany({\n\t\twhere: {\n\t\t\torder: {\n\t\t\t\ttenantId,\n\t\t\t\tcreatedAt: {\n\t\t\t\t\tgte: previousStartDate,\n\t\t\t\t\tlte: previousEndDate,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tselect: {\n\t\t\tquantity: true,\n\t\t},\n\t});\n\n\tconst currentProductsSold = currentOrderItems.reduce(\n\t\t(sum, item) => sum + item.quantity,\n\t\t0,\n\t);\n\tconst previousProductsSold = previousOrderItems.reduce(\n\t\t(sum, item) => sum + item.quantity,\n\t\t0,\n\t);\n\n\tconst productsSoldGrowth =\n\t\tpreviousProductsSold > 0\n\t\t\t? ((currentProductsSold - previousProductsSold) / previousProductsSold) *\n\t\t\t\t100\n\t\t\t: 0;\n\n\t// Calculate metrics\n\tconst currentRevenue = currentOrders.reduce(\n\t\t(sum, order) => sum + Number(order.totalAmount),\n\t\t0,\n\t);\n\tconst previousRevenue = previousOrders.reduce(\n\t\t(sum, order) => sum + Number(order.totalAmount),\n\t\t0,\n\t);\n\n\tconst revenueGrowth =\n\t\tpreviousRevenue > 0\n\t\t\t? ((currentRevenue - previousRevenue) / previousRevenue) * 100\n\t\t\t: 0;\n\n\tconst ordersGrowth =\n\t\tpreviousOrders.length > 0\n\t\t\t? ((currentOrders.length - previousOrders.length) /\n\t\t\t\t\tpreviousOrders.length) *\n\t\t\t\t100\n\t\t\t: 0;\n\n\tconst customersGrowth =\n\t\tpreviousCustomers > 0\n\t\t\t? ((currentCustomers - previousCustomers) / previousCustomers) * 100\n\t\t\t: 0;\n\n\tconst currentAverageOrderValue =\n\t\tcurrentOrders.length > 0 ? currentRevenue / currentOrders.length : 0;\n\n\tconst previousAverageOrderValue =\n\t\tpreviousOrders.length > 0 ? previousRevenue / previousOrders.length : 0;\n\n\tconst averageOrderValueGrowth =\n\t\tpreviousAverageOrderValue > 0\n\t\t\t? ((currentAverageOrderValue - previousAverageOrderValue) /\n\t\t\t\t\tpreviousAverageOrderValue) *\n\t\t\t\t100\n\t\t\t: 0;\n\n\treturn {\n\t\trevenue: {\n\t\t\ttotal: currentRevenue,\n\t\t\tprevious: previousRevenue,\n\t\t\tgrowth: Math.round(revenueGrowth * 10) / 10,\n\t\t},\n\t\torders: {\n\t\t\ttotal: currentOrders.length,\n\t\t\tprevious: previousOrders.length,\n\t\t\tgrowth: Math.round(ordersGrowth * 10) / 10,\n\t\t},\n\t\tcustomers: {\n\t\t\ttotal: currentCustomers,\n\t\t\tprevious: previousCustomers,\n\t\t\tgrowth: Math.round(customersGrowth * 10) / 10,\n\t\t},\n\t\tproducts: {\n\t\t\ttotal: totalProducts,\n\t\t\tnew: currentProducts,\n\t\t},\n\t\tproductsSold: {\n\t\t\ttotal: currentProductsSold,\n\t\t\tprevious: previousProductsSold,\n\t\t\tgrowth: Math.round(productsSoldGrowth * 10) / 10,\n\t\t},\n\t\taverageOrderValue: {\n\t\t\ttotal: Math.round(currentAverageOrderValue * 100) / 100,\n\t\t\tprevious: Math.round(previousAverageOrderValue * 100) / 100,\n\t\t\tgrowth: Math.round(averageOrderValueGrowth * 10) / 10,\n\t\t},\n\t};\n}\n\n// Get top products by revenue\nexport async function getTopProducts(period = \"30days\", limit = 5) {\n\tconst { tenantId } = await requireStoreAccess();\n\tconst { startDate, endDate } = getDateRange(period);\n\n\t// Get order items with product info\n\tconst orderItems = await db.orderItem.findMany({\n\t\twhere: {\n\t\t\torder: {\n\t\t\t\ttenantId,\n\t\t\t\tcreatedAt: {\n\t\t\t\t\tgte: startDate,\n\t\t\t\t\tlte: endDate,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tinclude: {\n\t\t\tproduct: {\n\t\t\t\tselect: {\n\t\t\t\t\tid: true,\n\t\t\t\t\tslug: true,\n\t\t\t\t\ttranslations: {\n\t\t\t\t\t\tselect: {\n\t\t\t\t\t\t\tname: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\t// Aggregate by product\n\tconst productStats = new Map<\n\t\tstring,\n\t\t{ name: string; revenue: number; sales: number }\n\t>();\n\n\tfor (const item of orderItems) {\n\t\tif (!item.product) continue;\n\n\t\tconst productId = item.product.id;\n\t\tconst productName = item.product.translations[0]?.name ?? item.product.slug;\n\t\tconst revenue = Number(item.price) * item.quantity;\n\n\t\tconst existing = productStats.get(productId);\n\t\tif (existing) {\n\t\t\texisting.revenue += revenue;\n\t\t\texisting.sales += item.quantity;\n\t\t} else {\n\t\t\tproductStats.set(productId, {\n\t\t\t\tname: productName,\n\t\t\t\trevenue,\n\t\t\t\tsales: item.quantity,\n\t\t\t});\n\t\t}\n\t}\n\n\t// Sort by revenue and take top N\n\tconst topProducts = Array.from(productStats.entries())\n\t\t.map(([id, stats]) => ({\n\t\t\tid,\n\t\t\t...stats,\n\t\t}))\n\t\t.sort((a, b) => b.revenue - a.revenue)\n\t\t.slice(0, limit);\n\n\treturn topProducts;\n}\n\n// Get top categories by revenue\nexport async function getTopCategories(period = \"30days\", limit = 5) {\n\tconst { tenantId } = await requireStoreAccess();\n\tconst { startDate, endDate } = getDateRange(period);\n\n\t// Get order items with product and category info\n\tconst orderItems = await db.orderItem.findMany({\n\t\twhere: {\n\t\t\torder: {\n\t\t\t\ttenantId,\n\t\t\t\tcreatedAt: {\n\t\t\t\t\tgte: startDate,\n\t\t\t\t\tlte: endDate,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tinclude: {\n\t\t\tproduct: {\n\t\t\t\tselect: {\n\t\t\t\t\tid: true,\n\t\t\t\t\tcategoryId: true,\n\t\t\t\t\tcategory: {\n\t\t\t\t\t\tselect: {\n\t\t\t\t\t\t\tid: true,\n\t\t\t\t\t\t\tslug: true,\n\t\t\t\t\t\t\ttranslations: {\n\t\t\t\t\t\t\t\tselect: {\n\t\t\t\t\t\t\t\t\tname: true,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\t// Aggregate by category\n\tconst categoryStats = new Map<\n\t\tstring,\n\t\t{ name: string; revenue: number; orders: Set<string> }\n\t>();\n\n\tfor (const item of orderItems) {\n\t\tif (!item.product?.category) continue;\n\n\t\tconst categoryId = item.product.category.id;\n\t\tconst categoryName =\n\t\t\titem.product.category.translations[0]?.name ?? item.product.category.slug;\n\t\tconst revenue = Number(item.price) * item.quantity;\n\n\t\tconst existing = categoryStats.get(categoryId);\n\t\tif (existing) {\n\t\t\texisting.revenue += revenue;\n\t\t\texisting.orders.add(item.orderId);\n\t\t} else {\n\t\t\tcategoryStats.set(categoryId, {\n\t\t\t\tname: categoryName,\n\t\t\t\trevenue,\n\t\t\t\torders: new Set([item.orderId]),\n\t\t\t});\n\t\t}\n\t}\n\n\t// Calculate total revenue for percentage\n\tconst totalRevenue = Array.from(categoryStats.values()).reduce(\n\t\t(sum, stats) => sum + stats.revenue,\n\t\t0,\n\t);\n\n\t// Sort by revenue and take top N\n\tconst topCategories = Array.from(categoryStats.entries())\n\t\t.map(([id, stats]) => ({\n\t\t\tid,\n\t\t\tname: stats.name,\n\t\t\trevenue: stats.revenue,\n\t\t\torders: stats.orders.size,\n\t\t\tshare:\n\t\t\t\ttotalRevenue > 0 ? Math.round((stats.revenue / totalRevenue) * 100) : 0,\n\t\t}))\n\t\t.sort((a, b) => b.revenue - a.revenue)\n\t\t.slice(0, limit);\n\n\treturn topCategories;\n}\n\n// Get recent activity\nexport async function getRecentActivity(limit = 10) {\n\tconst { tenantId } = await requireStoreAccess();\n\n\t// Get recent orders\n\tconst recentOrders = await db.order.findMany({\n\t\twhere: { tenantId },\n\t\torderBy: { createdAt: \"desc\" },\n\t\ttake: limit,\n\t\tselect: {\n\t\t\tid: true,\n\t\t\torderNumber: true,\n\t\t\ttotalAmount: true,\n\t\t\tstatus: true,\n\t\t\tcreatedAt: true,\n\t\t\tcustomer: {\n\t\t\t\tselect: {\n\t\t\t\t\tfirstName: true,\n\t\t\t\t\tlastName: true,\n\t\t\t\t\temail: true,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\t// Get recent customers\n\tconst recentCustomers = await db.customer.findMany({\n\t\twhere: { tenantId },\n\t\torderBy: { createdAt: \"desc\" },\n\t\ttake: limit,\n\t\tselect: {\n\t\t\tid: true,\n\t\t\tfirstName: true,\n\t\t\tlastName: true,\n\t\t\temail: true,\n\t\t\tcreatedAt: true,\n\t\t},\n\t});\n\n\t// Get recent reviews\n\tconst recentReviews = await db.review.findMany({\n\t\twhere: { tenantId },\n\t\torderBy: { createdAt: \"desc\" },\n\t\ttake: limit,\n\t\tselect: {\n\t\t\tid: true,\n\t\t\trating: true,\n\t\t\tcreatedAt: true,\n\t\t\tproduct: {\n\t\t\t\tselect: {\n\t\t\t\t\tslug: true,\n\t\t\t\t\ttranslations: {\n\t\t\t\t\t\tselect: {\n\t\t\t\t\t\t\tname: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\t// Combine and sort by date\n\ttype Activity = {\n\t\tid: string;\n\t\ttype: \"order\" | \"customer\" | \"review\";\n\t\taction: string;\n\t\tdetails: string;\n\t\ttimestamp: Date;\n\t};\n\n\tconst activities: Activity[] = [];\n\n\tfor (const order of recentOrders) {\n\t\tconst customerName = order.customer\n\t\t\t? `${order.customer.firstName ?? \"\"} ${order.customer.lastName ?? \"\"}`.trim() ||\n\t\t\t\torder.customer.email\n\t\t\t: \"Guest\";\n\n\t\tactivities.push({\n\t\t\tid: `order-${order.id}`,\n\t\t\ttype: \"order\",\n\t\t\taction:\n\t\t\t\torder.status === \"PENDING\"\n\t\t\t\t\t? \"New order\"\n\t\t\t\t\t: `Order ${order.status.toLowerCase()}`,\n\t\t\tdetails: `#${order.orderNumber} - ${customerName} - $${Number(order.totalAmount).toFixed(2)}`,\n\t\t\ttimestamp: order.createdAt,\n\t\t});\n\t}\n\n\tfor (const customer of recentCustomers) {\n\t\tconst customerName =\n\t\t\t`${customer.firstName ?? \"\"} ${customer.lastName ?? \"\"}`.trim() ||\n\t\t\tcustomer.email;\n\n\t\tactivities.push({\n\t\t\tid: `customer-${customer.id}`,\n\t\t\ttype: \"customer\",\n\t\t\taction: \"New customer\",\n\t\t\tdetails: `${customerName} registered`,\n\t\t\ttimestamp: customer.createdAt,\n\t\t});\n\t}\n\n\tfor (const review of recentReviews) {\n\t\tconst productName =\n\t\t\treview.product.translations[0]?.name ?? review.product.slug;\n\n\t\tactivities.push({\n\t\t\tid: `review-${review.id}`,\n\t\t\ttype: \"review\",\n\t\t\taction: \"Review posted\",\n\t\t\tdetails: `${review.rating} stars - ${productName}`,\n\t\t\ttimestamp: review.createdAt,\n\t\t});\n\t}\n\n\t// Sort by timestamp and take top N\n\tactivities.sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime());\n\n\treturn activities.slice(0, limit).map((activity) => ({\n\t\t...activity,\n\t\ttime: getRelativeTime(activity.timestamp),\n\t}));\n}\n\n// Helper function to get relative time\nfunction getRelativeTime(date: Date): string {\n\tconst now = new Date();\n\tconst diffMs = now.getTime() - date.getTime();\n\tconst diffMins = Math.floor(diffMs / 60000);\n\tconst diffHours = Math.floor(diffMs / 3600000);\n\tconst diffDays = Math.floor(diffMs / 86400000);\n\n\tif (diffMins < 1) return \"Just now\";\n\tif (diffMins < 60) return `${diffMins} minute${diffMins > 1 ? \"s\" : \"\"} ago`;\n\tif (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? \"s\" : \"\"} ago`;\n\tif (diffDays < 7) return `${diffDays} day${diffDays > 1 ? \"s\" : \"\"} ago`;\n\n\treturn date.toLocaleDateString();\n}\n\n// Get orders by status\nexport async function getOrdersByStatus(period = \"30days\") {\n\tconst { tenantId } = await requireStoreAccess();\n\tconst { startDate, endDate } = getDateRange(period);\n\n\tconst orders = await db.order.groupBy({\n\t\tby: [\"status\"],\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: startDate,\n\t\t\t\tlte: endDate,\n\t\t\t},\n\t\t},\n\t\t_count: {\n\t\t\tid: true,\n\t\t},\n\t});\n\n\treturn orders.map((o) => ({\n\t\tstatus: o.status,\n\t\tcount: o._count.id,\n\t}));\n}\n\n// Get revenue by day for chart\nexport async function getRevenueByDay(period = \"30days\") {\n\tconst { tenantId } = await requireStoreAccess();\n\tconst { startDate, endDate } = getDateRange(period);\n\n\tconst orders = await db.order.findMany({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: startDate,\n\t\t\t\tlte: endDate,\n\t\t\t},\n\t\t},\n\t\tselect: {\n\t\t\ttotalAmount: true,\n\t\t\tcreatedAt: true,\n\t\t},\n\t\torderBy: {\n\t\t\tcreatedAt: \"asc\",\n\t\t},\n\t});\n\n\t// Group by day\n\tconst dailyRevenue = new Map<string, number>();\n\n\tfor (const order of orders) {\n\t\tconst day = order.createdAt.toISOString().split(\"T\")[0];\n\t\tif (!day) continue;\n\t\tconst amount = Number(order.totalAmount);\n\n\t\tdailyRevenue.set(day, (dailyRevenue.get(day) ?? 0) + amount);\n\t}\n\n\treturn Array.from(dailyRevenue.entries()).map(([date, revenue]) => ({\n\t\tdate,\n\t\trevenue: Math.round(revenue * 100) / 100,\n\t}));\n}\n"],"names":[],"mappings":";;;;;;;MA8ZsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,qDAAA"}},
    {"offset": {"line": 482, "column": 0}, "map": {"version":3,"sources":["file:///Users/bobkata/Projects/boostcart/apps/platform/src/server/api/internal/analytics.ts"],"sourcesContent":["\"use server\";\n\nimport { auth } from \"@/server/auth\";\nimport { db } from \"@/server/db\";\nimport { requireAdminTenant } from \"@/server/tenant\";\n\nasync function requireStoreAccess() {\n\tconst session = await auth();\n\tif (!session?.user?.id) {\n\t\tthrow new Error(\"Unauthorized\");\n\t}\n\n\tconst tenant = await requireAdminTenant();\n\n\tconst staffRecord = await db.tenantStaff.findFirst({\n\t\twhere: {\n\t\t\tuserId: session.user.id,\n\t\t\ttenantId: tenant.id,\n\t\t},\n\t});\n\n\tif (!staffRecord) {\n\t\tthrow new Error(\"Forbidden: No access to this store\");\n\t}\n\n\treturn {\n\t\tuserId: session.user.id,\n\t\ttenantId: tenant.id,\n\t\trole: staffRecord.role,\n\t};\n}\n\n// Get date range for analytics\nfunction getDateRange(period: string): { startDate: Date; endDate: Date } {\n\tconst endDate = new Date();\n\tconst startDate = new Date();\n\n\tswitch (period) {\n\t\tcase \"7days\":\n\t\t\tstartDate.setDate(endDate.getDate() - 7);\n\t\t\tbreak;\n\t\tcase \"30days\":\n\t\t\tstartDate.setDate(endDate.getDate() - 30);\n\t\t\tbreak;\n\t\tcase \"90days\":\n\t\t\tstartDate.setDate(endDate.getDate() - 90);\n\t\t\tbreak;\n\t\tcase \"year\":\n\t\t\tstartDate.setFullYear(endDate.getFullYear() - 1);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tstartDate.setDate(endDate.getDate() - 30);\n\t}\n\n\treturn { startDate, endDate };\n}\n\n// Get overview stats\nexport async function getAnalyticsOverview(period = \"30days\") {\n\tconst { tenantId } = await requireStoreAccess();\n\tconst { startDate, endDate } = getDateRange(period);\n\n\t// Get previous period for comparison\n\tconst periodLength = endDate.getTime() - startDate.getTime();\n\tconst previousStartDate = new Date(startDate.getTime() - periodLength);\n\tconst previousEndDate = startDate;\n\n\t// Current period orders\n\tconst currentOrders = await db.order.findMany({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: startDate,\n\t\t\t\tlte: endDate,\n\t\t\t},\n\t\t},\n\t\tselect: {\n\t\t\tid: true,\n\t\t\ttotalAmount: true,\n\t\t\tstatus: true,\n\t\t},\n\t});\n\n\t// Previous period orders\n\tconst previousOrders = await db.order.findMany({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: previousStartDate,\n\t\t\t\tlte: previousEndDate,\n\t\t\t},\n\t\t},\n\t\tselect: {\n\t\t\tid: true,\n\t\t\ttotalAmount: true,\n\t\t},\n\t});\n\n\t// Current period customers\n\tconst currentCustomers = await db.customer.count({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: startDate,\n\t\t\t\tlte: endDate,\n\t\t\t},\n\t\t},\n\t});\n\n\t// Previous period customers\n\tconst previousCustomers = await db.customer.count({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: previousStartDate,\n\t\t\t\tlte: previousEndDate,\n\t\t\t},\n\t\t},\n\t});\n\n\t// Current period products\n\tconst currentProducts = await db.product.count({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: startDate,\n\t\t\t\tlte: endDate,\n\t\t\t},\n\t\t},\n\t});\n\n\t// Total products\n\tconst totalProducts = await db.product.count({\n\t\twhere: { tenantId },\n\t});\n\n\t// Get products sold in current period\n\tconst currentOrderItems = await db.orderItem.findMany({\n\t\twhere: {\n\t\t\torder: {\n\t\t\t\ttenantId,\n\t\t\t\tcreatedAt: {\n\t\t\t\t\tgte: startDate,\n\t\t\t\t\tlte: endDate,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tselect: {\n\t\t\tquantity: true,\n\t\t},\n\t});\n\n\t// Get products sold in previous period\n\tconst previousOrderItems = await db.orderItem.findMany({\n\t\twhere: {\n\t\t\torder: {\n\t\t\t\ttenantId,\n\t\t\t\tcreatedAt: {\n\t\t\t\t\tgte: previousStartDate,\n\t\t\t\t\tlte: previousEndDate,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tselect: {\n\t\t\tquantity: true,\n\t\t},\n\t});\n\n\tconst currentProductsSold = currentOrderItems.reduce(\n\t\t(sum, item) => sum + item.quantity,\n\t\t0,\n\t);\n\tconst previousProductsSold = previousOrderItems.reduce(\n\t\t(sum, item) => sum + item.quantity,\n\t\t0,\n\t);\n\n\tconst productsSoldGrowth =\n\t\tpreviousProductsSold > 0\n\t\t\t? ((currentProductsSold - previousProductsSold) / previousProductsSold) *\n\t\t\t\t100\n\t\t\t: 0;\n\n\t// Calculate metrics\n\tconst currentRevenue = currentOrders.reduce(\n\t\t(sum, order) => sum + Number(order.totalAmount),\n\t\t0,\n\t);\n\tconst previousRevenue = previousOrders.reduce(\n\t\t(sum, order) => sum + Number(order.totalAmount),\n\t\t0,\n\t);\n\n\tconst revenueGrowth =\n\t\tpreviousRevenue > 0\n\t\t\t? ((currentRevenue - previousRevenue) / previousRevenue) * 100\n\t\t\t: 0;\n\n\tconst ordersGrowth =\n\t\tpreviousOrders.length > 0\n\t\t\t? ((currentOrders.length - previousOrders.length) /\n\t\t\t\t\tpreviousOrders.length) *\n\t\t\t\t100\n\t\t\t: 0;\n\n\tconst customersGrowth =\n\t\tpreviousCustomers > 0\n\t\t\t? ((currentCustomers - previousCustomers) / previousCustomers) * 100\n\t\t\t: 0;\n\n\tconst currentAverageOrderValue =\n\t\tcurrentOrders.length > 0 ? currentRevenue / currentOrders.length : 0;\n\n\tconst previousAverageOrderValue =\n\t\tpreviousOrders.length > 0 ? previousRevenue / previousOrders.length : 0;\n\n\tconst averageOrderValueGrowth =\n\t\tpreviousAverageOrderValue > 0\n\t\t\t? ((currentAverageOrderValue - previousAverageOrderValue) /\n\t\t\t\t\tpreviousAverageOrderValue) *\n\t\t\t\t100\n\t\t\t: 0;\n\n\treturn {\n\t\trevenue: {\n\t\t\ttotal: currentRevenue,\n\t\t\tprevious: previousRevenue,\n\t\t\tgrowth: Math.round(revenueGrowth * 10) / 10,\n\t\t},\n\t\torders: {\n\t\t\ttotal: currentOrders.length,\n\t\t\tprevious: previousOrders.length,\n\t\t\tgrowth: Math.round(ordersGrowth * 10) / 10,\n\t\t},\n\t\tcustomers: {\n\t\t\ttotal: currentCustomers,\n\t\t\tprevious: previousCustomers,\n\t\t\tgrowth: Math.round(customersGrowth * 10) / 10,\n\t\t},\n\t\tproducts: {\n\t\t\ttotal: totalProducts,\n\t\t\tnew: currentProducts,\n\t\t},\n\t\tproductsSold: {\n\t\t\ttotal: currentProductsSold,\n\t\t\tprevious: previousProductsSold,\n\t\t\tgrowth: Math.round(productsSoldGrowth * 10) / 10,\n\t\t},\n\t\taverageOrderValue: {\n\t\t\ttotal: Math.round(currentAverageOrderValue * 100) / 100,\n\t\t\tprevious: Math.round(previousAverageOrderValue * 100) / 100,\n\t\t\tgrowth: Math.round(averageOrderValueGrowth * 10) / 10,\n\t\t},\n\t};\n}\n\n// Get top products by revenue\nexport async function getTopProducts(period = \"30days\", limit = 5) {\n\tconst { tenantId } = await requireStoreAccess();\n\tconst { startDate, endDate } = getDateRange(period);\n\n\t// Get order items with product info\n\tconst orderItems = await db.orderItem.findMany({\n\t\twhere: {\n\t\t\torder: {\n\t\t\t\ttenantId,\n\t\t\t\tcreatedAt: {\n\t\t\t\t\tgte: startDate,\n\t\t\t\t\tlte: endDate,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tinclude: {\n\t\t\tproduct: {\n\t\t\t\tselect: {\n\t\t\t\t\tid: true,\n\t\t\t\t\tslug: true,\n\t\t\t\t\ttranslations: {\n\t\t\t\t\t\tselect: {\n\t\t\t\t\t\t\tname: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\t// Aggregate by product\n\tconst productStats = new Map<\n\t\tstring,\n\t\t{ name: string; revenue: number; sales: number }\n\t>();\n\n\tfor (const item of orderItems) {\n\t\tif (!item.product) continue;\n\n\t\tconst productId = item.product.id;\n\t\tconst productName = item.product.translations[0]?.name ?? item.product.slug;\n\t\tconst revenue = Number(item.price) * item.quantity;\n\n\t\tconst existing = productStats.get(productId);\n\t\tif (existing) {\n\t\t\texisting.revenue += revenue;\n\t\t\texisting.sales += item.quantity;\n\t\t} else {\n\t\t\tproductStats.set(productId, {\n\t\t\t\tname: productName,\n\t\t\t\trevenue,\n\t\t\t\tsales: item.quantity,\n\t\t\t});\n\t\t}\n\t}\n\n\t// Sort by revenue and take top N\n\tconst topProducts = Array.from(productStats.entries())\n\t\t.map(([id, stats]) => ({\n\t\t\tid,\n\t\t\t...stats,\n\t\t}))\n\t\t.sort((a, b) => b.revenue - a.revenue)\n\t\t.slice(0, limit);\n\n\treturn topProducts;\n}\n\n// Get top categories by revenue\nexport async function getTopCategories(period = \"30days\", limit = 5) {\n\tconst { tenantId } = await requireStoreAccess();\n\tconst { startDate, endDate } = getDateRange(period);\n\n\t// Get order items with product and category info\n\tconst orderItems = await db.orderItem.findMany({\n\t\twhere: {\n\t\t\torder: {\n\t\t\t\ttenantId,\n\t\t\t\tcreatedAt: {\n\t\t\t\t\tgte: startDate,\n\t\t\t\t\tlte: endDate,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tinclude: {\n\t\t\tproduct: {\n\t\t\t\tselect: {\n\t\t\t\t\tid: true,\n\t\t\t\t\tcategoryId: true,\n\t\t\t\t\tcategory: {\n\t\t\t\t\t\tselect: {\n\t\t\t\t\t\t\tid: true,\n\t\t\t\t\t\t\tslug: true,\n\t\t\t\t\t\t\ttranslations: {\n\t\t\t\t\t\t\t\tselect: {\n\t\t\t\t\t\t\t\t\tname: true,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\t// Aggregate by category\n\tconst categoryStats = new Map<\n\t\tstring,\n\t\t{ name: string; revenue: number; orders: Set<string> }\n\t>();\n\n\tfor (const item of orderItems) {\n\t\tif (!item.product?.category) continue;\n\n\t\tconst categoryId = item.product.category.id;\n\t\tconst categoryName =\n\t\t\titem.product.category.translations[0]?.name ?? item.product.category.slug;\n\t\tconst revenue = Number(item.price) * item.quantity;\n\n\t\tconst existing = categoryStats.get(categoryId);\n\t\tif (existing) {\n\t\t\texisting.revenue += revenue;\n\t\t\texisting.orders.add(item.orderId);\n\t\t} else {\n\t\t\tcategoryStats.set(categoryId, {\n\t\t\t\tname: categoryName,\n\t\t\t\trevenue,\n\t\t\t\torders: new Set([item.orderId]),\n\t\t\t});\n\t\t}\n\t}\n\n\t// Calculate total revenue for percentage\n\tconst totalRevenue = Array.from(categoryStats.values()).reduce(\n\t\t(sum, stats) => sum + stats.revenue,\n\t\t0,\n\t);\n\n\t// Sort by revenue and take top N\n\tconst topCategories = Array.from(categoryStats.entries())\n\t\t.map(([id, stats]) => ({\n\t\t\tid,\n\t\t\tname: stats.name,\n\t\t\trevenue: stats.revenue,\n\t\t\torders: stats.orders.size,\n\t\t\tshare:\n\t\t\t\ttotalRevenue > 0 ? Math.round((stats.revenue / totalRevenue) * 100) : 0,\n\t\t}))\n\t\t.sort((a, b) => b.revenue - a.revenue)\n\t\t.slice(0, limit);\n\n\treturn topCategories;\n}\n\n// Get recent activity\nexport async function getRecentActivity(limit = 10) {\n\tconst { tenantId } = await requireStoreAccess();\n\n\t// Get recent orders\n\tconst recentOrders = await db.order.findMany({\n\t\twhere: { tenantId },\n\t\torderBy: { createdAt: \"desc\" },\n\t\ttake: limit,\n\t\tselect: {\n\t\t\tid: true,\n\t\t\torderNumber: true,\n\t\t\ttotalAmount: true,\n\t\t\tstatus: true,\n\t\t\tcreatedAt: true,\n\t\t\tcustomer: {\n\t\t\t\tselect: {\n\t\t\t\t\tfirstName: true,\n\t\t\t\t\tlastName: true,\n\t\t\t\t\temail: true,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\t// Get recent customers\n\tconst recentCustomers = await db.customer.findMany({\n\t\twhere: { tenantId },\n\t\torderBy: { createdAt: \"desc\" },\n\t\ttake: limit,\n\t\tselect: {\n\t\t\tid: true,\n\t\t\tfirstName: true,\n\t\t\tlastName: true,\n\t\t\temail: true,\n\t\t\tcreatedAt: true,\n\t\t},\n\t});\n\n\t// Get recent reviews\n\tconst recentReviews = await db.review.findMany({\n\t\twhere: { tenantId },\n\t\torderBy: { createdAt: \"desc\" },\n\t\ttake: limit,\n\t\tselect: {\n\t\t\tid: true,\n\t\t\trating: true,\n\t\t\tcreatedAt: true,\n\t\t\tproduct: {\n\t\t\t\tselect: {\n\t\t\t\t\tslug: true,\n\t\t\t\t\ttranslations: {\n\t\t\t\t\t\tselect: {\n\t\t\t\t\t\t\tname: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\t// Combine and sort by date\n\ttype Activity = {\n\t\tid: string;\n\t\ttype: \"order\" | \"customer\" | \"review\";\n\t\taction: string;\n\t\tdetails: string;\n\t\ttimestamp: Date;\n\t};\n\n\tconst activities: Activity[] = [];\n\n\tfor (const order of recentOrders) {\n\t\tconst customerName = order.customer\n\t\t\t? `${order.customer.firstName ?? \"\"} ${order.customer.lastName ?? \"\"}`.trim() ||\n\t\t\t\torder.customer.email\n\t\t\t: \"Guest\";\n\n\t\tactivities.push({\n\t\t\tid: `order-${order.id}`,\n\t\t\ttype: \"order\",\n\t\t\taction:\n\t\t\t\torder.status === \"PENDING\"\n\t\t\t\t\t? \"New order\"\n\t\t\t\t\t: `Order ${order.status.toLowerCase()}`,\n\t\t\tdetails: `#${order.orderNumber} - ${customerName} - $${Number(order.totalAmount).toFixed(2)}`,\n\t\t\ttimestamp: order.createdAt,\n\t\t});\n\t}\n\n\tfor (const customer of recentCustomers) {\n\t\tconst customerName =\n\t\t\t`${customer.firstName ?? \"\"} ${customer.lastName ?? \"\"}`.trim() ||\n\t\t\tcustomer.email;\n\n\t\tactivities.push({\n\t\t\tid: `customer-${customer.id}`,\n\t\t\ttype: \"customer\",\n\t\t\taction: \"New customer\",\n\t\t\tdetails: `${customerName} registered`,\n\t\t\ttimestamp: customer.createdAt,\n\t\t});\n\t}\n\n\tfor (const review of recentReviews) {\n\t\tconst productName =\n\t\t\treview.product.translations[0]?.name ?? review.product.slug;\n\n\t\tactivities.push({\n\t\t\tid: `review-${review.id}`,\n\t\t\ttype: \"review\",\n\t\t\taction: \"Review posted\",\n\t\t\tdetails: `${review.rating} stars - ${productName}`,\n\t\t\ttimestamp: review.createdAt,\n\t\t});\n\t}\n\n\t// Sort by timestamp and take top N\n\tactivities.sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime());\n\n\treturn activities.slice(0, limit).map((activity) => ({\n\t\t...activity,\n\t\ttime: getRelativeTime(activity.timestamp),\n\t}));\n}\n\n// Helper function to get relative time\nfunction getRelativeTime(date: Date): string {\n\tconst now = new Date();\n\tconst diffMs = now.getTime() - date.getTime();\n\tconst diffMins = Math.floor(diffMs / 60000);\n\tconst diffHours = Math.floor(diffMs / 3600000);\n\tconst diffDays = Math.floor(diffMs / 86400000);\n\n\tif (diffMins < 1) return \"Just now\";\n\tif (diffMins < 60) return `${diffMins} minute${diffMins > 1 ? \"s\" : \"\"} ago`;\n\tif (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? \"s\" : \"\"} ago`;\n\tif (diffDays < 7) return `${diffDays} day${diffDays > 1 ? \"s\" : \"\"} ago`;\n\n\treturn date.toLocaleDateString();\n}\n\n// Get orders by status\nexport async function getOrdersByStatus(period = \"30days\") {\n\tconst { tenantId } = await requireStoreAccess();\n\tconst { startDate, endDate } = getDateRange(period);\n\n\tconst orders = await db.order.groupBy({\n\t\tby: [\"status\"],\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: startDate,\n\t\t\t\tlte: endDate,\n\t\t\t},\n\t\t},\n\t\t_count: {\n\t\t\tid: true,\n\t\t},\n\t});\n\n\treturn orders.map((o) => ({\n\t\tstatus: o.status,\n\t\tcount: o._count.id,\n\t}));\n}\n\n// Get revenue by day for chart\nexport async function getRevenueByDay(period = \"30days\") {\n\tconst { tenantId } = await requireStoreAccess();\n\tconst { startDate, endDate } = getDateRange(period);\n\n\tconst orders = await db.order.findMany({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: startDate,\n\t\t\t\tlte: endDate,\n\t\t\t},\n\t\t},\n\t\tselect: {\n\t\t\ttotalAmount: true,\n\t\t\tcreatedAt: true,\n\t\t},\n\t\torderBy: {\n\t\t\tcreatedAt: \"asc\",\n\t\t},\n\t});\n\n\t// Group by day\n\tconst dailyRevenue = new Map<string, number>();\n\n\tfor (const order of orders) {\n\t\tconst day = order.createdAt.toISOString().split(\"T\")[0];\n\t\tif (!day) continue;\n\t\tconst amount = Number(order.totalAmount);\n\n\t\tdailyRevenue.set(day, (dailyRevenue.get(day) ?? 0) + amount);\n\t}\n\n\treturn Array.from(dailyRevenue.entries()).map(([date, revenue]) => ({\n\t\tdate,\n\t\trevenue: Math.round(revenue * 100) / 100,\n\t}));\n}\n"],"names":[],"mappings":";;;;;;;MAuUsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,oDAAA"}},
    {"offset": {"line": 499, "column": 0}, "map": {"version":3,"sources":["file:///Users/bobkata/Projects/boostcart/apps/platform/src/server/api/internal/analytics.ts"],"sourcesContent":["\"use server\";\n\nimport { auth } from \"@/server/auth\";\nimport { db } from \"@/server/db\";\nimport { requireAdminTenant } from \"@/server/tenant\";\n\nasync function requireStoreAccess() {\n\tconst session = await auth();\n\tif (!session?.user?.id) {\n\t\tthrow new Error(\"Unauthorized\");\n\t}\n\n\tconst tenant = await requireAdminTenant();\n\n\tconst staffRecord = await db.tenantStaff.findFirst({\n\t\twhere: {\n\t\t\tuserId: session.user.id,\n\t\t\ttenantId: tenant.id,\n\t\t},\n\t});\n\n\tif (!staffRecord) {\n\t\tthrow new Error(\"Forbidden: No access to this store\");\n\t}\n\n\treturn {\n\t\tuserId: session.user.id,\n\t\ttenantId: tenant.id,\n\t\trole: staffRecord.role,\n\t};\n}\n\n// Get date range for analytics\nfunction getDateRange(period: string): { startDate: Date; endDate: Date } {\n\tconst endDate = new Date();\n\tconst startDate = new Date();\n\n\tswitch (period) {\n\t\tcase \"7days\":\n\t\t\tstartDate.setDate(endDate.getDate() - 7);\n\t\t\tbreak;\n\t\tcase \"30days\":\n\t\t\tstartDate.setDate(endDate.getDate() - 30);\n\t\t\tbreak;\n\t\tcase \"90days\":\n\t\t\tstartDate.setDate(endDate.getDate() - 90);\n\t\t\tbreak;\n\t\tcase \"year\":\n\t\t\tstartDate.setFullYear(endDate.getFullYear() - 1);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tstartDate.setDate(endDate.getDate() - 30);\n\t}\n\n\treturn { startDate, endDate };\n}\n\n// Get overview stats\nexport async function getAnalyticsOverview(period = \"30days\") {\n\tconst { tenantId } = await requireStoreAccess();\n\tconst { startDate, endDate } = getDateRange(period);\n\n\t// Get previous period for comparison\n\tconst periodLength = endDate.getTime() - startDate.getTime();\n\tconst previousStartDate = new Date(startDate.getTime() - periodLength);\n\tconst previousEndDate = startDate;\n\n\t// Current period orders\n\tconst currentOrders = await db.order.findMany({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: startDate,\n\t\t\t\tlte: endDate,\n\t\t\t},\n\t\t},\n\t\tselect: {\n\t\t\tid: true,\n\t\t\ttotalAmount: true,\n\t\t\tstatus: true,\n\t\t},\n\t});\n\n\t// Previous period orders\n\tconst previousOrders = await db.order.findMany({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: previousStartDate,\n\t\t\t\tlte: previousEndDate,\n\t\t\t},\n\t\t},\n\t\tselect: {\n\t\t\tid: true,\n\t\t\ttotalAmount: true,\n\t\t},\n\t});\n\n\t// Current period customers\n\tconst currentCustomers = await db.customer.count({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: startDate,\n\t\t\t\tlte: endDate,\n\t\t\t},\n\t\t},\n\t});\n\n\t// Previous period customers\n\tconst previousCustomers = await db.customer.count({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: previousStartDate,\n\t\t\t\tlte: previousEndDate,\n\t\t\t},\n\t\t},\n\t});\n\n\t// Current period products\n\tconst currentProducts = await db.product.count({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: startDate,\n\t\t\t\tlte: endDate,\n\t\t\t},\n\t\t},\n\t});\n\n\t// Total products\n\tconst totalProducts = await db.product.count({\n\t\twhere: { tenantId },\n\t});\n\n\t// Get products sold in current period\n\tconst currentOrderItems = await db.orderItem.findMany({\n\t\twhere: {\n\t\t\torder: {\n\t\t\t\ttenantId,\n\t\t\t\tcreatedAt: {\n\t\t\t\t\tgte: startDate,\n\t\t\t\t\tlte: endDate,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tselect: {\n\t\t\tquantity: true,\n\t\t},\n\t});\n\n\t// Get products sold in previous period\n\tconst previousOrderItems = await db.orderItem.findMany({\n\t\twhere: {\n\t\t\torder: {\n\t\t\t\ttenantId,\n\t\t\t\tcreatedAt: {\n\t\t\t\t\tgte: previousStartDate,\n\t\t\t\t\tlte: previousEndDate,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tselect: {\n\t\t\tquantity: true,\n\t\t},\n\t});\n\n\tconst currentProductsSold = currentOrderItems.reduce(\n\t\t(sum, item) => sum + item.quantity,\n\t\t0,\n\t);\n\tconst previousProductsSold = previousOrderItems.reduce(\n\t\t(sum, item) => sum + item.quantity,\n\t\t0,\n\t);\n\n\tconst productsSoldGrowth =\n\t\tpreviousProductsSold > 0\n\t\t\t? ((currentProductsSold - previousProductsSold) / previousProductsSold) *\n\t\t\t\t100\n\t\t\t: 0;\n\n\t// Calculate metrics\n\tconst currentRevenue = currentOrders.reduce(\n\t\t(sum, order) => sum + Number(order.totalAmount),\n\t\t0,\n\t);\n\tconst previousRevenue = previousOrders.reduce(\n\t\t(sum, order) => sum + Number(order.totalAmount),\n\t\t0,\n\t);\n\n\tconst revenueGrowth =\n\t\tpreviousRevenue > 0\n\t\t\t? ((currentRevenue - previousRevenue) / previousRevenue) * 100\n\t\t\t: 0;\n\n\tconst ordersGrowth =\n\t\tpreviousOrders.length > 0\n\t\t\t? ((currentOrders.length - previousOrders.length) /\n\t\t\t\t\tpreviousOrders.length) *\n\t\t\t\t100\n\t\t\t: 0;\n\n\tconst customersGrowth =\n\t\tpreviousCustomers > 0\n\t\t\t? ((currentCustomers - previousCustomers) / previousCustomers) * 100\n\t\t\t: 0;\n\n\tconst currentAverageOrderValue =\n\t\tcurrentOrders.length > 0 ? currentRevenue / currentOrders.length : 0;\n\n\tconst previousAverageOrderValue =\n\t\tpreviousOrders.length > 0 ? previousRevenue / previousOrders.length : 0;\n\n\tconst averageOrderValueGrowth =\n\t\tpreviousAverageOrderValue > 0\n\t\t\t? ((currentAverageOrderValue - previousAverageOrderValue) /\n\t\t\t\t\tpreviousAverageOrderValue) *\n\t\t\t\t100\n\t\t\t: 0;\n\n\treturn {\n\t\trevenue: {\n\t\t\ttotal: currentRevenue,\n\t\t\tprevious: previousRevenue,\n\t\t\tgrowth: Math.round(revenueGrowth * 10) / 10,\n\t\t},\n\t\torders: {\n\t\t\ttotal: currentOrders.length,\n\t\t\tprevious: previousOrders.length,\n\t\t\tgrowth: Math.round(ordersGrowth * 10) / 10,\n\t\t},\n\t\tcustomers: {\n\t\t\ttotal: currentCustomers,\n\t\t\tprevious: previousCustomers,\n\t\t\tgrowth: Math.round(customersGrowth * 10) / 10,\n\t\t},\n\t\tproducts: {\n\t\t\ttotal: totalProducts,\n\t\t\tnew: currentProducts,\n\t\t},\n\t\tproductsSold: {\n\t\t\ttotal: currentProductsSold,\n\t\t\tprevious: previousProductsSold,\n\t\t\tgrowth: Math.round(productsSoldGrowth * 10) / 10,\n\t\t},\n\t\taverageOrderValue: {\n\t\t\ttotal: Math.round(currentAverageOrderValue * 100) / 100,\n\t\t\tprevious: Math.round(previousAverageOrderValue * 100) / 100,\n\t\t\tgrowth: Math.round(averageOrderValueGrowth * 10) / 10,\n\t\t},\n\t};\n}\n\n// Get top products by revenue\nexport async function getTopProducts(period = \"30days\", limit = 5) {\n\tconst { tenantId } = await requireStoreAccess();\n\tconst { startDate, endDate } = getDateRange(period);\n\n\t// Get order items with product info\n\tconst orderItems = await db.orderItem.findMany({\n\t\twhere: {\n\t\t\torder: {\n\t\t\t\ttenantId,\n\t\t\t\tcreatedAt: {\n\t\t\t\t\tgte: startDate,\n\t\t\t\t\tlte: endDate,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tinclude: {\n\t\t\tproduct: {\n\t\t\t\tselect: {\n\t\t\t\t\tid: true,\n\t\t\t\t\tslug: true,\n\t\t\t\t\ttranslations: {\n\t\t\t\t\t\tselect: {\n\t\t\t\t\t\t\tname: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\t// Aggregate by product\n\tconst productStats = new Map<\n\t\tstring,\n\t\t{ name: string; revenue: number; sales: number }\n\t>();\n\n\tfor (const item of orderItems) {\n\t\tif (!item.product) continue;\n\n\t\tconst productId = item.product.id;\n\t\tconst productName = item.product.translations[0]?.name ?? item.product.slug;\n\t\tconst revenue = Number(item.price) * item.quantity;\n\n\t\tconst existing = productStats.get(productId);\n\t\tif (existing) {\n\t\t\texisting.revenue += revenue;\n\t\t\texisting.sales += item.quantity;\n\t\t} else {\n\t\t\tproductStats.set(productId, {\n\t\t\t\tname: productName,\n\t\t\t\trevenue,\n\t\t\t\tsales: item.quantity,\n\t\t\t});\n\t\t}\n\t}\n\n\t// Sort by revenue and take top N\n\tconst topProducts = Array.from(productStats.entries())\n\t\t.map(([id, stats]) => ({\n\t\t\tid,\n\t\t\t...stats,\n\t\t}))\n\t\t.sort((a, b) => b.revenue - a.revenue)\n\t\t.slice(0, limit);\n\n\treturn topProducts;\n}\n\n// Get top categories by revenue\nexport async function getTopCategories(period = \"30days\", limit = 5) {\n\tconst { tenantId } = await requireStoreAccess();\n\tconst { startDate, endDate } = getDateRange(period);\n\n\t// Get order items with product and category info\n\tconst orderItems = await db.orderItem.findMany({\n\t\twhere: {\n\t\t\torder: {\n\t\t\t\ttenantId,\n\t\t\t\tcreatedAt: {\n\t\t\t\t\tgte: startDate,\n\t\t\t\t\tlte: endDate,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tinclude: {\n\t\t\tproduct: {\n\t\t\t\tselect: {\n\t\t\t\t\tid: true,\n\t\t\t\t\tcategoryId: true,\n\t\t\t\t\tcategory: {\n\t\t\t\t\t\tselect: {\n\t\t\t\t\t\t\tid: true,\n\t\t\t\t\t\t\tslug: true,\n\t\t\t\t\t\t\ttranslations: {\n\t\t\t\t\t\t\t\tselect: {\n\t\t\t\t\t\t\t\t\tname: true,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\t// Aggregate by category\n\tconst categoryStats = new Map<\n\t\tstring,\n\t\t{ name: string; revenue: number; orders: Set<string> }\n\t>();\n\n\tfor (const item of orderItems) {\n\t\tif (!item.product?.category) continue;\n\n\t\tconst categoryId = item.product.category.id;\n\t\tconst categoryName =\n\t\t\titem.product.category.translations[0]?.name ?? item.product.category.slug;\n\t\tconst revenue = Number(item.price) * item.quantity;\n\n\t\tconst existing = categoryStats.get(categoryId);\n\t\tif (existing) {\n\t\t\texisting.revenue += revenue;\n\t\t\texisting.orders.add(item.orderId);\n\t\t} else {\n\t\t\tcategoryStats.set(categoryId, {\n\t\t\t\tname: categoryName,\n\t\t\t\trevenue,\n\t\t\t\torders: new Set([item.orderId]),\n\t\t\t});\n\t\t}\n\t}\n\n\t// Calculate total revenue for percentage\n\tconst totalRevenue = Array.from(categoryStats.values()).reduce(\n\t\t(sum, stats) => sum + stats.revenue,\n\t\t0,\n\t);\n\n\t// Sort by revenue and take top N\n\tconst topCategories = Array.from(categoryStats.entries())\n\t\t.map(([id, stats]) => ({\n\t\t\tid,\n\t\t\tname: stats.name,\n\t\t\trevenue: stats.revenue,\n\t\t\torders: stats.orders.size,\n\t\t\tshare:\n\t\t\t\ttotalRevenue > 0 ? Math.round((stats.revenue / totalRevenue) * 100) : 0,\n\t\t}))\n\t\t.sort((a, b) => b.revenue - a.revenue)\n\t\t.slice(0, limit);\n\n\treturn topCategories;\n}\n\n// Get recent activity\nexport async function getRecentActivity(limit = 10) {\n\tconst { tenantId } = await requireStoreAccess();\n\n\t// Get recent orders\n\tconst recentOrders = await db.order.findMany({\n\t\twhere: { tenantId },\n\t\torderBy: { createdAt: \"desc\" },\n\t\ttake: limit,\n\t\tselect: {\n\t\t\tid: true,\n\t\t\torderNumber: true,\n\t\t\ttotalAmount: true,\n\t\t\tstatus: true,\n\t\t\tcreatedAt: true,\n\t\t\tcustomer: {\n\t\t\t\tselect: {\n\t\t\t\t\tfirstName: true,\n\t\t\t\t\tlastName: true,\n\t\t\t\t\temail: true,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\t// Get recent customers\n\tconst recentCustomers = await db.customer.findMany({\n\t\twhere: { tenantId },\n\t\torderBy: { createdAt: \"desc\" },\n\t\ttake: limit,\n\t\tselect: {\n\t\t\tid: true,\n\t\t\tfirstName: true,\n\t\t\tlastName: true,\n\t\t\temail: true,\n\t\t\tcreatedAt: true,\n\t\t},\n\t});\n\n\t// Get recent reviews\n\tconst recentReviews = await db.review.findMany({\n\t\twhere: { tenantId },\n\t\torderBy: { createdAt: \"desc\" },\n\t\ttake: limit,\n\t\tselect: {\n\t\t\tid: true,\n\t\t\trating: true,\n\t\t\tcreatedAt: true,\n\t\t\tproduct: {\n\t\t\t\tselect: {\n\t\t\t\t\tslug: true,\n\t\t\t\t\ttranslations: {\n\t\t\t\t\t\tselect: {\n\t\t\t\t\t\t\tname: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\t// Combine and sort by date\n\ttype Activity = {\n\t\tid: string;\n\t\ttype: \"order\" | \"customer\" | \"review\";\n\t\taction: string;\n\t\tdetails: string;\n\t\ttimestamp: Date;\n\t};\n\n\tconst activities: Activity[] = [];\n\n\tfor (const order of recentOrders) {\n\t\tconst customerName = order.customer\n\t\t\t? `${order.customer.firstName ?? \"\"} ${order.customer.lastName ?? \"\"}`.trim() ||\n\t\t\t\torder.customer.email\n\t\t\t: \"Guest\";\n\n\t\tactivities.push({\n\t\t\tid: `order-${order.id}`,\n\t\t\ttype: \"order\",\n\t\t\taction:\n\t\t\t\torder.status === \"PENDING\"\n\t\t\t\t\t? \"New order\"\n\t\t\t\t\t: `Order ${order.status.toLowerCase()}`,\n\t\t\tdetails: `#${order.orderNumber} - ${customerName} - $${Number(order.totalAmount).toFixed(2)}`,\n\t\t\ttimestamp: order.createdAt,\n\t\t});\n\t}\n\n\tfor (const customer of recentCustomers) {\n\t\tconst customerName =\n\t\t\t`${customer.firstName ?? \"\"} ${customer.lastName ?? \"\"}`.trim() ||\n\t\t\tcustomer.email;\n\n\t\tactivities.push({\n\t\t\tid: `customer-${customer.id}`,\n\t\t\ttype: \"customer\",\n\t\t\taction: \"New customer\",\n\t\t\tdetails: `${customerName} registered`,\n\t\t\ttimestamp: customer.createdAt,\n\t\t});\n\t}\n\n\tfor (const review of recentReviews) {\n\t\tconst productName =\n\t\t\treview.product.translations[0]?.name ?? review.product.slug;\n\n\t\tactivities.push({\n\t\t\tid: `review-${review.id}`,\n\t\t\ttype: \"review\",\n\t\t\taction: \"Review posted\",\n\t\t\tdetails: `${review.rating} stars - ${productName}`,\n\t\t\ttimestamp: review.createdAt,\n\t\t});\n\t}\n\n\t// Sort by timestamp and take top N\n\tactivities.sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime());\n\n\treturn activities.slice(0, limit).map((activity) => ({\n\t\t...activity,\n\t\ttime: getRelativeTime(activity.timestamp),\n\t}));\n}\n\n// Helper function to get relative time\nfunction getRelativeTime(date: Date): string {\n\tconst now = new Date();\n\tconst diffMs = now.getTime() - date.getTime();\n\tconst diffMins = Math.floor(diffMs / 60000);\n\tconst diffHours = Math.floor(diffMs / 3600000);\n\tconst diffDays = Math.floor(diffMs / 86400000);\n\n\tif (diffMins < 1) return \"Just now\";\n\tif (diffMins < 60) return `${diffMins} minute${diffMins > 1 ? \"s\" : \"\"} ago`;\n\tif (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? \"s\" : \"\"} ago`;\n\tif (diffDays < 7) return `${diffDays} day${diffDays > 1 ? \"s\" : \"\"} ago`;\n\n\treturn date.toLocaleDateString();\n}\n\n// Get orders by status\nexport async function getOrdersByStatus(period = \"30days\") {\n\tconst { tenantId } = await requireStoreAccess();\n\tconst { startDate, endDate } = getDateRange(period);\n\n\tconst orders = await db.order.groupBy({\n\t\tby: [\"status\"],\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: startDate,\n\t\t\t\tlte: endDate,\n\t\t\t},\n\t\t},\n\t\t_count: {\n\t\t\tid: true,\n\t\t},\n\t});\n\n\treturn orders.map((o) => ({\n\t\tstatus: o.status,\n\t\tcount: o._count.id,\n\t}));\n}\n\n// Get revenue by day for chart\nexport async function getRevenueByDay(period = \"30days\") {\n\tconst { tenantId } = await requireStoreAccess();\n\tconst { startDate, endDate } = getDateRange(period);\n\n\tconst orders = await db.order.findMany({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tcreatedAt: {\n\t\t\t\tgte: startDate,\n\t\t\t\tlte: endDate,\n\t\t\t},\n\t\t},\n\t\tselect: {\n\t\t\ttotalAmount: true,\n\t\t\tcreatedAt: true,\n\t\t},\n\t\torderBy: {\n\t\t\tcreatedAt: \"asc\",\n\t\t},\n\t});\n\n\t// Group by day\n\tconst dailyRevenue = new Map<string, number>();\n\n\tfor (const order of orders) {\n\t\tconst day = order.createdAt.toISOString().split(\"T\")[0];\n\t\tif (!day) continue;\n\t\tconst amount = Number(order.totalAmount);\n\n\t\tdailyRevenue.set(day, (dailyRevenue.get(day) ?? 0) + amount);\n\t}\n\n\treturn Array.from(dailyRevenue.entries()).map(([date, revenue]) => ({\n\t\tdate,\n\t\trevenue: Math.round(revenue * 100) / 100,\n\t}));\n}\n"],"names":[],"mappings":";;;;;;;MAiQsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,kDAAA"}},
    {"offset": {"line": 516, "column": 0}, "map": {"version":3,"sources":["file:///Users/bobkata/Projects/boostcart/apps/platform/src/app/%28internal%29/admin/analytics/page.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n\tDollarSign,\n\tEye,\n\tLoader2,\n\tPackage,\n\tShoppingBag,\n\tShoppingCart,\n\tTrendingDown,\n\tTrendingUp,\n\tUsers,\n} from \"lucide-react\";\nimport * as React from \"react\";\nimport { toast } from \"sonner\";\nimport { Card } from \"@/components/ui/card\";\nimport {\n\tSelect,\n\tSelectContent,\n\tSelectItem,\n\tSelectTrigger,\n\tSelectValue,\n} from \"@/components/ui/select\";\nimport {\n\tgetAnalyticsOverview,\n\tgetRecentActivity,\n\tgetTopCategories,\n\tgetTopProducts,\n} from \"@/server/api/internal/analytics\";\n\ntype Period = \"7days\" | \"30days\" | \"90days\" | \"year\";\ntype Overview = Awaited<ReturnType<typeof getAnalyticsOverview>>;\ntype TopProduct = Awaited<ReturnType<typeof getTopProducts>>[number];\ntype TopCategory = Awaited<ReturnType<typeof getTopCategories>>[number];\ntype Activity = Awaited<ReturnType<typeof getRecentActivity>>[number];\n\nfunction formatCurrency(amount: number, currency = \"BGN\"): string {\n\treturn new Intl.NumberFormat(\"bg-BG\", {\n\t\tstyle: \"currency\",\n\t\tcurrency,\n\t\tminimumFractionDigits: 0,\n\t\tmaximumFractionDigits: 2,\n\t}).format(amount);\n}\n\nfunction formatNumber(num: number): string {\n\treturn new Intl.NumberFormat(\"bg-BG\").format(num);\n}\n\nexport default function AnalyticsPage() {\n\tconst [isLoading, setIsLoading] = React.useState(true);\n\tconst [period, setPeriod] = React.useState<Period>(\"30days\");\n\tconst [overview, setOverview] = React.useState<Overview | null>(null);\n\tconst [topProducts, setTopProducts] = React.useState<TopProduct[]>([]);\n\tconst [topCategories, setTopCategories] = React.useState<TopCategory[]>([]);\n\tconst [recentActivity, setRecentActivity] = React.useState<Activity[]>([]);\n\n\tconst fetchAnalytics = React.useCallback(async (selectedPeriod: Period) => {\n\t\tsetIsLoading(true);\n\t\ttry {\n\t\t\tconst [overviewData, productsData, categoriesData, activityData] =\n\t\t\t\tawait Promise.all([\n\t\t\t\t\tgetAnalyticsOverview(selectedPeriod),\n\t\t\t\t\tgetTopProducts(selectedPeriod, 5),\n\t\t\t\t\tgetTopCategories(selectedPeriod, 5),\n\t\t\t\t\tgetRecentActivity(5),\n\t\t\t\t]);\n\n\t\t\tsetOverview(overviewData);\n\t\t\tsetTopProducts(productsData);\n\t\t\tsetTopCategories(categoriesData);\n\t\t\tsetRecentActivity(activityData);\n\t\t} catch (error) {\n\t\t\tconsole.error(\"Failed to fetch analytics:\", error);\n\t\t\ttoast.error(\"Failed to load analytics data\");\n\t\t} finally {\n\t\t\tsetIsLoading(false);\n\t\t}\n\t}, []);\n\n\tReact.useEffect(() => {\n\t\tfetchAnalytics(period);\n\t}, [period, fetchAnalytics]);\n\n\tconst handlePeriodChange = (value: string) => {\n\t\tsetPeriod(value as Period);\n\t};\n\n\tif (isLoading && !overview) {\n\t\treturn (\n\t\t\t<div className=\"flex items-center justify-center min-h-[400px]\">\n\t\t\t\t<Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn (\n\t\t<div className=\"space-y-6\">\n\t\t\t{/* Header */}\n\t\t\t<div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n\t\t\t\t<div>\n\t\t\t\t\t<h1 className=\"text-3xl font-bold tracking-tight\">Analytics</h1>\n\t\t\t\t\t<p className=\"text-muted-foreground mt-1\">\n\t\t\t\t\t\tTrack your store performance and insights\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t\t<Select value={period} onValueChange={handlePeriodChange}>\n\t\t\t\t\t<SelectTrigger className=\"w-45\">\n\t\t\t\t\t\t<SelectValue placeholder=\"Select period\" />\n\t\t\t\t\t</SelectTrigger>\n\t\t\t\t\t<SelectContent>\n\t\t\t\t\t\t<SelectItem value=\"7days\">Last 7 days</SelectItem>\n\t\t\t\t\t\t<SelectItem value=\"30days\">Last 30 days</SelectItem>\n\t\t\t\t\t\t<SelectItem value=\"90days\">Last 90 days</SelectItem>\n\t\t\t\t\t\t<SelectItem value=\"year\">This year</SelectItem>\n\t\t\t\t\t</SelectContent>\n\t\t\t\t</Select>\n\t\t\t</div>\n\n\t\t\t{/* Key Metrics */}\n\t\t\t<div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\n\t\t\t\t<Card className=\"p-6\">\n\t\t\t\t\t<div className=\"flex items-center justify-between space-y-0 pb-2\">\n\t\t\t\t\t\t<h3 className=\"text-sm font-medium text-muted-foreground\">\n\t\t\t\t\t\t\tTotal Revenue\n\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t<DollarSign className=\"h-4 w-4 text-muted-foreground\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"space-y-1\">\n\t\t\t\t\t\t<p className=\"text-2xl font-bold\">\n\t\t\t\t\t\t\t{overview ? formatCurrency(overview.revenue.total) : \"-\"}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground flex items-center gap-1\">\n\t\t\t\t\t\t\t{overview && overview.revenue.growth >= 0 ? (\n\t\t\t\t\t\t\t\t<TrendingUp className=\"h-3 w-3 text-green-600\" />\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<TrendingDown className=\"h-3 w-3 text-red-600\" />\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t\toverview && overview.revenue.growth >= 0\n\t\t\t\t\t\t\t\t\t\t? \"text-green-600\"\n\t\t\t\t\t\t\t\t\t\t: \"text-red-600\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{overview\n\t\t\t\t\t\t\t\t\t? `${overview.revenue.growth >= 0 ? \"+\" : \"\"}${overview.revenue.growth.toFixed(1)}%`\n\t\t\t\t\t\t\t\t\t: \"-\"}\n\t\t\t\t\t\t\t</span>{\" \"}\n\t\t\t\t\t\t\tfrom last period\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</Card>\n\n\t\t\t\t<Card className=\"p-6\">\n\t\t\t\t\t<div className=\"flex items-center justify-between space-y-0 pb-2\">\n\t\t\t\t\t\t<h3 className=\"text-sm font-medium text-muted-foreground\">\n\t\t\t\t\t\t\tTotal Orders\n\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t<ShoppingCart className=\"h-4 w-4 text-muted-foreground\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"space-y-1\">\n\t\t\t\t\t\t<p className=\"text-2xl font-bold\">\n\t\t\t\t\t\t\t{overview ? formatNumber(overview.orders.total) : \"-\"}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground flex items-center gap-1\">\n\t\t\t\t\t\t\t{overview && overview.orders.growth >= 0 ? (\n\t\t\t\t\t\t\t\t<TrendingUp className=\"h-3 w-3 text-green-600\" />\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<TrendingDown className=\"h-3 w-3 text-red-600\" />\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t\toverview && overview.orders.growth >= 0\n\t\t\t\t\t\t\t\t\t\t? \"text-green-600\"\n\t\t\t\t\t\t\t\t\t\t: \"text-red-600\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{overview\n\t\t\t\t\t\t\t\t\t? `${overview.orders.growth >= 0 ? \"+\" : \"\"}${overview.orders.growth.toFixed(1)}%`\n\t\t\t\t\t\t\t\t\t: \"-\"}\n\t\t\t\t\t\t\t</span>{\" \"}\n\t\t\t\t\t\t\tfrom last period\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</Card>\n\n\t\t\t\t<Card className=\"p-6\">\n\t\t\t\t\t<div className=\"flex items-center justify-between space-y-0 pb-2\">\n\t\t\t\t\t\t<h3 className=\"text-sm font-medium text-muted-foreground\">\n\t\t\t\t\t\t\tNew Customers\n\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t<ShoppingBag className=\"h-4 w-4 text-muted-foreground\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"space-y-1\">\n\t\t\t\t\t\t<p className=\"text-2xl font-bold\">\n\t\t\t\t\t\t\t{overview ? formatNumber(overview.customers.total) : \"-\"}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground flex items-center gap-1\">\n\t\t\t\t\t\t\t{overview && overview.customers.growth >= 0 ? (\n\t\t\t\t\t\t\t\t<TrendingUp className=\"h-3 w-3 text-green-600\" />\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<TrendingDown className=\"h-3 w-3 text-red-600\" />\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t\toverview && overview.customers.growth >= 0\n\t\t\t\t\t\t\t\t\t\t? \"text-green-600\"\n\t\t\t\t\t\t\t\t\t\t: \"text-red-600\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{overview\n\t\t\t\t\t\t\t\t\t? `${overview.customers.growth >= 0 ? \"+\" : \"\"}${overview.customers.growth.toFixed(1)}%`\n\t\t\t\t\t\t\t\t\t: \"-\"}\n\t\t\t\t\t\t\t</span>{\" \"}\n\t\t\t\t\t\t\tfrom last period\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</Card>\n\n\t\t\t\t<Card className=\"p-6\">\n\t\t\t\t\t<div className=\"flex items-center justify-between space-y-0 pb-2\">\n\t\t\t\t\t\t<h3 className=\"text-sm font-medium text-muted-foreground\">\n\t\t\t\t\t\t\tAvg. Order Value\n\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t<DollarSign className=\"h-4 w-4 text-muted-foreground\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"space-y-1\">\n\t\t\t\t\t\t<p className=\"text-2xl font-bold\">\n\t\t\t\t\t\t\t{overview\n\t\t\t\t\t\t\t\t? formatCurrency(overview.averageOrderValue.total)\n\t\t\t\t\t\t\t\t: \"-\"}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground flex items-center gap-1\">\n\t\t\t\t\t\t\t{overview && overview.averageOrderValue.growth >= 0 ? (\n\t\t\t\t\t\t\t\t<TrendingUp className=\"h-3 w-3 text-green-600\" />\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<TrendingDown className=\"h-3 w-3 text-red-600\" />\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t\toverview && overview.averageOrderValue.growth >= 0\n\t\t\t\t\t\t\t\t\t\t? \"text-green-600\"\n\t\t\t\t\t\t\t\t\t\t: \"text-red-600\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{overview\n\t\t\t\t\t\t\t\t\t? `${overview.averageOrderValue.growth >= 0 ? \"+\" : \"\"}${overview.averageOrderValue.growth.toFixed(1)}%`\n\t\t\t\t\t\t\t\t\t: \"-\"}\n\t\t\t\t\t\t\t</span>{\" \"}\n\t\t\t\t\t\t\tfrom last period\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</Card>\n\t\t\t</div>\n\n\t\t\t{/* Secondary Metrics */}\n\t\t\t<div className=\"grid gap-4 md:grid-cols-4\">\n\t\t\t\t<Card className=\"p-4\">\n\t\t\t\t\t<div className=\"flex items-center gap-3\">\n\t\t\t\t\t\t<div className=\"h-10 w-10 rounded-lg bg-blue-100 dark:bg-blue-900 flex items-center justify-center\">\n\t\t\t\t\t\t\t<Users className=\"h-5 w-5 text-blue-600 dark:text-blue-300\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">New Customers</p>\n\t\t\t\t\t\t\t<p className=\"text-xl font-bold\">\n\t\t\t\t\t\t\t\t{overview ? formatNumber(overview.customers.total) : \"-\"}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</Card>\n\t\t\t\t<Card className=\"p-4\">\n\t\t\t\t\t<div className=\"flex items-center gap-3\">\n\t\t\t\t\t\t<div className=\"h-10 w-10 rounded-lg bg-green-100 dark:bg-green-900 flex items-center justify-center\">\n\t\t\t\t\t\t\t<Package className=\"h-5 w-5 text-green-600 dark:text-green-300\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">Products Sold</p>\n\t\t\t\t\t\t\t<p className=\"text-xl font-bold\">\n\t\t\t\t\t\t\t\t{overview ? formatNumber(overview.productsSold.total) : \"-\"}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</Card>\n\t\t\t\t<Card className=\"p-4\">\n\t\t\t\t\t<div className=\"flex items-center gap-3\">\n\t\t\t\t\t\t<div className=\"h-10 w-10 rounded-lg bg-purple-100 dark:bg-purple-900 flex items-center justify-center\">\n\t\t\t\t\t\t\t<Eye className=\"h-5 w-5 text-purple-600 dark:text-purple-300\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">Store Views</p>\n\t\t\t\t\t\t\t<p className=\"text-xl font-bold\">-</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</Card>\n\t\t\t\t<Card className=\"p-4\">\n\t\t\t\t\t<div className=\"flex items-center gap-3\">\n\t\t\t\t\t\t<div className=\"h-10 w-10 rounded-lg bg-orange-100 dark:bg-orange-900 flex items-center justify-center\">\n\t\t\t\t\t\t\t<ShoppingCart className=\"h-5 w-5 text-orange-600 dark:text-orange-300\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">Cart Abandonment</p>\n\t\t\t\t\t\t\t<p className=\"text-xl font-bold\">-</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</Card>\n\t\t\t</div>\n\n\t\t\t{/* Charts Section */}\n\t\t\t<div className=\"grid gap-6 lg:grid-cols-7\">\n\t\t\t\t{/* Top Products */}\n\t\t\t\t<Card className=\"lg:col-span-4 p-6\">\n\t\t\t\t\t<div className=\"mb-6\">\n\t\t\t\t\t\t<h2 className=\"text-xl font-bold\">Top Products</h2>\n\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground mt-1\">\n\t\t\t\t\t\t\tBest performing products by revenue\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t{topProducts.length === 0 ? (\n\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground text-center py-8\">\n\t\t\t\t\t\t\t\tNo product data available for this period\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\ttopProducts.map((product, index) => (\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tkey={product.id}\n\t\t\t\t\t\t\t\t\tclassName=\"flex items-center justify-between border-b pb-4 last:border-0 last:pb-0\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex h-10 w-10 items-center justify-center rounded-lg bg-primary/10 text-primary font-bold\">\n\t\t\t\t\t\t\t\t\t\t\t{index + 1}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"font-medium text-sm\">{product.name}</p>\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t\t{formatNumber(product.sales)} sales\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"text-right\">\n\t\t\t\t\t\t\t\t\t\t<p className=\"font-semibold text-sm\">\n\t\t\t\t\t\t\t\t\t\t\t{formatCurrency(product.revenue)}\n\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t))\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</Card>\n\n\t\t\t\t{/* Top Categories */}\n\t\t\t\t<Card className=\"lg:col-span-3 p-6\">\n\t\t\t\t\t<div className=\"mb-6\">\n\t\t\t\t\t\t<h2 className=\"text-xl font-bold\">Top Categories</h2>\n\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground mt-1\">\n\t\t\t\t\t\t\tCategories by revenue share\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t{topCategories.length === 0 ? (\n\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground text-center py-8\">\n\t\t\t\t\t\t\t\tNo category data available for this period\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\ttopCategories.map((category) => (\n\t\t\t\t\t\t\t\t<div key={category.id} className=\"space-y-2\">\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-between text-sm\">\n\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium\">{category.name}</span>\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t{category.share.toFixed(1)}%\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"h-2 bg-secondary rounded-full overflow-hidden\">\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"h-full bg-primary rounded-full\"\n\t\t\t\t\t\t\t\t\t\t\tstyle={{ width: `${Math.min(category.share, 100)}%` }}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-between text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t<span>{formatCurrency(category.revenue)}</span>\n\t\t\t\t\t\t\t\t\t\t<span>{formatNumber(category.orders)} orders</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t))\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</Card>\n\t\t\t</div>\n\n\t\t\t{/* Recent Activity */}\n\t\t\t<Card className=\"p-6\">\n\t\t\t\t<div className=\"mb-6\">\n\t\t\t\t\t<h2 className=\"text-xl font-bold\">Recent Activity</h2>\n\t\t\t\t\t<p className=\"text-sm text-muted-foreground mt-1\">\n\t\t\t\t\t\tLatest actions in your store\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t{recentActivity.length === 0 ? (\n\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground text-center py-8\">\n\t\t\t\t\t\t\tNo recent activity\n\t\t\t\t\t\t</p>\n\t\t\t\t\t) : (\n\t\t\t\t\t\trecentActivity.map((activity) => (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tkey={activity.id}\n\t\t\t\t\t\t\t\tclassName=\"flex items-start gap-3 border-b pb-4 last:border-0 last:pb-0\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div className=\"h-2 w-2 rounded-full bg-primary mt-2\" />\n\t\t\t\t\t\t\t\t<div className=\"flex-1\">\n\t\t\t\t\t\t\t\t\t<p className=\"font-medium text-sm\">{activity.action}</p>\n\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t{activity.details}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">{activity.time}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</Card>\n\t\t</div>\n\t);\n}\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA;AACA;AACA;AACA;AAOA;AAAA;AAAA;AAAA;;;AAvBA;;;;;;;AAoCA,SAAS,eAAe,MAAc,EAAE,WAAW,KAAK;IACvD,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;QACrC,OAAO;QACP;QACA,uBAAuB;QACvB,uBAAuB;IACxB,GAAG,MAAM,CAAC;AACX;AAEA,SAAS,aAAa,GAAW;IAChC,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS,MAAM,CAAC;AAC9C;AAEe,SAAS;;IACvB,MAAM,CAAC,WAAW,aAAa,GAAG,yKAAc,CAAC;IACjD,MAAM,CAAC,QAAQ,UAAU,GAAG,yKAAc,CAAS;IACnD,MAAM,CAAC,UAAU,YAAY,GAAG,yKAAc,CAAkB;IAChE,MAAM,CAAC,aAAa,eAAe,GAAG,yKAAc,CAAe,EAAE;IACrE,MAAM,CAAC,eAAe,iBAAiB,GAAG,yKAAc,CAAgB,EAAE;IAC1E,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,yKAAc,CAAa,EAAE;IAEzE,MAAM,iBAAiB,4KAAiB;qDAAC,OAAO;YAC/C,aAAa;YACb,IAAI;gBACH,MAAM,CAAC,cAAc,cAAc,gBAAgB,aAAa,GAC/D,MAAM,QAAQ,GAAG,CAAC;oBACjB,IAAA,uNAAoB,EAAC;oBACrB,IAAA,iNAAc,EAAC,gBAAgB;oBAC/B,IAAA,mNAAgB,EAAC,gBAAgB;oBACjC,IAAA,oNAAiB,EAAC;iBAClB;gBAEF,YAAY;gBACZ,eAAe;gBACf,iBAAiB;gBACjB,kBAAkB;YACnB,EAAE,OAAO,OAAO;gBACf,QAAQ,KAAK,CAAC,8BAA8B;gBAC5C,oJAAK,CAAC,KAAK,CAAC;YACb,SAAU;gBACT,aAAa;YACd;QACD;oDAAG,EAAE;IAEL,0KAAe;mCAAC;YACf,eAAe;QAChB;kCAAG;QAAC;QAAQ;KAAe;IAE3B,MAAM,qBAAqB,CAAC;QAC3B,UAAU;IACX;IAEA,IAAI,aAAa,CAAC,UAAU;QAC3B,qBACC,6LAAC;YAAI,WAAU;sBACd,cAAA,6LAAC,+NAAO;gBAAC,WAAU;;;;;;;;;;;IAGtB;IAEA,qBACC,6LAAC;QAAI,WAAU;;0BAEd,6LAAC;gBAAI,WAAU;;kCACd,6LAAC;;0CACA,6LAAC;gCAAG,WAAU;0CAAoC;;;;;;0CAClD,6LAAC;gCAAE,WAAU;0CAA6B;;;;;;;;;;;;kCAI3C,6LAAC,mKAAM;wBAAC,OAAO;wBAAQ,eAAe;;0CACrC,6LAAC,0KAAa;gCAAC,WAAU;0CACxB,cAAA,6LAAC,wKAAW;oCAAC,aAAY;;;;;;;;;;;0CAE1B,6LAAC,0KAAa;;kDACb,6LAAC,uKAAU;wCAAC,OAAM;kDAAQ;;;;;;kDAC1B,6LAAC,uKAAU;wCAAC,OAAM;kDAAS;;;;;;kDAC3B,6LAAC,uKAAU;wCAAC,OAAM;kDAAS;;;;;;kDAC3B,6LAAC,uKAAU;wCAAC,OAAM;kDAAO;;;;;;;;;;;;;;;;;;;;;;;;0BAM5B,6LAAC;gBAAI,WAAU;;kCACd,6LAAC,+JAAI;wBAAC,WAAU;;0CACf,6LAAC;gCAAI,WAAU;;kDACd,6LAAC;wCAAG,WAAU;kDAA4C;;;;;;kDAG1D,6LAAC,mOAAU;wCAAC,WAAU;;;;;;;;;;;;0CAEvB,6LAAC;gCAAI,WAAU;;kDACd,6LAAC;wCAAE,WAAU;kDACX,WAAW,eAAe,SAAS,OAAO,CAAC,KAAK,IAAI;;;;;;kDAEtD,6LAAC;wCAAE,WAAU;;4CACX,YAAY,SAAS,OAAO,CAAC,MAAM,IAAI,kBACvC,6LAAC,mOAAU;gDAAC,WAAU;;;;;qEAEtB,6LAAC,yOAAY;gDAAC,WAAU;;;;;;0DAEzB,6LAAC;gDACA,WACC,YAAY,SAAS,OAAO,CAAC,MAAM,IAAI,IACpC,mBACA;0DAGH,WACE,GAAG,SAAS,OAAO,CAAC,MAAM,IAAI,IAAI,MAAM,KAAK,SAAS,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,GAClF;;;;;;4CACI;4CAAI;;;;;;;;;;;;;;;;;;;kCAMf,6LAAC,+JAAI;wBAAC,WAAU;;0CACf,6LAAC;gCAAI,WAAU;;kDACd,6LAAC;wCAAG,WAAU;kDAA4C;;;;;;kDAG1D,6LAAC,yOAAY;wCAAC,WAAU;;;;;;;;;;;;0CAEzB,6LAAC;gCAAI,WAAU;;kDACd,6LAAC;wCAAE,WAAU;kDACX,WAAW,aAAa,SAAS,MAAM,CAAC,KAAK,IAAI;;;;;;kDAEnD,6LAAC;wCAAE,WAAU;;4CACX,YAAY,SAAS,MAAM,CAAC,MAAM,IAAI,kBACtC,6LAAC,mOAAU;gDAAC,WAAU;;;;;qEAEtB,6LAAC,yOAAY;gDAAC,WAAU;;;;;;0DAEzB,6LAAC;gDACA,WACC,YAAY,SAAS,MAAM,CAAC,MAAM,IAAI,IACnC,mBACA;0DAGH,WACE,GAAG,SAAS,MAAM,CAAC,MAAM,IAAI,IAAI,MAAM,KAAK,SAAS,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,GAChF;;;;;;4CACI;4CAAI;;;;;;;;;;;;;;;;;;;kCAMf,6LAAC,+JAAI;wBAAC,WAAU;;0CACf,6LAAC;gCAAI,WAAU;;kDACd,6LAAC;wCAAG,WAAU;kDAA4C;;;;;;kDAG1D,6LAAC,sOAAW;wCAAC,WAAU;;;;;;;;;;;;0CAExB,6LAAC;gCAAI,WAAU;;kDACd,6LAAC;wCAAE,WAAU;kDACX,WAAW,aAAa,SAAS,SAAS,CAAC,KAAK,IAAI;;;;;;kDAEtD,6LAAC;wCAAE,WAAU;;4CACX,YAAY,SAAS,SAAS,CAAC,MAAM,IAAI,kBACzC,6LAAC,mOAAU;gDAAC,WAAU;;;;;qEAEtB,6LAAC,yOAAY;gDAAC,WAAU;;;;;;0DAEzB,6LAAC;gDACA,WACC,YAAY,SAAS,SAAS,CAAC,MAAM,IAAI,IACtC,mBACA;0DAGH,WACE,GAAG,SAAS,SAAS,CAAC,MAAM,IAAI,IAAI,MAAM,KAAK,SAAS,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,GACtF;;;;;;4CACI;4CAAI;;;;;;;;;;;;;;;;;;;kCAMf,6LAAC,+JAAI;wBAAC,WAAU;;0CACf,6LAAC;gCAAI,WAAU;;kDACd,6LAAC;wCAAG,WAAU;kDAA4C;;;;;;kDAG1D,6LAAC,mOAAU;wCAAC,WAAU;;;;;;;;;;;;0CAEvB,6LAAC;gCAAI,WAAU;;kDACd,6LAAC;wCAAE,WAAU;kDACX,WACE,eAAe,SAAS,iBAAiB,CAAC,KAAK,IAC/C;;;;;;kDAEJ,6LAAC;wCAAE,WAAU;;4CACX,YAAY,SAAS,iBAAiB,CAAC,MAAM,IAAI,kBACjD,6LAAC,mOAAU;gDAAC,WAAU;;;;;qEAEtB,6LAAC,yOAAY;gDAAC,WAAU;;;;;;0DAEzB,6LAAC;gDACA,WACC,YAAY,SAAS,iBAAiB,CAAC,MAAM,IAAI,IAC9C,mBACA;0DAGH,WACE,GAAG,SAAS,iBAAiB,CAAC,MAAM,IAAI,IAAI,MAAM,KAAK,SAAS,iBAAiB,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,GACtG;;;;;;4CACI;4CAAI;;;;;;;;;;;;;;;;;;;;;;;;;0BAQhB,6LAAC;gBAAI,WAAU;;kCACd,6LAAC,+JAAI;wBAAC,WAAU;kCACf,cAAA,6LAAC;4BAAI,WAAU;;8CACd,6LAAC;oCAAI,WAAU;8CACd,cAAA,6LAAC,gNAAK;wCAAC,WAAU;;;;;;;;;;;8CAElB,6LAAC;;sDACA,6LAAC;4CAAE,WAAU;sDAAgC;;;;;;sDAC7C,6LAAC;4CAAE,WAAU;sDACX,WAAW,aAAa,SAAS,SAAS,CAAC,KAAK,IAAI;;;;;;;;;;;;;;;;;;;;;;;kCAKzD,6LAAC,+JAAI;wBAAC,WAAU;kCACf,cAAA,6LAAC;4BAAI,WAAU;;8CACd,6LAAC;oCAAI,WAAU;8CACd,cAAA,6LAAC,sNAAO;wCAAC,WAAU;;;;;;;;;;;8CAEpB,6LAAC;;sDACA,6LAAC;4CAAE,WAAU;sDAAgC;;;;;;sDAC7C,6LAAC;4CAAE,WAAU;sDACX,WAAW,aAAa,SAAS,YAAY,CAAC,KAAK,IAAI;;;;;;;;;;;;;;;;;;;;;;;kCAK5D,6LAAC,+JAAI;wBAAC,WAAU;kCACf,cAAA,6LAAC;4BAAI,WAAU;;8CACd,6LAAC;oCAAI,WAAU;8CACd,cAAA,6LAAC,0MAAG;wCAAC,WAAU;;;;;;;;;;;8CAEhB,6LAAC;;sDACA,6LAAC;4CAAE,WAAU;sDAAgC;;;;;;sDAC7C,6LAAC;4CAAE,WAAU;sDAAoB;;;;;;;;;;;;;;;;;;;;;;;kCAIpC,6LAAC,+JAAI;wBAAC,WAAU;kCACf,cAAA,6LAAC;4BAAI,WAAU;;8CACd,6LAAC;oCAAI,WAAU;8CACd,cAAA,6LAAC,yOAAY;wCAAC,WAAU;;;;;;;;;;;8CAEzB,6LAAC;;sDACA,6LAAC;4CAAE,WAAU;sDAAgC;;;;;;sDAC7C,6LAAC;4CAAE,WAAU;sDAAoB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAOrC,6LAAC;gBAAI,WAAU;;kCAEd,6LAAC,+JAAI;wBAAC,WAAU;;0CACf,6LAAC;gCAAI,WAAU;;kDACd,6LAAC;wCAAG,WAAU;kDAAoB;;;;;;kDAClC,6LAAC;wCAAE,WAAU;kDAAqC;;;;;;;;;;;;0CAInD,6LAAC;gCAAI,WAAU;0CACb,YAAY,MAAM,KAAK,kBACvB,6LAAC;oCAAE,WAAU;8CAAiD;;;;;2CAI9D,YAAY,GAAG,CAAC,CAAC,SAAS,sBACzB,6LAAC;wCAEA,WAAU;;0DAEV,6LAAC;gDAAI,WAAU;;kEACd,6LAAC;wDAAI,WAAU;kEACb,QAAQ;;;;;;kEAEV,6LAAC;;0EACA,6LAAC;gEAAE,WAAU;0EAAuB,QAAQ,IAAI;;;;;;0EAChD,6LAAC;gEAAE,WAAU;;oEACX,aAAa,QAAQ,KAAK;oEAAE;;;;;;;;;;;;;;;;;;;0DAIhC,6LAAC;gDAAI,WAAU;0DACd,cAAA,6LAAC;oDAAE,WAAU;8DACX,eAAe,QAAQ,OAAO;;;;;;;;;;;;uCAhB5B,QAAQ,EAAE;;;;;;;;;;;;;;;;kCA0BpB,6LAAC,+JAAI;wBAAC,WAAU;;0CACf,6LAAC;gCAAI,WAAU;;kDACd,6LAAC;wCAAG,WAAU;kDAAoB;;;;;;kDAClC,6LAAC;wCAAE,WAAU;kDAAqC;;;;;;;;;;;;0CAInD,6LAAC;gCAAI,WAAU;0CACb,cAAc,MAAM,KAAK,kBACzB,6LAAC;oCAAE,WAAU;8CAAiD;;;;;2CAI9D,cAAc,GAAG,CAAC,CAAC,yBAClB,6LAAC;wCAAsB,WAAU;;0DAChC,6LAAC;gDAAI,WAAU;;kEACd,6LAAC;wDAAK,WAAU;kEAAe,SAAS,IAAI;;;;;;kEAC5C,6LAAC;wDAAK,WAAU;;4DACd,SAAS,KAAK,CAAC,OAAO,CAAC;4DAAG;;;;;;;;;;;;;0DAG7B,6LAAC;gDAAI,WAAU;0DACd,cAAA,6LAAC;oDACA,WAAU;oDACV,OAAO;wDAAE,OAAO,GAAG,KAAK,GAAG,CAAC,SAAS,KAAK,EAAE,KAAK,CAAC,CAAC;oDAAC;;;;;;;;;;;0DAGtD,6LAAC;gDAAI,WAAU;;kEACd,6LAAC;kEAAM,eAAe,SAAS,OAAO;;;;;;kEACtC,6LAAC;;4DAAM,aAAa,SAAS,MAAM;4DAAE;;;;;;;;;;;;;;uCAf7B,SAAS,EAAE;;;;;;;;;;;;;;;;;;;;;;0BAyB1B,6LAAC,+JAAI;gBAAC,WAAU;;kCACf,6LAAC;wBAAI,WAAU;;0CACd,6LAAC;gCAAG,WAAU;0CAAoB;;;;;;0CAClC,6LAAC;gCAAE,WAAU;0CAAqC;;;;;;;;;;;;kCAInD,6LAAC;wBAAI,WAAU;kCACb,eAAe,MAAM,KAAK,kBAC1B,6LAAC;4BAAE,WAAU;sCAAiD;;;;;mCAI9D,eAAe,GAAG,CAAC,CAAC,yBACnB,6LAAC;gCAEA,WAAU;;kDAEV,6LAAC;wCAAI,WAAU;;;;;;kDACf,6LAAC;wCAAI,WAAU;;0DACd,6LAAC;gDAAE,WAAU;0DAAuB,SAAS,MAAM;;;;;;0DACnD,6LAAC;gDAAE,WAAU;0DACX,SAAS,OAAO;;;;;;;;;;;;kDAGnB,6LAAC;wCAAE,WAAU;kDAAiC,SAAS,IAAI;;;;;;;+BAVtD,SAAS,EAAE;;;;;;;;;;;;;;;;;;;;;;AAkBxB;GAvXwB;KAAA"}}]
}