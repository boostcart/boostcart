{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/bobkata/Projects/boostcart/apps/platform/src/components/admin/polaris-button.tsx"],"sourcesContent":["import { Slot as SlotPrimitive } from \"radix-ui\";\nimport type React from \"react\";\nimport { cn } from \"@/lib/utils\";\n\ninterface PolarisButtonProps\n\textends React.ButtonHTMLAttributes<HTMLButtonElement> {\n\tchildren: React.ReactNode;\n\tsize?: \"micro\" | \"slim\" | \"medium\" | \"large\";\n\tfullWidth?: boolean;\n\tloading?: boolean;\n\tdisabled?: boolean;\n\ticon?: React.ReactNode;\n\tasChild?: boolean;\n}\n\nexport function PolarisButton({\n\tchildren,\n\tsize = \"slim\",\n\tfullWidth = false,\n\tloading = false,\n\tdisabled = false,\n\ticon,\n\tasChild = false,\n\tclassName,\n\t...props\n}: PolarisButtonProps) {\n\tconst Comp = asChild ? SlotPrimitive.Slot : \"button\";\n\tconst sizeClasses = {\n\t\tmicro: \"h-7 px-2.5 text-xs\",\n\t\tslim: \"h-9 px-3 text-sm\",\n\t\tmedium: \"h-10 px-4 text-sm\",\n\t\tlarge: \"h-12 px-5 text-base\",\n\t};\n\n\treturn (\n\t\t<Comp\n\t\t\tdisabled={disabled || loading}\n\t\t\tclassName={cn(\n\t\t\t\t// Base styles matching Polaris primary button\n\t\t\t\t\"relative inline-flex items-center justify-center gap-2\",\n\t\t\t\t\"font-semibold rounded-[10px] cursor-pointer\",\n\t\t\t\t\"transition-all duration-200 ease-out\",\n\t\t\t\t\"outline-none focus-visible:outline-2 focus-visible:outline-offset-2\",\n\n\t\t\t\t\"border-0\",\n\t\t\t\t\"shadow-[inset_0_1.5px_0_0_rgba(0,0,0,0.6),inset_1.5px_0_0_0_rgba(0,0,0,0.8),inset_-1.5px_0_0_0_rgba(0,0,0,0.8),inset_0_-3px_0_0_rgba(0,0,0,0.8)]\",\n\n\t\t\t\t\"bg-linear-to-b from-[#4a4a4a] to-[#303030]\",\n\n\t\t\t\t// Text colors from Polaris tokens\n\t\t\t\t\"text-white\",\n\n\t\t\t\t\"hover:before:absolute hover:before:inset-0 hover:before:rounded-[10px] hover:before:bg-black hover:before:opacity-30 hover:before:transition-opacity hover:before:duration-200 hover:before:content-['']\",\n\n\t\t\t\t// Disabled state\n\t\t\t\t\"disabled:bg-linear-to-b disabled:from-[rgba(0,0,0,0.2)] disabled:to-[rgba(0,0,0,0.17)]\",\n\t\t\t\t\"disabled:text-[rgba(255,255,255,0.6)]\",\n\t\t\t\t\"disabled:cursor-not-allowed\",\n\t\t\t\t\"disabled:shadow-[inset_0_1.5px_0_0_rgba(0,0,0,0.2),inset_1.5px_0_0_0_rgba(0,0,0,0.2),inset_-1.5px_0_0_0_rgba(0,0,0,0.2),inset_0_-3px_0_0_rgba(0,0,0,0.2)]\",\n\t\t\t\t\"disabled:hover:before:opacity-0\",\n\n\t\t\t\t// Focus state border\n\t\t\t\t\"focus-visible:outline-[#005BD3]\",\n\n\t\t\t\t\"active:shadow-[inset_0_4px_0_0_rgba(0,0,0,0.8),inset_1.5px_0_0_0_rgba(0,0,0,0.8),inset_-1.5px_0_0_0_rgba(0,0,0,0.8),inset_0_-3px_0_0_rgba(0,0,0,0.8)]\",\n\t\t\t\t\"active:bg-linear-to-b active:from-[#2a2a2a] active:to-[#1a1a1a]\",\n\t\t\t\t\"active:[&>span:last-child]:translate-y-px\",\n\n\t\t\t\t// Size variants\n\t\t\t\tsizeClasses[size],\n\n\t\t\t\t// Full width\n\t\t\t\tfullWidth && \"w-full\",\n\n\t\t\t\tasChild && disabled && \"pointer-events-none opacity-50\",\n\n\t\t\t\tclassName,\n\t\t\t)}\n\t\t\t{...props}\n\t\t>\n\t\t\t<span className=\"absolute inset-0 rounded-[10px] pointer-events-none shadow-[inset_0_3px_0_0_rgba(255,255,255,0.2),inset_1.5px_0_0_0_rgba(255,255,255,0.1),inset_-1.5px_0_0_0_rgba(255,255,255,0.1)] active:opacity-0 transition-opacity duration-200\" />\n\n\t\t\t<span className=\"relative flex items-center justify-center gap-2 transition-transform duration-200\">\n\t\t\t\t{loading ? (\n\t\t\t\t\t<svg\n\t\t\t\t\t\tclassName=\"animate-spin size-4\"\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<title>Loading</title>\n\t\t\t\t\t\t<circle\n\t\t\t\t\t\t\tclassName=\"opacity-25\"\n\t\t\t\t\t\t\tcx=\"12\"\n\t\t\t\t\t\t\tcy=\"12\"\n\t\t\t\t\t\t\tr=\"10\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstrokeWidth=\"4\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\tclassName=\"opacity-75\"\n\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\td=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\t\t\t\t) : (\n\t\t\t\t\ticon && <span className=\"shrink-0\">{icon}</span>\n\t\t\t\t)}\n\t\t\t\t{children}\n\t\t\t</span>\n\t\t</Comp>\n\t);\n}\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAaO,SAAS,cAAc,EAC7B,QAAQ,EACR,OAAO,MAAM,EACb,YAAY,KAAK,EACjB,UAAU,KAAK,EACf,WAAW,KAAK,EAChB,IAAI,EACJ,UAAU,KAAK,EACf,SAAS,EACT,GAAG,OACiB;IACpB,MAAM,OAAO,UAAU,0OAAa,CAAC,IAAI,GAAG;IAC5C,MAAM,cAAc;QACnB,OAAO;QACP,MAAM;QACN,QAAQ;QACR,OAAO;IACR;IAEA,qBACC,6LAAC;QACA,UAAU,YAAY;QACtB,WAAW,IAAA,gJAAE,EACZ,8CAA8C;QAC9C,0DACA,+CACA,wCACA,uEAEA,YACA,oJAEA,8CAEA,kCAAkC;QAClC,cAEA,4MAEA,iBAAiB;QACjB,0FACA,yCACA,+BACA,6JACA,mCAEA,qBAAqB;QACrB,mCAEA,yJACA,mEACA,6CAEA,gBAAgB;QAChB,WAAW,CAAC,KAAK,EAEjB,aAAa;QACb,aAAa,UAEb,WAAW,YAAY,kCAEvB;QAEA,GAAG,KAAK;;0BAET,6LAAC;gBAAK,WAAU;;;;;;0BAEhB,6LAAC;gBAAK,WAAU;;oBACd,wBACA,6LAAC;wBACA,WAAU;wBACV,OAAM;wBACN,MAAK;wBACL,SAAQ;;0CAER,6LAAC;0CAAM;;;;;;0CACP,6LAAC;gCACA,WAAU;gCACV,IAAG;gCACH,IAAG;gCACH,GAAE;gCACF,QAAO;gCACP,aAAY;;;;;;0CAEb,6LAAC;gCACA,WAAU;gCACV,MAAK;gCACL,GAAE;;;;;;;;;;;+BAIJ,sBAAQ,6LAAC;wBAAK,WAAU;kCAAY;;;;;;oBAEpC;;;;;;;;;;;;;AAIL;KAjGgB"}},
    {"offset": {"line": 114, "column": 0}, "map": {"version":3,"sources":["file:///Users/bobkata/Projects/boostcart/apps/platform/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\";\n\nimport { cn } from \"@/lib/utils\";\n\nconst Card = React.forwardRef<\n\tHTMLDivElement,\n\tReact.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n\t<div\n\t\tref={ref}\n\t\tclassName={cn(\n\t\t\t\"rounded-lg border bg-card text-card-foreground shadow-sm\",\n\t\t\tclassName,\n\t\t)}\n\t\t{...props}\n\t/>\n));\nCard.displayName = \"Card\";\n\nconst CardHeader = React.forwardRef<\n\tHTMLDivElement,\n\tReact.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n\t<div\n\t\tref={ref}\n\t\tclassName={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n\t\t{...props}\n\t/>\n));\nCardHeader.displayName = \"CardHeader\";\n\nconst CardTitle = React.forwardRef<\n\tHTMLDivElement,\n\tReact.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n\t<div\n\t\tref={ref}\n\t\tclassName={cn(\n\t\t\t\"text-2xl font-semibold leading-none tracking-tight\",\n\t\t\tclassName,\n\t\t)}\n\t\t{...props}\n\t/>\n));\nCardTitle.displayName = \"CardTitle\";\n\nconst CardDescription = React.forwardRef<\n\tHTMLDivElement,\n\tReact.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n\t<div\n\t\tref={ref}\n\t\tclassName={cn(\"text-sm text-muted-foreground\", className)}\n\t\t{...props}\n\t/>\n));\nCardDescription.displayName = \"CardDescription\";\n\nconst CardContent = React.forwardRef<\n\tHTMLDivElement,\n\tReact.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n\t<div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n));\nCardContent.displayName = \"CardContent\";\n\nconst CardFooter = React.forwardRef<\n\tHTMLDivElement,\n\tReact.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n\t<div\n\t\tref={ref}\n\t\tclassName={cn(\"flex items-center p-6 pt-0\", className)}\n\t\t{...props}\n\t/>\n));\nCardFooter.displayName = \"CardFooter\";\n\nexport {\n\tCard,\n\tCardHeader,\n\tCardFooter,\n\tCardTitle,\n\tCardDescription,\n\tCardContent,\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,qBAAO,2KAAgB,MAG3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC3B,6LAAC;QACA,KAAK;QACL,WAAW,IAAA,gJAAE,EACZ,4DACA;QAEA,GAAG,KAAK;;;;;;;AAGX,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,2KAAgB,OAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC3B,6LAAC;QACA,KAAK;QACL,WAAW,IAAA,gJAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGX,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,2KAAgB,OAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC3B,6LAAC;QACA,KAAK;QACL,WAAW,IAAA,gJAAE,EACZ,sDACA;QAEA,GAAG,KAAK;;;;;;;AAGX,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,2KAAgB,OAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC3B,6LAAC;QACA,KAAK;QACL,WAAW,IAAA,gJAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGX,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC3B,6LAAC;QAAI,KAAK;QAAK,WAAW,IAAA,gJAAE,EAAC,YAAY;QAAa,GAAG,KAAK;;;;;;;AAE/D,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,2KAAgB,QAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC3B,6LAAC;QACA,KAAK;QACL,WAAW,IAAA,gJAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;;AAGX,WAAW,WAAW,GAAG"}},
    {"offset": {"line": 221, "column": 0}, "map": {"version":3,"sources":["file:///Users/bobkata/Projects/boostcart/apps/platform/src/components/ui/table.tsx"],"sourcesContent":["import * as React from \"react\";\n\nimport { cn } from \"@/lib/utils\";\n\nconst Table = React.forwardRef<\n\tHTMLTableElement,\n\tReact.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n\t<div className=\"relative w-full overflow-auto\">\n\t\t<table\n\t\t\tref={ref}\n\t\t\tclassName={cn(\"w-full caption-bottom text-sm\", className)}\n\t\t\t{...props}\n\t\t/>\n\t</div>\n));\nTable.displayName = \"Table\";\n\nconst TableHeader = React.forwardRef<\n\tHTMLTableSectionElement,\n\tReact.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n\t<thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n));\nTableHeader.displayName = \"TableHeader\";\n\nconst TableBody = React.forwardRef<\n\tHTMLTableSectionElement,\n\tReact.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n\t<tbody\n\t\tref={ref}\n\t\tclassName={cn(\"[&_tr:last-child]:border-0\", className)}\n\t\t{...props}\n\t/>\n));\nTableBody.displayName = \"TableBody\";\n\nconst TableFooter = React.forwardRef<\n\tHTMLTableSectionElement,\n\tReact.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n\t<tfoot\n\t\tref={ref}\n\t\tclassName={cn(\n\t\t\t\"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n\t\t\tclassName,\n\t\t)}\n\t\t{...props}\n\t/>\n));\nTableFooter.displayName = \"TableFooter\";\n\nconst TableRow = React.forwardRef<\n\tHTMLTableRowElement,\n\tReact.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n\t<tr\n\t\tref={ref}\n\t\tclassName={cn(\n\t\t\t\"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n\t\t\tclassName,\n\t\t)}\n\t\t{...props}\n\t/>\n));\nTableRow.displayName = \"TableRow\";\n\nconst TableHead = React.forwardRef<\n\tHTMLTableCellElement,\n\tReact.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n\t<th\n\t\tref={ref}\n\t\tclassName={cn(\n\t\t\t\"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n\t\t\tclassName,\n\t\t)}\n\t\t{...props}\n\t/>\n));\nTableHead.displayName = \"TableHead\";\n\nconst TableCell = React.forwardRef<\n\tHTMLTableCellElement,\n\tReact.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n\t<td\n\t\tref={ref}\n\t\tclassName={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n\t\t{...props}\n\t/>\n));\nTableCell.displayName = \"TableCell\";\n\nconst TableCaption = React.forwardRef<\n\tHTMLTableCaptionElement,\n\tReact.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n\t<caption\n\t\tref={ref}\n\t\tclassName={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n\t\t{...props}\n\t/>\n));\nTableCaption.displayName = \"TableCaption\";\n\nexport {\n\tTable,\n\tTableHeader,\n\tTableBody,\n\tTableFooter,\n\tTableHead,\n\tTableRow,\n\tTableCell,\n\tTableCaption,\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,sBAAQ,2KAAgB,MAG5B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC3B,6LAAC;QAAI,WAAU;kBACd,cAAA,6LAAC;YACA,KAAK;YACL,WAAW,IAAA,gJAAE,EAAC,iCAAiC;YAC9C,GAAG,KAAK;;;;;;;;;;;;AAIZ,MAAM,WAAW,GAAG;AAEpB,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC3B,6LAAC;QAAM,KAAK;QAAK,WAAW,IAAA,gJAAE,EAAC,mBAAmB;QAAa,GAAG,KAAK;;;;;;;AAExE,YAAY,WAAW,GAAG;AAE1B,MAAM,0BAAY,2KAAgB,OAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC3B,6LAAC;QACA,KAAK;QACL,WAAW,IAAA,gJAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;;AAGX,UAAU,WAAW,GAAG;AAExB,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC3B,6LAAC;QACA,KAAK;QACL,WAAW,IAAA,gJAAE,EACZ,2DACA;QAEA,GAAG,KAAK;;;;;;;AAGX,YAAY,WAAW,GAAG;AAE1B,MAAM,yBAAW,2KAAgB,OAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC3B,6LAAC;QACA,KAAK;QACL,WAAW,IAAA,gJAAE,EACZ,+EACA;QAEA,GAAG,KAAK;;;;;;;AAGX,SAAS,WAAW,GAAG;AAEvB,MAAM,0BAAY,2KAAgB,QAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC3B,6LAAC;QACA,KAAK;QACL,WAAW,IAAA,gJAAE,EACZ,oGACA;QAEA,GAAG,KAAK;;;;;;;AAGX,UAAU,WAAW,GAAG;AAExB,MAAM,0BAAY,2KAAgB,QAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC3B,6LAAC;QACA,KAAK;QACL,WAAW,IAAA,gJAAE,EAAC,kDAAkD;QAC/D,GAAG,KAAK;;;;;;;AAGX,UAAU,WAAW,GAAG;AAExB,MAAM,6BAAe,2KAAgB,QAGnC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC3B,6LAAC;QACA,KAAK;QACL,WAAW,IAAA,gJAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;;AAGX,aAAa,WAAW,GAAG"}},
    {"offset": {"line": 365, "column": 0}, "map": {"version":3,"sources":["file:///Users/bobkata/Projects/boostcart/apps/platform/src/server/api/internal/abandoned-carts.ts"],"sourcesContent":["\"use server\";\n\nimport { auth } from \"@/server/auth\";\nimport { db } from \"@/server/db\";\nimport { requireAdminTenant } from \"@/server/tenant\";\n\nasync function requireStoreAccess() {\n\tconst session = await auth();\n\tif (!session?.user?.id) {\n\t\tthrow new Error(\"Unauthorized\");\n\t}\n\n\tconst tenant = await requireAdminTenant();\n\n\tconst staffRecord = await db.tenantStaff.findFirst({\n\t\twhere: {\n\t\t\tuserId: session.user.id,\n\t\t\ttenantId: tenant.id,\n\t\t},\n\t});\n\n\tif (!staffRecord) {\n\t\tthrow new Error(\"Forbidden: No access to this store\");\n\t}\n\n\treturn {\n\t\tuserId: session.user.id,\n\t\ttenantId: tenant.id,\n\t\trole: staffRecord.role,\n\t};\n}\n\nexport async function getAbandonedCarts() {\n\tconst { tenantId } = await requireStoreAccess();\n\n\t// A cart is considered abandoned if:\n\t// 1. It has items\n\t// 2. It was last updated more than 1 hour ago\n\t// 3. It hasn't been converted to an order\n\tconst oneHourAgo = new Date(Date.now() - 60 * 60 * 1000);\n\n\tconst carts = await db.cart.findMany({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tupdatedAt: {\n\t\t\t\tlt: oneHourAgo,\n\t\t\t},\n\t\t\titems: {\n\t\t\t\tsome: {},\n\t\t\t},\n\t\t},\n\t\tinclude: {\n\t\t\tcustomer: true,\n\t\t\titems: {\n\t\t\t\tinclude: {\n\t\t\t\t\tproduct: {\n\t\t\t\t\t\tinclude: {\n\t\t\t\t\t\t\ttranslations: {\n\t\t\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tselectedVariant: true,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\torderBy: { updatedAt: \"desc\" },\n\t});\n\n\treturn carts.map((cart) => ({\n\t\tid: cart.id,\n\t\tcustomer: cart.customer\n\t\t\t? {\n\t\t\t\t\tid: cart.customer.id,\n\t\t\t\t\temail: cart.customer.email,\n\t\t\t\t\tname: `${cart.customer.firstName ?? \"\"} ${cart.customer.lastName ?? \"\"}`.trim() || \"Unknown\",\n\t\t\t\t}\n\t\t\t: null,\n\t\tsessionId: cart.sessionId,\n\t\titemCount: cart.items.reduce((sum, item) => sum + item.quantity, 0),\n\t\ttotalValue: cart.items.reduce((sum, item) => {\n\t\t\tconst price = item.selectedVariant?.price ?? item.product.price;\n\t\t\treturn sum + Number(price) * item.quantity;\n\t\t}, 0),\n\t\titems: cart.items.map((item) => ({\n\t\t\tid: item.id,\n\t\t\tproductId: item.productId,\n\t\t\tproductName: item.product.translations[0]?.name ?? item.product.slug,\n\t\t\tvariantSku: item.selectedVariant?.sku,\n\t\t\tquantity: item.quantity,\n\t\t\tprice: Number(item.selectedVariant?.price ?? item.product.price),\n\t\t})),\n\t\tabandonedAt: cart.updatedAt,\n\t\tcreatedAt: cart.createdAt,\n\t}));\n}\n\nexport async function getAbandonedCart(id: string) {\n\tconst { tenantId } = await requireStoreAccess();\n\n\tconst cart = await db.cart.findFirst({\n\t\twhere: { id, tenantId },\n\t\tinclude: {\n\t\t\tcustomer: true,\n\t\t\titems: {\n\t\t\t\tinclude: {\n\t\t\t\t\tproduct: {\n\t\t\t\t\t\tinclude: {\n\t\t\t\t\t\t\ttranslations: {\n\t\t\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tmedia: {\n\t\t\t\t\t\t\t\torderBy: { order: \"asc\" },\n\t\t\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tselectedVariant: true,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\tif (!cart) {\n\t\tthrow new Error(\"Cart not found\");\n\t}\n\n\treturn {\n\t\tid: cart.id,\n\t\tcustomer: cart.customer\n\t\t\t? {\n\t\t\t\t\tid: cart.customer.id,\n\t\t\t\t\temail: cart.customer.email,\n\t\t\t\t\tname: `${cart.customer.firstName ?? \"\"} ${cart.customer.lastName ?? \"\"}`.trim() || \"Unknown\",\n\t\t\t\t\tphone: cart.customer.phone,\n\t\t\t\t}\n\t\t\t: null,\n\t\tsessionId: cart.sessionId,\n\t\titems: cart.items.map((item) => ({\n\t\t\tid: item.id,\n\t\t\tproductId: item.productId,\n\t\t\tproductName: item.product.translations[0]?.name ?? item.product.slug,\n\t\t\tproductImage: item.product.media[0]?.url,\n\t\t\tvariantSku: item.selectedVariant?.sku,\n\t\t\tvariantOptions: item.selectedVariant\n\t\t\t\t? Object.entries(item.selectedVariant.options as Record<string, string>)\n\t\t\t\t\t\t.map(([key, value]) => `${key}: ${value}`)\n\t\t\t\t\t\t.join(\", \")\n\t\t\t\t: null,\n\t\t\tquantity: item.quantity,\n\t\t\tprice: Number(item.selectedVariant?.price ?? item.product.price),\n\t\t})),\n\t\ttotalValue: cart.items.reduce((sum, item) => {\n\t\t\tconst price = item.selectedVariant?.price ?? item.product.price;\n\t\t\treturn sum + Number(price) * item.quantity;\n\t\t}, 0),\n\t\tabandonedAt: cart.updatedAt,\n\t\tcreatedAt: cart.createdAt,\n\t};\n}\n\nexport async function deleteAbandonedCart(id: string) {\n\tconst { tenantId } = await requireStoreAccess();\n\n\t// Verify cart belongs to tenant\n\tconst cart = await db.cart.findFirst({\n\t\twhere: { id, tenantId },\n\t});\n\n\tif (!cart) {\n\t\tthrow new Error(\"Cart not found or access denied\");\n\t}\n\n\tawait db.cart.delete({\n\t\twhere: { id },\n\t});\n\n\treturn { success: true };\n}\n\nexport async function getAbandonedCartStats() {\n\tconst { tenantId } = await requireStoreAccess();\n\n\tconst oneHourAgo = new Date(Date.now() - 60 * 60 * 1000);\n\tconst oneDayAgo = new Date(Date.now() - 24 * 60 * 60 * 1000);\n\tconst oneWeekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);\n\n\t// Get all abandoned carts\n\tconst abandonedCarts = await db.cart.findMany({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tupdatedAt: {\n\t\t\t\tlt: oneHourAgo,\n\t\t\t},\n\t\t\titems: {\n\t\t\t\tsome: {},\n\t\t\t},\n\t\t},\n\t\tinclude: {\n\t\t\titems: {\n\t\t\t\tinclude: {\n\t\t\t\t\tproduct: true,\n\t\t\t\t\tselectedVariant: true,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\t// Calculate stats\n\tconst totalCarts = abandonedCarts.length;\n\tconst totalValue = abandonedCarts.reduce((sum, cart) => {\n\t\treturn (\n\t\t\tsum +\n\t\t\tcart.items.reduce((itemSum, item) => {\n\t\t\t\tconst price = item.selectedVariant?.price ?? item.product.price;\n\t\t\t\treturn itemSum + Number(price) * item.quantity;\n\t\t\t}, 0)\n\t\t);\n\t}, 0);\n\n\tconst last24Hours = abandonedCarts.filter(\n\t\t(cart) => cart.updatedAt >= oneDayAgo,\n\t).length;\n\tconst lastWeek = abandonedCarts.filter(\n\t\t(cart) => cart.updatedAt >= oneWeekAgo,\n\t).length;\n\n\treturn {\n\t\ttotalCarts,\n\t\ttotalValue,\n\t\tlast24Hours,\n\t\tlastWeek,\n\t\taverageValue: totalCarts > 0 ? totalValue / totalCarts : 0,\n\t};\n}\n"],"names":[],"mappings":";;;;;;;MAiKsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,uDAAA"}},
    {"offset": {"line": 382, "column": 0}, "map": {"version":3,"sources":["file:///Users/bobkata/Projects/boostcart/apps/platform/src/server/api/internal/abandoned-carts.ts"],"sourcesContent":["\"use server\";\n\nimport { auth } from \"@/server/auth\";\nimport { db } from \"@/server/db\";\nimport { requireAdminTenant } from \"@/server/tenant\";\n\nasync function requireStoreAccess() {\n\tconst session = await auth();\n\tif (!session?.user?.id) {\n\t\tthrow new Error(\"Unauthorized\");\n\t}\n\n\tconst tenant = await requireAdminTenant();\n\n\tconst staffRecord = await db.tenantStaff.findFirst({\n\t\twhere: {\n\t\t\tuserId: session.user.id,\n\t\t\ttenantId: tenant.id,\n\t\t},\n\t});\n\n\tif (!staffRecord) {\n\t\tthrow new Error(\"Forbidden: No access to this store\");\n\t}\n\n\treturn {\n\t\tuserId: session.user.id,\n\t\ttenantId: tenant.id,\n\t\trole: staffRecord.role,\n\t};\n}\n\nexport async function getAbandonedCarts() {\n\tconst { tenantId } = await requireStoreAccess();\n\n\t// A cart is considered abandoned if:\n\t// 1. It has items\n\t// 2. It was last updated more than 1 hour ago\n\t// 3. It hasn't been converted to an order\n\tconst oneHourAgo = new Date(Date.now() - 60 * 60 * 1000);\n\n\tconst carts = await db.cart.findMany({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tupdatedAt: {\n\t\t\t\tlt: oneHourAgo,\n\t\t\t},\n\t\t\titems: {\n\t\t\t\tsome: {},\n\t\t\t},\n\t\t},\n\t\tinclude: {\n\t\t\tcustomer: true,\n\t\t\titems: {\n\t\t\t\tinclude: {\n\t\t\t\t\tproduct: {\n\t\t\t\t\t\tinclude: {\n\t\t\t\t\t\t\ttranslations: {\n\t\t\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tselectedVariant: true,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\torderBy: { updatedAt: \"desc\" },\n\t});\n\n\treturn carts.map((cart) => ({\n\t\tid: cart.id,\n\t\tcustomer: cart.customer\n\t\t\t? {\n\t\t\t\t\tid: cart.customer.id,\n\t\t\t\t\temail: cart.customer.email,\n\t\t\t\t\tname: `${cart.customer.firstName ?? \"\"} ${cart.customer.lastName ?? \"\"}`.trim() || \"Unknown\",\n\t\t\t\t}\n\t\t\t: null,\n\t\tsessionId: cart.sessionId,\n\t\titemCount: cart.items.reduce((sum, item) => sum + item.quantity, 0),\n\t\ttotalValue: cart.items.reduce((sum, item) => {\n\t\t\tconst price = item.selectedVariant?.price ?? item.product.price;\n\t\t\treturn sum + Number(price) * item.quantity;\n\t\t}, 0),\n\t\titems: cart.items.map((item) => ({\n\t\t\tid: item.id,\n\t\t\tproductId: item.productId,\n\t\t\tproductName: item.product.translations[0]?.name ?? item.product.slug,\n\t\t\tvariantSku: item.selectedVariant?.sku,\n\t\t\tquantity: item.quantity,\n\t\t\tprice: Number(item.selectedVariant?.price ?? item.product.price),\n\t\t})),\n\t\tabandonedAt: cart.updatedAt,\n\t\tcreatedAt: cart.createdAt,\n\t}));\n}\n\nexport async function getAbandonedCart(id: string) {\n\tconst { tenantId } = await requireStoreAccess();\n\n\tconst cart = await db.cart.findFirst({\n\t\twhere: { id, tenantId },\n\t\tinclude: {\n\t\t\tcustomer: true,\n\t\t\titems: {\n\t\t\t\tinclude: {\n\t\t\t\t\tproduct: {\n\t\t\t\t\t\tinclude: {\n\t\t\t\t\t\t\ttranslations: {\n\t\t\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tmedia: {\n\t\t\t\t\t\t\t\torderBy: { order: \"asc\" },\n\t\t\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tselectedVariant: true,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\tif (!cart) {\n\t\tthrow new Error(\"Cart not found\");\n\t}\n\n\treturn {\n\t\tid: cart.id,\n\t\tcustomer: cart.customer\n\t\t\t? {\n\t\t\t\t\tid: cart.customer.id,\n\t\t\t\t\temail: cart.customer.email,\n\t\t\t\t\tname: `${cart.customer.firstName ?? \"\"} ${cart.customer.lastName ?? \"\"}`.trim() || \"Unknown\",\n\t\t\t\t\tphone: cart.customer.phone,\n\t\t\t\t}\n\t\t\t: null,\n\t\tsessionId: cart.sessionId,\n\t\titems: cart.items.map((item) => ({\n\t\t\tid: item.id,\n\t\t\tproductId: item.productId,\n\t\t\tproductName: item.product.translations[0]?.name ?? item.product.slug,\n\t\t\tproductImage: item.product.media[0]?.url,\n\t\t\tvariantSku: item.selectedVariant?.sku,\n\t\t\tvariantOptions: item.selectedVariant\n\t\t\t\t? Object.entries(item.selectedVariant.options as Record<string, string>)\n\t\t\t\t\t\t.map(([key, value]) => `${key}: ${value}`)\n\t\t\t\t\t\t.join(\", \")\n\t\t\t\t: null,\n\t\t\tquantity: item.quantity,\n\t\t\tprice: Number(item.selectedVariant?.price ?? item.product.price),\n\t\t})),\n\t\ttotalValue: cart.items.reduce((sum, item) => {\n\t\t\tconst price = item.selectedVariant?.price ?? item.product.price;\n\t\t\treturn sum + Number(price) * item.quantity;\n\t\t}, 0),\n\t\tabandonedAt: cart.updatedAt,\n\t\tcreatedAt: cart.createdAt,\n\t};\n}\n\nexport async function deleteAbandonedCart(id: string) {\n\tconst { tenantId } = await requireStoreAccess();\n\n\t// Verify cart belongs to tenant\n\tconst cart = await db.cart.findFirst({\n\t\twhere: { id, tenantId },\n\t});\n\n\tif (!cart) {\n\t\tthrow new Error(\"Cart not found or access denied\");\n\t}\n\n\tawait db.cart.delete({\n\t\twhere: { id },\n\t});\n\n\treturn { success: true };\n}\n\nexport async function getAbandonedCartStats() {\n\tconst { tenantId } = await requireStoreAccess();\n\n\tconst oneHourAgo = new Date(Date.now() - 60 * 60 * 1000);\n\tconst oneDayAgo = new Date(Date.now() - 24 * 60 * 60 * 1000);\n\tconst oneWeekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);\n\n\t// Get all abandoned carts\n\tconst abandonedCarts = await db.cart.findMany({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tupdatedAt: {\n\t\t\t\tlt: oneHourAgo,\n\t\t\t},\n\t\t\titems: {\n\t\t\t\tsome: {},\n\t\t\t},\n\t\t},\n\t\tinclude: {\n\t\t\titems: {\n\t\t\t\tinclude: {\n\t\t\t\t\tproduct: true,\n\t\t\t\t\tselectedVariant: true,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\t// Calculate stats\n\tconst totalCarts = abandonedCarts.length;\n\tconst totalValue = abandonedCarts.reduce((sum, cart) => {\n\t\treturn (\n\t\t\tsum +\n\t\t\tcart.items.reduce((itemSum, item) => {\n\t\t\t\tconst price = item.selectedVariant?.price ?? item.product.price;\n\t\t\t\treturn itemSum + Number(price) * item.quantity;\n\t\t\t}, 0)\n\t\t);\n\t}, 0);\n\n\tconst last24Hours = abandonedCarts.filter(\n\t\t(cart) => cart.updatedAt >= oneDayAgo,\n\t).length;\n\tconst lastWeek = abandonedCarts.filter(\n\t\t(cart) => cart.updatedAt >= oneWeekAgo,\n\t).length;\n\n\treturn {\n\t\ttotalCarts,\n\t\ttotalValue,\n\t\tlast24Hours,\n\t\tlastWeek,\n\t\taverageValue: totalCarts > 0 ? totalValue / totalCarts : 0,\n\t};\n}\n"],"names":[],"mappings":";;;;;;;MAgCsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,qDAAA"}},
    {"offset": {"line": 399, "column": 0}, "map": {"version":3,"sources":["file:///Users/bobkata/Projects/boostcart/apps/platform/src/server/api/internal/abandoned-carts.ts"],"sourcesContent":["\"use server\";\n\nimport { auth } from \"@/server/auth\";\nimport { db } from \"@/server/db\";\nimport { requireAdminTenant } from \"@/server/tenant\";\n\nasync function requireStoreAccess() {\n\tconst session = await auth();\n\tif (!session?.user?.id) {\n\t\tthrow new Error(\"Unauthorized\");\n\t}\n\n\tconst tenant = await requireAdminTenant();\n\n\tconst staffRecord = await db.tenantStaff.findFirst({\n\t\twhere: {\n\t\t\tuserId: session.user.id,\n\t\t\ttenantId: tenant.id,\n\t\t},\n\t});\n\n\tif (!staffRecord) {\n\t\tthrow new Error(\"Forbidden: No access to this store\");\n\t}\n\n\treturn {\n\t\tuserId: session.user.id,\n\t\ttenantId: tenant.id,\n\t\trole: staffRecord.role,\n\t};\n}\n\nexport async function getAbandonedCarts() {\n\tconst { tenantId } = await requireStoreAccess();\n\n\t// A cart is considered abandoned if:\n\t// 1. It has items\n\t// 2. It was last updated more than 1 hour ago\n\t// 3. It hasn't been converted to an order\n\tconst oneHourAgo = new Date(Date.now() - 60 * 60 * 1000);\n\n\tconst carts = await db.cart.findMany({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tupdatedAt: {\n\t\t\t\tlt: oneHourAgo,\n\t\t\t},\n\t\t\titems: {\n\t\t\t\tsome: {},\n\t\t\t},\n\t\t},\n\t\tinclude: {\n\t\t\tcustomer: true,\n\t\t\titems: {\n\t\t\t\tinclude: {\n\t\t\t\t\tproduct: {\n\t\t\t\t\t\tinclude: {\n\t\t\t\t\t\t\ttranslations: {\n\t\t\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tselectedVariant: true,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\torderBy: { updatedAt: \"desc\" },\n\t});\n\n\treturn carts.map((cart) => ({\n\t\tid: cart.id,\n\t\tcustomer: cart.customer\n\t\t\t? {\n\t\t\t\t\tid: cart.customer.id,\n\t\t\t\t\temail: cart.customer.email,\n\t\t\t\t\tname: `${cart.customer.firstName ?? \"\"} ${cart.customer.lastName ?? \"\"}`.trim() || \"Unknown\",\n\t\t\t\t}\n\t\t\t: null,\n\t\tsessionId: cart.sessionId,\n\t\titemCount: cart.items.reduce((sum, item) => sum + item.quantity, 0),\n\t\ttotalValue: cart.items.reduce((sum, item) => {\n\t\t\tconst price = item.selectedVariant?.price ?? item.product.price;\n\t\t\treturn sum + Number(price) * item.quantity;\n\t\t}, 0),\n\t\titems: cart.items.map((item) => ({\n\t\t\tid: item.id,\n\t\t\tproductId: item.productId,\n\t\t\tproductName: item.product.translations[0]?.name ?? item.product.slug,\n\t\t\tvariantSku: item.selectedVariant?.sku,\n\t\t\tquantity: item.quantity,\n\t\t\tprice: Number(item.selectedVariant?.price ?? item.product.price),\n\t\t})),\n\t\tabandonedAt: cart.updatedAt,\n\t\tcreatedAt: cart.createdAt,\n\t}));\n}\n\nexport async function getAbandonedCart(id: string) {\n\tconst { tenantId } = await requireStoreAccess();\n\n\tconst cart = await db.cart.findFirst({\n\t\twhere: { id, tenantId },\n\t\tinclude: {\n\t\t\tcustomer: true,\n\t\t\titems: {\n\t\t\t\tinclude: {\n\t\t\t\t\tproduct: {\n\t\t\t\t\t\tinclude: {\n\t\t\t\t\t\t\ttranslations: {\n\t\t\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tmedia: {\n\t\t\t\t\t\t\t\torderBy: { order: \"asc\" },\n\t\t\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tselectedVariant: true,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\tif (!cart) {\n\t\tthrow new Error(\"Cart not found\");\n\t}\n\n\treturn {\n\t\tid: cart.id,\n\t\tcustomer: cart.customer\n\t\t\t? {\n\t\t\t\t\tid: cart.customer.id,\n\t\t\t\t\temail: cart.customer.email,\n\t\t\t\t\tname: `${cart.customer.firstName ?? \"\"} ${cart.customer.lastName ?? \"\"}`.trim() || \"Unknown\",\n\t\t\t\t\tphone: cart.customer.phone,\n\t\t\t\t}\n\t\t\t: null,\n\t\tsessionId: cart.sessionId,\n\t\titems: cart.items.map((item) => ({\n\t\t\tid: item.id,\n\t\t\tproductId: item.productId,\n\t\t\tproductName: item.product.translations[0]?.name ?? item.product.slug,\n\t\t\tproductImage: item.product.media[0]?.url,\n\t\t\tvariantSku: item.selectedVariant?.sku,\n\t\t\tvariantOptions: item.selectedVariant\n\t\t\t\t? Object.entries(item.selectedVariant.options as Record<string, string>)\n\t\t\t\t\t\t.map(([key, value]) => `${key}: ${value}`)\n\t\t\t\t\t\t.join(\", \")\n\t\t\t\t: null,\n\t\t\tquantity: item.quantity,\n\t\t\tprice: Number(item.selectedVariant?.price ?? item.product.price),\n\t\t})),\n\t\ttotalValue: cart.items.reduce((sum, item) => {\n\t\t\tconst price = item.selectedVariant?.price ?? item.product.price;\n\t\t\treturn sum + Number(price) * item.quantity;\n\t\t}, 0),\n\t\tabandonedAt: cart.updatedAt,\n\t\tcreatedAt: cart.createdAt,\n\t};\n}\n\nexport async function deleteAbandonedCart(id: string) {\n\tconst { tenantId } = await requireStoreAccess();\n\n\t// Verify cart belongs to tenant\n\tconst cart = await db.cart.findFirst({\n\t\twhere: { id, tenantId },\n\t});\n\n\tif (!cart) {\n\t\tthrow new Error(\"Cart not found or access denied\");\n\t}\n\n\tawait db.cart.delete({\n\t\twhere: { id },\n\t});\n\n\treturn { success: true };\n}\n\nexport async function getAbandonedCartStats() {\n\tconst { tenantId } = await requireStoreAccess();\n\n\tconst oneHourAgo = new Date(Date.now() - 60 * 60 * 1000);\n\tconst oneDayAgo = new Date(Date.now() - 24 * 60 * 60 * 1000);\n\tconst oneWeekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);\n\n\t// Get all abandoned carts\n\tconst abandonedCarts = await db.cart.findMany({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tupdatedAt: {\n\t\t\t\tlt: oneHourAgo,\n\t\t\t},\n\t\t\titems: {\n\t\t\t\tsome: {},\n\t\t\t},\n\t\t},\n\t\tinclude: {\n\t\t\titems: {\n\t\t\t\tinclude: {\n\t\t\t\t\tproduct: true,\n\t\t\t\t\tselectedVariant: true,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\t// Calculate stats\n\tconst totalCarts = abandonedCarts.length;\n\tconst totalValue = abandonedCarts.reduce((sum, cart) => {\n\t\treturn (\n\t\t\tsum +\n\t\t\tcart.items.reduce((itemSum, item) => {\n\t\t\t\tconst price = item.selectedVariant?.price ?? item.product.price;\n\t\t\t\treturn itemSum + Number(price) * item.quantity;\n\t\t\t}, 0)\n\t\t);\n\t}, 0);\n\n\tconst last24Hours = abandonedCarts.filter(\n\t\t(cart) => cart.updatedAt >= oneDayAgo,\n\t).length;\n\tconst lastWeek = abandonedCarts.filter(\n\t\t(cart) => cart.updatedAt >= oneWeekAgo,\n\t).length;\n\n\treturn {\n\t\ttotalCarts,\n\t\ttotalValue,\n\t\tlast24Hours,\n\t\tlastWeek,\n\t\taverageValue: totalCarts > 0 ? totalValue / totalCarts : 0,\n\t};\n}\n"],"names":[],"mappings":";;;;;;;MAoLsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,yDAAA"}},
    {"offset": {"line": 416, "column": 0}, "map": {"version":3,"sources":["file:///Users/bobkata/Projects/boostcart/apps/platform/src/app/%28internal%29/admin/orders/abandoned-checkouts/page.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n\tAlertTriangle,\n\tClock,\n\tDollarSign,\n\tEye,\n\tMail,\n\tShoppingCart,\n\tTrash2,\n\tTrendingUp,\n} from \"lucide-react\";\nimport { useEffect, useState } from \"react\";\nimport { toast } from \"sonner\";\nimport { PolarisButton } from \"@/components/admin/polaris-button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport {\n\tDialog,\n\tDialogContent,\n\tDialogDescription,\n\tDialogFooter,\n\tDialogHeader,\n\tDialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n\tEmpty,\n\tEmptyContent,\n\tEmptyDescription,\n\tEmptyHeader,\n\tEmptyMedia,\n\tEmptyTitle,\n} from \"@/components/ui/empty\";\nimport {\n\tTable,\n\tTableBody,\n\tTableCell,\n\tTableHead,\n\tTableHeader,\n\tTableRow,\n} from \"@/components/ui/table\";\nimport {\n\tdeleteAbandonedCart,\n\tgetAbandonedCarts,\n\tgetAbandonedCartStats,\n} from \"@/server/api/internal/abandoned-carts\";\n\ninterface AbandonedCart {\n\tid: string;\n\tcustomer: {\n\t\tid: string;\n\t\tname: string;\n\t\temail: string;\n\t} | null;\n\tsessionId: string | null;\n\titemCount: number;\n\ttotalValue: number;\n\titems: {\n\t\tid: string;\n\t\tproductId: string;\n\t\tproductName: string;\n\t\tvariantSku: string | null | undefined;\n\t\tquantity: number;\n\t\tprice: number;\n\t}[];\n\tabandonedAt: Date;\n\tcreatedAt: Date;\n}\n\ninterface CartStats {\n\ttotalCarts: number;\n\ttotalValue: number;\n\tlast24Hours: number;\n\tlastWeek: number;\n\taverageValue: number;\n}\n\nexport default function AbandonedCheckoutsPage() {\n\tconst [carts, setCarts] = useState<AbandonedCart[]>([]);\n\tconst [stats, setStats] = useState<CartStats | null>(null);\n\tconst [loading, setLoading] = useState(true);\n\tconst [viewDialogOpen, setViewDialogOpen] = useState(false);\n\tconst [deleteDialogOpen, setDeleteDialogOpen] = useState(false);\n\tconst [selectedCart, setSelectedCart] = useState<AbandonedCart | null>(null);\n\tconst [deleting, setDeleting] = useState(false);\n\n\tuseEffect(() => {\n\t\tloadData();\n\t}, []);\n\n\tasync function loadData() {\n\t\ttry {\n\t\t\tsetLoading(true);\n\t\t\tconst [cartsData, statsData] = await Promise.all([\n\t\t\t\tgetAbandonedCarts(),\n\t\t\t\tgetAbandonedCartStats(),\n\t\t\t]);\n\t\t\tsetCarts(cartsData);\n\t\t\tsetStats(statsData);\n\t\t} catch (error) {\n\t\t\ttoast.error(\"Failed to load abandoned carts\");\n\t\t} finally {\n\t\t\tsetLoading(false);\n\t\t}\n\t}\n\n\tconst handleView = (cart: AbandonedCart) => {\n\t\tsetSelectedCart(cart);\n\t\tsetViewDialogOpen(true);\n\t};\n\n\tconst handleDeleteClick = (cart: AbandonedCart) => {\n\t\tsetSelectedCart(cart);\n\t\tsetDeleteDialogOpen(true);\n\t};\n\n\tconst handleDelete = async () => {\n\t\tif (!selectedCart) return;\n\n\t\ttry {\n\t\t\tsetDeleting(true);\n\t\t\tawait deleteAbandonedCart(selectedCart.id);\n\t\t\tsetCarts((prev) => prev.filter((c) => c.id !== selectedCart.id));\n\t\t\tsetDeleteDialogOpen(false);\n\t\t\ttoast.success(\"Abandoned cart deleted\");\n\t\t\tloadData(); // Refresh stats\n\t\t} catch (error) {\n\t\t\ttoast.error(\"Failed to delete cart\");\n\t\t} finally {\n\t\t\tsetDeleting(false);\n\t\t}\n\t};\n\n\tconst handleSendRecoveryEmail = (cart: AbandonedCart) => {\n\t\tif (cart.customer?.email) {\n\t\t\ttoast.success(`Recovery email sent to ${cart.customer.email}`);\n\t\t} else {\n\t\t\ttoast.error(\"No email address available for this cart\");\n\t\t}\n\t};\n\n\tconst formatCurrency = (amount: number) => {\n\t\treturn new Intl.NumberFormat(\"bg-BG\", {\n\t\t\tstyle: \"currency\",\n\t\t\tcurrency: \"BGN\",\n\t\t}).format(amount);\n\t};\n\n\tconst formatTimeAgo = (date: Date) => {\n\t\tconst now = new Date();\n\t\tconst diff = now.getTime() - new Date(date).getTime();\n\t\tconst hours = Math.floor(diff / (1000 * 60 * 60));\n\t\tconst days = Math.floor(hours / 24);\n\n\t\tif (days > 0) return `${days} day${days > 1 ? \"s\" : \"\"} ago`;\n\t\treturn `${hours} hour${hours > 1 ? \"s\" : \"\"} ago`;\n\t};\n\n\tif (loading) {\n\t\treturn (\n\t\t\t<div className=\"flex items-center justify-center h-64\">\n\t\t\t\t<div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\" />\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn (\n\t\t<div className=\"space-y-6\">\n\t\t\t<div>\n\t\t\t\t<h1 className=\"text-3xl font-bold tracking-tight\">\n\t\t\t\t\tAbandoned Checkouts\n\t\t\t\t</h1>\n\t\t\t\t<p className=\"text-muted-foreground mt-1\">\n\t\t\t\t\tView and recover abandoned shopping carts\n\t\t\t\t</p>\n\t\t\t</div>\n\n\t\t\t<div className=\"grid gap-4 md:grid-cols-4\">\n\t\t\t\t<Card className=\"p-4\">\n\t\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t\t<ShoppingCart className=\"h-4 w-4 text-muted-foreground\" />\n\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">Total Abandoned</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<p className=\"text-2xl font-bold mt-1\">{stats?.totalCarts ?? 0}</p>\n\t\t\t\t</Card>\n\t\t\t\t<Card className=\"p-4\">\n\t\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t\t<DollarSign className=\"h-4 w-4 text-muted-foreground\" />\n\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">Potential Revenue</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<p className=\"text-2xl font-bold mt-1\">\n\t\t\t\t\t\t{formatCurrency(stats?.totalValue ?? 0)}\n\t\t\t\t\t</p>\n\t\t\t\t</Card>\n\t\t\t\t<Card className=\"p-4\">\n\t\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t\t<Clock className=\"h-4 w-4 text-muted-foreground\" />\n\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">Last 24 Hours</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<p className=\"text-2xl font-bold mt-1\">{stats?.last24Hours ?? 0}</p>\n\t\t\t\t</Card>\n\t\t\t\t<Card className=\"p-4\">\n\t\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t\t<TrendingUp className=\"h-4 w-4 text-muted-foreground\" />\n\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">Average Value</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<p className=\"text-2xl font-bold mt-1\">\n\t\t\t\t\t\t{formatCurrency(stats?.averageValue ?? 0)}\n\t\t\t\t\t</p>\n\t\t\t\t</Card>\n\t\t\t</div>\n\n\t\t\t<Card>\n\t\t\t\t{carts.length === 0 ? (\n\t\t\t\t\t<Empty>\n\t\t\t\t\t\t<EmptyHeader>\n\t\t\t\t\t\t\t<EmptyMedia variant=\"icon\">\n\t\t\t\t\t\t\t\t<ShoppingCart className=\"h-8 w-8\" />\n\t\t\t\t\t\t\t</EmptyMedia>\n\t\t\t\t\t\t\t<EmptyTitle>No abandoned carts</EmptyTitle>\n\t\t\t\t\t\t\t<EmptyDescription>\n\t\t\t\t\t\t\t\tWhen customers leave items in their cart without completing\n\t\t\t\t\t\t\t\tcheckout, they&apos;ll appear here\n\t\t\t\t\t\t\t</EmptyDescription>\n\t\t\t\t\t\t</EmptyHeader>\n\t\t\t\t\t\t<EmptyContent>\n\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\tAll carts are either completed or empty\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</EmptyContent>\n\t\t\t\t\t</Empty>\n\t\t\t\t) : (\n\t\t\t\t\t<Table>\n\t\t\t\t\t\t<TableHeader>\n\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t<TableHead>Customer</TableHead>\n\t\t\t\t\t\t\t\t<TableHead>Items</TableHead>\n\t\t\t\t\t\t\t\t<TableHead>Value</TableHead>\n\t\t\t\t\t\t\t\t<TableHead>Abandoned</TableHead>\n\t\t\t\t\t\t\t\t<TableHead>Status</TableHead>\n\t\t\t\t\t\t\t\t<TableHead className=\"text-right\">Actions</TableHead>\n\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t</TableHeader>\n\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t{carts.map((cart) => (\n\t\t\t\t\t\t\t\t<TableRow key={cart.id}>\n\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t{cart.customer ? (\n\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"font-medium\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{cart.customer.name}\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{cart.customer.email}\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-muted-foreground\">Guest</p>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell>{cart.itemCount} items</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell className=\"font-medium\">\n\t\t\t\t\t\t\t\t\t\t{formatCurrency(cart.totalValue)}\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell>{formatTimeAgo(cart.abandonedAt)}</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell>\n\t\t\t\t\t\t\t\t\t\t<Badge variant=\"secondary\">\n\t\t\t\t\t\t\t\t\t\t\t<AlertTriangle className=\"h-3 w-3 mr-1\" />\n\t\t\t\t\t\t\t\t\t\t\tAbandoned\n\t\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell className=\"text-right\">\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex justify-end gap-2\">\n\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => handleView(cart)}\n\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"View details\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<Eye className=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t{cart.customer?.email && (\n\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => handleSendRecoveryEmail(cart)}\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"Send recovery email\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Mail className=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => handleDeleteClick(cart)}\n\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"Delete\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<Trash2 className=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t</Table>\n\t\t\t\t)}\n\t\t\t</Card>\n\n\t\t\t{/* View Dialog */}\n\t\t\t<Dialog open={viewDialogOpen} onOpenChange={setViewDialogOpen}>\n\t\t\t\t<DialogContent className=\"max-w-2xl\">\n\t\t\t\t\t<DialogHeader>\n\t\t\t\t\t\t<DialogTitle>Abandoned Cart Details</DialogTitle>\n\t\t\t\t\t\t<DialogDescription>\n\t\t\t\t\t\t\tView the items left in this abandoned cart\n\t\t\t\t\t\t</DialogDescription>\n\t\t\t\t\t</DialogHeader>\n\n\t\t\t\t\t{selectedCart && (\n\t\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t\t<div className=\"grid grid-cols-2 gap-4\">\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">Customer</p>\n\t\t\t\t\t\t\t\t\t{selectedCart.customer ? (\n\t\t\t\t\t\t\t\t\t\t<div className=\"mt-1\">\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"font-medium\">\n\t\t\t\t\t\t\t\t\t\t\t\t{selectedCart.customer.name}\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm\">{selectedCart.customer.email}</p>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-muted-foreground mt-1\">Guest visitor</p>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">Abandoned</p>\n\t\t\t\t\t\t\t\t\t<p className=\"font-medium mt-1\">\n\t\t\t\t\t\t\t\t\t\t{formatTimeAgo(selectedCart.abandonedAt)}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground mb-2\">\n\t\t\t\t\t\t\t\t\tCart Items\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t<div className=\"border rounded-lg divide-y\">\n\t\t\t\t\t\t\t\t\t{selectedCart.items.map((item) => (\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tkey={item.id}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"p-3 flex items-center justify-between\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"font-medium\">{item.productName}</p>\n\t\t\t\t\t\t\t\t\t\t\t\t{item.variantSku && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tSKU: {item.variantSku}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-right\">\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"font-medium\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{formatCurrency(item.price)}\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tQty: {item.quantity}\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div className=\"flex justify-between items-center pt-4 border-t\">\n\t\t\t\t\t\t\t\t<p className=\"font-medium\">Total Value</p>\n\t\t\t\t\t\t\t\t<p className=\"text-xl font-bold\">\n\t\t\t\t\t\t\t\t\t{formatCurrency(selectedCart.totalValue)}\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\n\t\t\t\t\t<DialogFooter>\n\t\t\t\t\t\t{selectedCart?.customer?.email && (\n\t\t\t\t\t\t\t<PolarisButton\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\thandleSendRecoveryEmail(selectedCart);\n\t\t\t\t\t\t\t\t\tsetViewDialogOpen(false);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Mail className=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\tSend Recovery Email\n\t\t\t\t\t\t\t</PolarisButton>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<Button variant=\"outline\" onClick={() => setViewDialogOpen(false)}>\n\t\t\t\t\t\t\tClose\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</DialogFooter>\n\t\t\t\t</DialogContent>\n\t\t\t</Dialog>\n\n\t\t\t{/* Delete Dialog */}\n\t\t\t<Dialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>\n\t\t\t\t<DialogContent>\n\t\t\t\t\t<DialogHeader>\n\t\t\t\t\t\t<DialogTitle>Delete Abandoned Cart</DialogTitle>\n\t\t\t\t\t\t<DialogDescription>\n\t\t\t\t\t\t\tAre you sure you want to delete this abandoned cart? This action\n\t\t\t\t\t\t\tcannot be undone.\n\t\t\t\t\t\t</DialogDescription>\n\t\t\t\t\t</DialogHeader>\n\n\t\t\t\t\t{selectedCart && (\n\t\t\t\t\t\t<div className=\"py-4\">\n\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\tCart contains {selectedCart.itemCount} items worth{\" \"}\n\t\t\t\t\t\t\t\t{formatCurrency(selectedCart.totalValue)}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\n\t\t\t\t\t<DialogFooter>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\tonClick={() => setDeleteDialogOpen(false)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tCancel\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"destructive\"\n\t\t\t\t\t\t\tonClick={handleDelete}\n\t\t\t\t\t\t\tdisabled={deleting}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{deleting ? \"Deleting...\" : \"Delete Cart\"}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</DialogFooter>\n\t\t\t\t</DialogContent>\n\t\t\t</Dialog>\n\t\t</div>\n\t);\n}\n"],"names":[],"mappings":"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"}}]
}