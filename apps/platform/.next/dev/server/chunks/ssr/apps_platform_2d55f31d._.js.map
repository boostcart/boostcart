{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/bobkata/Projects/boostcart/apps/platform/src/schemas/product.ts"],"sourcesContent":["import { z } from \"zod\";\n\n// Enums matching Prisma schema\nexport const ProductStatusEnum = z.enum([\"ACTIVE\", \"UNLISTED\", \"DRAFT\"]);\nexport const MediaTypeEnum = z.enum([\"IMAGE\", \"VIDEO\"]);\nexport const PurchaseTypeEnum = z.enum([\n\t\"ONE_TIME\",\n\t\"SUBSCRIPTION\",\n\t\"ONE_TIME_AND_SUBSCRIPTION\",\n\t\"PRE_ORDER\",\n]);\nexport const SubscriptionIntervalEnum = z.enum([\n\t\"WEEKLY\",\n\t\"BI_WEEKLY\",\n\t\"MONTHLY\",\n\t\"BI_MONTHLY\",\n\t\"QUARTERLY\",\n\t\"YEARLY\",\n]);\nexport const PackageTypeEnum = z.enum([\n\t\"BOX\",\n\t\"ENVELOPE\",\n\t\"SOFT_PACKAGE\",\n\t\"PALLET\",\n]);\nexport const MeasurementUnitEnum = z.enum([\n\t\"KG\",\n\t\"G\",\n\t\"L\",\n\t\"ML\",\n\t\"M\",\n\t\"CM\",\n\t\"MM\",\n\t\"SQM\",\n\t\"SQCM\",\n\t\"PER_ITEM\",\n]);\n\n// Types\nexport type ProductStatus = z.infer<typeof ProductStatusEnum>;\nexport type MediaType = z.infer<typeof MediaTypeEnum>;\nexport type PurchaseType = z.infer<typeof PurchaseTypeEnum>;\nexport type SubscriptionInterval = z.infer<typeof SubscriptionIntervalEnum>;\nexport type PackageType = z.infer<typeof PackageTypeEnum>;\nexport type MeasurementUnit = z.infer<typeof MeasurementUnitEnum>;\n\n// Product Media Schema\nexport const ProductMediaSchema = z.object({\n\tid: z.string().optional(),\n\turl: z.string().url(),\n\tmediaType: MediaTypeEnum,\n\taltText: z.string().optional(),\n\torder: z.number().int().min(0),\n});\nexport type ProductMediaInput = z.infer<typeof ProductMediaSchema>;\n\n// Variant Option Meta (for color picker etc)\nexport const VariantOptionMetaSchema = z.object({\n\toptionName: z.string(),\n\thexColor: z\n\t\t.string()\n\t\t.regex(/^#[0-9A-Fa-f]{6}$/)\n\t\t.optional(),\n});\nexport type VariantOptionMeta = z.infer<typeof VariantOptionMetaSchema>;\n\n// Product Variant Schema\nexport const ProductVariantSchema = z.object({\n\tid: z.string().optional(),\n\tsku: z.string().optional(),\n\tprice: z.number().positive().optional(), // Override price\n\tpriceAdjustment: z.number().default(0),\n\tstock: z.number().int().min(0).optional(),\n\timageUrl: z.string().url().optional(),\n\toptions: z.record(z.string(), z.string()).default({}), // { \"Color\": \"Red\", \"Size\": \"Large\" }\n\toptionMeta: z.array(VariantOptionMetaSchema).optional(),\n});\nexport type ProductVariantInput = z.infer<typeof ProductVariantSchema>;\n\n// Product Shipping Schema\nexport const ProductShippingSchema = z.object({\n\tpackageType: PackageTypeEnum.default(\"BOX\"),\n\t// Packaging weight\n\tweight: z.number().positive().optional(),\n\t// Package dimensions\n\tpackageLength: z.number().positive().optional(),\n\tpackageWidth: z.number().positive().optional(),\n\tpackageHeight: z.number().positive().optional(),\n\t// Product weight\n\tproductWeight: z.number().positive().optional(),\n\t// Product dimensions (for pallets)\n\tproductLength: z.number().positive().optional(),\n\tproductWidth: z.number().positive().optional(),\n\tproductHeight: z.number().positive().optional(),\n\t// Flags\n\tisFragile: z.boolean().default(false),\n\tisFreeShipping: z.boolean().default(false),\n\ttags: z.array(z.string()).default([]),\n});\nexport type ProductShippingInput = z.infer<typeof ProductShippingSchema>;\n\n// Product SEO Schema\nexport const ProductSeoSchema = z.object({\n\tmetaTitle: z.string().max(70).optional(),\n\tmetaDescription: z.string().max(160).optional(),\n\tslug: z\n\t\t.string()\n\t\t.regex(/^[a-z0-9]+(?:-[a-z0-9]+)*$/)\n\t\t.optional(),\n});\nexport type ProductSeoInput = z.infer<typeof ProductSeoSchema>;\n\n// Product Purchase Options Schema\nexport const ProductPurchaseOptionsSchema = z.object({\n\ttype: PurchaseTypeEnum.default(\"ONE_TIME\"),\n\tallowOneTimePurchase: z.boolean().default(true),\n\tsubscriptionDiscount: z.number().min(0).max(100).optional(),\n\tsubscriptionIntervals: z.array(SubscriptionIntervalEnum).optional(),\n\tpreOrderReleaseDate: z.coerce.date().optional(),\n\tpreOrderDepositPercent: z.number().min(0).max(100).optional(),\n});\nexport type ProductPurchaseOptionsInput = z.infer<\n\ttypeof ProductPurchaseOptionsSchema\n>;\n\n// Unit Price Schema\nexport const ProductUnitPriceSchema = z.object({\n\tunitPriceAmount: z.number().positive().optional(),\n\tunitPriceMeasurement: MeasurementUnitEnum.optional(),\n\tunitPriceBaseAmount: z.number().positive().optional(),\n\tunitPriceBaseMeasurement: MeasurementUnitEnum.optional(),\n});\nexport type ProductUnitPriceInput = z.infer<typeof ProductUnitPriceSchema>;\n\n// Full Create Product Schema\nexport const CreateProductSchema = z.object({\n\t// Basic info\n\tname: z.string().min(1, \"Name is required\").max(255),\n\tdescription: z.string().optional(),\n\tslug: z.string().regex(/^[a-z0-9]+(?:-[a-z0-9]+)*$/, \"Invalid URL format\"),\n\tstatus: ProductStatusEnum.default(\"DRAFT\"),\n\n\t// Categorization\n\tcategoryId: z.string().min(1, \"Category is required\"),\n\tbrandId: z.string().optional(),\n\tcollectionIds: z.array(z.string()).optional(),\n\n\t// Pricing\n\tprice: z.number().positive(\"Price must be greater than 0\"),\n\tcompareAtPrice: z.number().positive().optional(),\n\tcostPerItem: z.number().positive().optional(),\n\tunitPrice: ProductUnitPriceSchema.optional(),\n\n\t// Inventory\n\tsku: z.string().optional(),\n\ttrackStock: z.boolean().default(false),\n\tstock: z.number().int().min(0).optional(),\n\tlowStockThreshold: z.number().int().min(0).optional(),\n\n\t// Media\n\tmedia: z.array(ProductMediaSchema).optional(),\n\n\t// Variants\n\tvariants: z.array(ProductVariantSchema).optional(),\n\n\t// Shipping\n\tshippingInfo: ProductShippingSchema.optional(),\n\n\t// Purchase options\n\tpurchaseOptions: ProductPurchaseOptionsSchema.optional(),\n\n\t// SEO\n\tseo: ProductSeoSchema.optional(),\n});\n\nexport type CreateProductInput = z.infer<typeof CreateProductSchema>;\n\n// Update Product Schema (all fields optional)\nexport const UpdateProductSchema = CreateProductSchema.partial().extend({\n\tid: z.string(),\n});\nexport type UpdateProductInput = z.infer<typeof UpdateProductSchema>;\n\n// Variant Group Schema (for form state)\nexport const VariantGroupSchema = z.object({\n\tname: z.string().min(1, \"Variant name is required\"),\n\tvalues: z\n\t\t.array(\n\t\t\tz.object({\n\t\t\t\tvalue: z.string().min(1),\n\t\t\t\thexColor: z\n\t\t\t\t\t.string()\n\t\t\t\t\t.regex(/^#[0-9A-Fa-f]{6}$/)\n\t\t\t\t\t.optional(),\n\t\t\t}),\n\t\t)\n\t\t.min(1, \"At least one value is required\"),\n});\nexport type VariantGroupInput = z.infer<typeof VariantGroupSchema>;\n\n// Product filter schema for list page\nexport const ProductFilterSchema = z.object({\n\tsearch: z.string().optional(),\n\tstatus: z.array(ProductStatusEnum).optional(),\n\tcategoryIds: z.array(z.string()).optional(),\n\tbrandIds: z.array(z.string()).optional(),\n\tstockStatus: z\n\t\t.enum([\"all\", \"in_stock\", \"low_stock\", \"out_of_stock\"])\n\t\t.optional(),\n\tpriceMin: z.number().min(0).optional(),\n\tpriceMax: z.number().min(0).optional(),\n\tpurchaseType: z.array(PurchaseTypeEnum).optional(),\n\tsortBy: z\n\t\t.enum([\n\t\t\t\"name_asc\",\n\t\t\t\"name_desc\",\n\t\t\t\"price_asc\",\n\t\t\t\"price_desc\",\n\t\t\t\"created_asc\",\n\t\t\t\"created_desc\",\n\t\t\t\"stock_asc\",\n\t\t\t\"stock_desc\",\n\t\t])\n\t\t.optional(),\n\tpage: z.number().int().min(1).default(1),\n\tpageSize: z.number().int().min(1).max(100).default(20),\n});\nexport type ProductFilterInput = z.infer<typeof ProductFilterSchema>;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 216, "column": 0}, "map": {"version":3,"sources":["file:///Users/bobkata/Projects/boostcart/apps/platform/src/lib/tenant.ts"],"sourcesContent":["import { db } from \"@/server/db\";\nimport type { Tenant } from \"@boostcart/database\";\n\n// Cache for tenant lookups\nconst tenantCache = new Map<string, { tenant: Tenant; expiry: number }>();\nconst CACHE_TTL = 60 * 1000; // 1 minute\n\n/**\n * Get tenant by subdomain (slug)\n */\nexport async function getTenantBySlug(slug: string): Promise<Tenant | null> {\n\t// Check cache first\n\tconst cached = tenantCache.get(`slug:${slug}`);\n\tif (cached && cached.expiry > Date.now()) {\n\t\treturn cached.tenant;\n\t}\n\n\tconst tenant = await db.tenant.findFirst({\n\t\twhere: {\n\t\t\tslug,\n\t\t\tisActive: true,\n\t\t\tdeletedAt: null,\n\t\t},\n\t});\n\n\tif (tenant) {\n\t\ttenantCache.set(`slug:${slug}`, {\n\t\t\ttenant,\n\t\t\texpiry: Date.now() + CACHE_TTL,\n\t\t});\n\t}\n\n\treturn tenant;\n}\n\n/**\n * Get tenant by custom domain\n */\nexport async function getTenantByDomain(domain: string): Promise<Tenant | null> {\n\t// Check cache first\n\tconst cached = tenantCache.get(`domain:${domain}`);\n\tif (cached && cached.expiry > Date.now()) {\n\t\treturn cached.tenant;\n\t}\n\n\tconst tenantDomain = await db.tenantDomain.findFirst({\n\t\twhere: {\n\t\t\tdomain,\n\t\t\tdnsVerified: true,\n\t\t},\n\t\tinclude: {\n\t\t\ttenant: true,\n\t\t},\n\t});\n\n\tif (tenantDomain?.tenant && tenantDomain.tenant.isActive) {\n\t\ttenantCache.set(`domain:${domain}`, {\n\t\t\ttenant: tenantDomain.tenant,\n\t\t\texpiry: Date.now() + CACHE_TTL,\n\t\t});\n\t\treturn tenantDomain.tenant;\n\t}\n\n\treturn null;\n}\n\n/**\n * Extract tenant from request hostname\n */\nexport async function getTenantFromRequest(\n\thostname: string | null\n): Promise<Tenant | null> {\n\tif (!hostname) return null;\n\n\t// Remove port if present\n\tconst host = hostname.split(\":\")[0];\n\tif (!host) return null;\n\n\t// Check if it's the main platform domain\n\tconst platformDomains = [\"boostcart.bg\", \"localhost\", \"127.0.0.1\"];\n\tconst isMainDomain = platformDomains.some(\n\t\t(d) => host === d || host === `www.${d}`\n\t);\n\n\tif (isMainDomain) {\n\t\t// No tenant for main domain\n\t\treturn null;\n\t}\n\n\t// Check for subdomain (e.g., store.boostcart.bg)\n\tconst subdomainMatch = host.match(/^([a-z0-9-]+)\\.boostcart\\.bg$/i);\n\tif (subdomainMatch?.[1]) {\n\t\tconst slug = subdomainMatch[1];\n\t\t// Skip common subdomains\n\t\tif ([\"www\", \"api\", \"admin\", \"staging\", \"dev\"].includes(slug)) {\n\t\t\treturn null;\n\t\t}\n\t\treturn getTenantBySlug(slug);\n\t}\n\n\t// Check for local dev subdomain (e.g., store.localhost)\n\tconst localSubdomainMatch = host.match(/^([a-z0-9-]+)\\.localhost$/i);\n\tif (localSubdomainMatch?.[1]) {\n\t\treturn getTenantBySlug(localSubdomainMatch[1]);\n\t}\n\n\t// Otherwise, check if it's a custom domain\n\treturn getTenantByDomain(host);\n}\n\n/**\n * Clear tenant cache (useful after updates)\n */\nexport function clearTenantCache(identifier?: string) {\n\tif (identifier) {\n\t\ttenantCache.delete(`slug:${identifier}`);\n\t\ttenantCache.delete(`domain:${identifier}`);\n\t} else {\n\t\ttenantCache.clear();\n\t}\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;;;;;AAGA,2BAA2B;AAC3B,MAAM,cAAc,IAAI;AACxB,MAAM,YAAY,KAAK,MAAM,WAAW;AAKjC,eAAe,gBAAgB,IAAY;IACjD,oBAAoB;IACpB,MAAM,SAAS,YAAY,GAAG,CAAC,CAAC,KAAK,EAAE,MAAM;IAC7C,IAAI,UAAU,OAAO,MAAM,GAAG,KAAK,GAAG,IAAI;QACzC,OAAO,OAAO,MAAM;IACrB;IAEA,MAAM,SAAS,MAAM,6IAAE,CAAC,MAAM,CAAC,SAAS,CAAC;QACxC,OAAO;YACN;YACA,UAAU;YACV,WAAW;QACZ;IACD;IAEA,IAAI,QAAQ;QACX,YAAY,GAAG,CAAC,CAAC,KAAK,EAAE,MAAM,EAAE;YAC/B;YACA,QAAQ,KAAK,GAAG,KAAK;QACtB;IACD;IAEA,OAAO;AACR;AAKO,eAAe,kBAAkB,MAAc;IACrD,oBAAoB;IACpB,MAAM,SAAS,YAAY,GAAG,CAAC,CAAC,OAAO,EAAE,QAAQ;IACjD,IAAI,UAAU,OAAO,MAAM,GAAG,KAAK,GAAG,IAAI;QACzC,OAAO,OAAO,MAAM;IACrB;IAEA,MAAM,eAAe,MAAM,6IAAE,CAAC,YAAY,CAAC,SAAS,CAAC;QACpD,OAAO;YACN;YACA,aAAa;QACd;QACA,SAAS;YACR,QAAQ;QACT;IACD;IAEA,IAAI,cAAc,UAAU,aAAa,MAAM,CAAC,QAAQ,EAAE;QACzD,YAAY,GAAG,CAAC,CAAC,OAAO,EAAE,QAAQ,EAAE;YACnC,QAAQ,aAAa,MAAM;YAC3B,QAAQ,KAAK,GAAG,KAAK;QACtB;QACA,OAAO,aAAa,MAAM;IAC3B;IAEA,OAAO;AACR;AAKO,eAAe,qBACrB,QAAuB;IAEvB,IAAI,CAAC,UAAU,OAAO;IAEtB,yBAAyB;IACzB,MAAM,OAAO,SAAS,KAAK,CAAC,IAAI,CAAC,EAAE;IACnC,IAAI,CAAC,MAAM,OAAO;IAElB,yCAAyC;IACzC,MAAM,kBAAkB;QAAC;QAAgB;QAAa;KAAY;IAClE,MAAM,eAAe,gBAAgB,IAAI,CACxC,CAAC,IAAM,SAAS,KAAK,SAAS,CAAC,IAAI,EAAE,GAAG;IAGzC,IAAI,cAAc;QACjB,4BAA4B;QAC5B,OAAO;IACR;IAEA,iDAAiD;IACjD,MAAM,iBAAiB,KAAK,KAAK,CAAC;IAClC,IAAI,gBAAgB,CAAC,EAAE,EAAE;QACxB,MAAM,OAAO,cAAc,CAAC,EAAE;QAC9B,yBAAyB;QACzB,IAAI;YAAC;YAAO;YAAO;YAAS;YAAW;SAAM,CAAC,QAAQ,CAAC,OAAO;YAC7D,OAAO;QACR;QACA,OAAO,gBAAgB;IACxB;IAEA,wDAAwD;IACxD,MAAM,sBAAsB,KAAK,KAAK,CAAC;IACvC,IAAI,qBAAqB,CAAC,EAAE,EAAE;QAC7B,OAAO,gBAAgB,mBAAmB,CAAC,EAAE;IAC9C;IAEA,2CAA2C;IAC3C,OAAO,kBAAkB;AAC1B;AAKO,SAAS,iBAAiB,UAAmB;IACnD,IAAI,YAAY;QACf,YAAY,MAAM,CAAC,CAAC,KAAK,EAAE,YAAY;QACvC,YAAY,MAAM,CAAC,CAAC,OAAO,EAAE,YAAY;IAC1C,OAAO;QACN,YAAY,KAAK;IAClB;AACD"}},
    {"offset": {"line": 335, "column": 0}, "map": {"version":3,"sources":["file:///Users/bobkata/Projects/boostcart/apps/platform/src/server/tenant.ts"],"sourcesContent":["\"use server\";\n\nimport { headers } from \"next/headers\";\nimport { cache } from \"react\";\nimport { getTenantByDomain, getTenantBySlug } from \"@/lib/tenant\";\nimport type { Tenant } from \"@boostcart/database\";\nimport { auth } from \"./auth\";\nimport { db } from \"./db\";\n\n/**\n * Get the current tenant from the request context (storefront)\n * This is cached per-request using React's cache()\n */\nexport const getCurrentTenant = cache(async (): Promise<Tenant | null> => {\n\tconst headersList = await headers();\n\n\t// Check for tenant slug from subdomain\n\tconst tenantSlug = headersList.get(\"x-tenant-slug\");\n\tif (tenantSlug) {\n\t\treturn getTenantBySlug(tenantSlug);\n\t}\n\n\t// Check for custom domain\n\tconst customDomain = headersList.get(\"x-custom-domain\");\n\tif (customDomain) {\n\t\treturn getTenantByDomain(customDomain);\n\t}\n\n\treturn null;\n});\n\n/**\n * Get the current tenant for admin context (from user's store ownership)\n * This is used when accessing via boostcart.bg/admin (not subdomain)\n */\nexport const getAdminTenant = cache(async (): Promise<Tenant | null> => {\n\tconst session = await auth();\n\tif (!session?.user?.id) {\n\t\treturn null;\n\t}\n\n\t// Get the user's primary store (first store they have access to)\n\tconst staffRecord = await db.tenantStaff.findFirst({\n\t\twhere: { userId: session.user.id },\n\t\tinclude: { tenant: true },\n\t\torderBy: { createdAt: \"asc\" },\n\t});\n\n\treturn staffRecord?.tenant ?? null;\n});\n\n/**\n * Require tenant to be present (storefront context), throws if not found\n */\nexport async function requireTenant(): Promise<Tenant> {\n\tconst tenant = await getCurrentTenant();\n\tif (!tenant) {\n\t\tthrow new Error(\"Tenant not found\");\n\t}\n\treturn tenant;\n}\n\n/**\n * Require tenant for admin operations\n * First checks storefront context, then falls back to user's store\n */\nexport async function requireAdminTenant(): Promise<Tenant> {\n\t// First try storefront context (subdomain access)\n\tconst storefrontTenant = await getCurrentTenant();\n\tif (storefrontTenant) {\n\t\treturn storefrontTenant;\n\t}\n\n\t// Fall back to user's store (main domain admin access)\n\tconst adminTenant = await getAdminTenant();\n\tif (adminTenant) {\n\t\treturn adminTenant;\n\t}\n\n\tthrow new Error(\"No tenant context found. Please create or select a store.\");\n}\n\n/**\n * Check if we're in a tenant context\n */\nexport async function hasTenantContext(): Promise<boolean> {\n\tconst tenant = await getCurrentTenant();\n\treturn tenant !== null;\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;AAEA;AACA;AACA;AAEA;AACA;;;;;;;;;;;;;;AAMO,MAAM,mBAAmB,IAAA,8MAAK,EAAC;IACrC,MAAM,cAAc,MAAM,IAAA,0IAAO;IAEjC,uCAAuC;IACvC,MAAM,aAAa,YAAY,GAAG,CAAC;IACnC,IAAI,YAAY;QACf,OAAO,IAAA,2JAAe,EAAC;IACxB;IAEA,0BAA0B;IAC1B,MAAM,eAAe,YAAY,GAAG,CAAC;IACrC,IAAI,cAAc;QACjB,OAAO,IAAA,6JAAiB,EAAC;IAC1B;IAEA,OAAO;AACR;AAMO,MAAM,iBAAiB,IAAA,8MAAK,EAAC;IACnC,MAAM,UAAU,MAAM,IAAA,0KAAI;IAC1B,IAAI,CAAC,SAAS,MAAM,IAAI;QACvB,OAAO;IACR;IAEA,iEAAiE;IACjE,MAAM,cAAc,MAAM,6IAAE,CAAC,WAAW,CAAC,SAAS,CAAC;QAClD,OAAO;YAAE,QAAQ,QAAQ,IAAI,CAAC,EAAE;QAAC;QACjC,SAAS;YAAE,QAAQ;QAAK;QACxB,SAAS;YAAE,WAAW;QAAM;IAC7B;IAEA,OAAO,aAAa,UAAU;AAC/B;AAKO,eAAe;IACrB,MAAM,SAAS,MAAM;IACrB,IAAI,CAAC,QAAQ;QACZ,MAAM,IAAI,MAAM;IACjB;IACA,OAAO;AACR;AAMO,eAAe;IACrB,kDAAkD;IAClD,MAAM,mBAAmB,MAAM;IAC/B,IAAI,kBAAkB;QACrB,OAAO;IACR;IAEA,uDAAuD;IACvD,MAAM,cAAc,MAAM;IAC1B,IAAI,aAAa;QAChB,OAAO;IACR;IAEA,MAAM,IAAI,MAAM;AACjB;AAKO,eAAe;IACrB,MAAM,SAAS,MAAM;IACrB,OAAO,WAAW;AACnB;;;IAlCsB;IAYA;IAmBA;;;;AA/BA,+OAAA;AAYA,+OAAA;AAmBA,+OAAA"}},
    {"offset": {"line": 443, "column": 0}, "map": {"version":3,"sources":["file:///Users/bobkata/Projects/boostcart/apps/platform/src/server/api/internal/products.ts"],"sourcesContent":["\"use server\";\n\nimport { revalidatePath } from \"next/cache\";\nimport {\n\ttype CreateProductInput,\n\tCreateProductSchema,\n\ttype ProductFilterInput,\n\tProductFilterSchema,\n\ttype UpdateProductInput,\n\tUpdateProductSchema,\n} from \"@/schemas/product\";\nimport { auth } from \"@/server/auth\";\nimport { db } from \"@/server/db\";\nimport { requireAdminTenant } from \"@/server/tenant\";\n\n// Helper to check access and get tenant context for admin operations\nasync function requireStoreAccess() {\n\tconst session = await auth();\n\tif (!session?.user?.id) {\n\t\tthrow new Error(\"Unauthorized\");\n\t}\n\n\t// Get tenant context (from user's store membership)\n\tconst tenant = await requireAdminTenant();\n\n\t// Verify user has access to this tenant\n\tconst staffRecord = await db.tenantStaff.findFirst({\n\t\twhere: {\n\t\t\tuserId: session.user.id,\n\t\t\ttenantId: tenant.id,\n\t\t},\n\t});\n\n\tif (!staffRecord) {\n\t\tthrow new Error(\"Forbidden: No access to this store\");\n\t}\n\n\treturn { userId: session.user.id, tenantId: tenant.id, role: staffRecord.role };\n}\n\n// Get products with filters\nexport async function getProducts(filters?: ProductFilterInput) {\n\tconst { tenantId } = await requireStoreAccess();\n\n\tconst validatedFilters = filters\n\t\t? ProductFilterSchema.parse(filters)\n\t\t: { page: 1, pageSize: 20 };\n\n\tconst {\n\t\tpage,\n\t\tpageSize,\n\t\tsearch,\n\t\tstatus,\n\t\tcategoryIds,\n\t\tbrandIds,\n\t\tstockStatus,\n\t\tpriceMin,\n\t\tpriceMax,\n\t\tsortBy,\n\t} = validatedFilters;\n\n\tconst where: Record<string, unknown> = {\n\t\ttenantId, // Filter by current tenant\n\t\tdeletedAt: null, // Only active products\n\t};\n\n\t// Search\n\tif (search) {\n\t\twhere.OR = [\n\t\t\t{ sku: { contains: search, mode: \"insensitive\" } },\n\t\t\t{\n\t\t\t\ttranslations: {\n\t\t\t\t\tsome: { name: { contains: search, mode: \"insensitive\" } },\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\t}\n\n\t// Status filter\n\tif (status && status.length > 0) {\n\t\twhere.status = { in: status };\n\t}\n\n\t// Category filter\n\tif (categoryIds && categoryIds.length > 0) {\n\t\twhere.categoryId = { in: categoryIds };\n\t}\n\n\t// Brand filter\n\tif (brandIds && brandIds.length > 0) {\n\t\twhere.brandId = { in: brandIds };\n\t}\n\n\t// Stock status filter\n\tif (stockStatus) {\n\t\tswitch (stockStatus) {\n\t\t\tcase \"in_stock\":\n\t\t\t\twhere.OR = [{ trackStock: false }, { stock: { gt: 10 } }];\n\t\t\t\tbreak;\n\t\t\tcase \"low_stock\":\n\t\t\t\twhere.trackStock = true;\n\t\t\t\twhere.stock = { gt: 0, lte: 10 };\n\t\t\t\tbreak;\n\t\t\tcase \"out_of_stock\":\n\t\t\t\twhere.trackStock = true;\n\t\t\t\twhere.stock = 0;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t// Price filter\n\tif (priceMin !== undefined || priceMax !== undefined) {\n\t\twhere.price = {};\n\t\tif (priceMin !== undefined) {\n\t\t\t(where.price as Record<string, number>).gte = priceMin;\n\t\t}\n\t\tif (priceMax !== undefined) {\n\t\t\t(where.price as Record<string, number>).lte = priceMax;\n\t\t}\n\t}\n\n\t// Sorting\n\tconst orderBy: Record<string, string>[] = [];\n\tif (sortBy) {\n\t\tswitch (sortBy) {\n\t\t\tcase \"name_asc\":\n\t\t\tcase \"name_desc\":\n\t\t\t\t// For name sorting, we need to sort by translation\n\t\t\t\t// This is a workaround - ideally we'd join and sort\n\t\t\t\tbreak;\n\t\t\tcase \"price_asc\":\n\t\t\t\torderBy.push({ price: \"asc\" });\n\t\t\t\tbreak;\n\t\t\tcase \"price_desc\":\n\t\t\t\torderBy.push({ price: \"desc\" });\n\t\t\t\tbreak;\n\t\t\tcase \"created_asc\":\n\t\t\t\torderBy.push({ createdAt: \"asc\" });\n\t\t\t\tbreak;\n\t\t\tcase \"created_desc\":\n\t\t\t\torderBy.push({ createdAt: \"desc\" });\n\t\t\t\tbreak;\n\t\t\tcase \"stock_asc\":\n\t\t\t\torderBy.push({ stock: \"asc\" });\n\t\t\t\tbreak;\n\t\t\tcase \"stock_desc\":\n\t\t\t\torderBy.push({ stock: \"desc\" });\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (orderBy.length === 0) {\n\t\torderBy.push({ createdAt: \"desc\" });\n\t}\n\n\tconst [products, total] = await Promise.all([\n\t\tdb.product.findMany({\n\t\t\twhere,\n\t\t\torderBy,\n\t\t\tskip: (page - 1) * pageSize,\n\t\t\ttake: pageSize,\n\t\t\tinclude: {\n\t\t\t\tcategory: {\n\t\t\t\t\tinclude: {\n\t\t\t\t\t\ttranslations: {\n\t\t\t\t\t\t\twhere: { localeId: \"en\" },\n\t\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tbrand: {\n\t\t\t\t\tinclude: {\n\t\t\t\t\t\ttranslations: {\n\t\t\t\t\t\t\twhere: { localeId: \"en\" },\n\t\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\ttranslations: {\n\t\t\t\t\twhere: { localeId: \"en\" },\n\t\t\t\t\ttake: 1,\n\t\t\t\t},\n\t\t\t\tmedia: {\n\t\t\t\t\torderBy: { order: \"asc\" },\n\t\t\t\t\ttake: 1,\n\t\t\t\t},\n\t\t\t},\n\t\t}),\n\t\tdb.product.count({ where }),\n\t]);\n\n\treturn {\n\t\tproducts: products.map((p) => ({\n\t\t\tid: p.id,\n\t\t\tslug: p.slug,\n\t\t\tstatus: p.status,\n\t\t\tprice: p.price,\n\t\t\tcompareAtPrice: p.compareAtPrice,\n\t\t\tsku: p.sku,\n\t\t\ttrackStock: p.trackStock,\n\t\t\tstock: p.stock,\n\t\t\tname: p.translations[0]?.name ?? \"Untitled\",\n\t\t\tdescription: p.translations[0]?.description,\n\t\t\tcategoryId: p.categoryId,\n\t\t\tcategoryName: p.category?.translations[0]?.name ?? \"Uncategorized\",\n\t\t\tbrandId: p.brandId,\n\t\t\tbrandName: p.brand?.translations[0]?.name,\n\t\t\timageUrl: p.media[0]?.url,\n\t\t\tcreatedAt: p.createdAt,\n\t\t\tupdatedAt: p.updatedAt,\n\t\t})),\n\t\tpagination: {\n\t\t\tpage,\n\t\t\tpageSize,\n\t\t\ttotal,\n\t\t\ttotalPages: Math.ceil(total / pageSize),\n\t\t},\n\t};\n}\n\n// Get single product by ID\nexport async function getProduct(productId: string) {\n\tconst { tenantId } = await requireStoreAccess();\n\n\tconst product = await db.product.findFirst({\n\t\twhere: { id: productId, tenantId },\n\t\tinclude: {\n\t\t\ttranslations: true,\n\t\t\tmedia: { orderBy: { order: \"asc\" } },\n\t\t\tvariants: {\n\t\t\t\tinclude: {\n\t\t\t\t\toptionMeta: true,\n\t\t\t\t},\n\t\t\t},\n\t\t\tshippingInfo: true,\n\t\t\tcollectionProducts: {\n\t\t\t\tinclude: {\n\t\t\t\t\tcollection: {\n\t\t\t\t\t\tinclude: {\n\t\t\t\t\t\t\ttranslations: {\n\t\t\t\t\t\t\t\twhere: { localeId: \"en\" },\n\t\t\t\t\t\t\t\ttake: 1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\tif (!product) {\n\t\tthrow new Error(\"Product not found\");\n\t}\n\n\tconst englishTranslation = product.translations.find(\n\t\t(t: { localeId: string }) => t.localeId === \"en\",\n\t);\n\n\treturn {\n\t\tid: product.id,\n\t\tslug: product.slug,\n\t\tstatus: product.status,\n\t\tcategoryId: product.categoryId,\n\t\tbrandId: product.brandId,\n\t\tprice: product.price,\n\t\tcompareAtPrice: product.compareAtPrice,\n\t\tcostPerItem: product.costPerItem,\n\t\tsku: product.sku,\n\t\ttrackStock: product.trackStock,\n\t\tstock: product.stock,\n\t\tlowStockThreshold: product.lowStockThreshold,\n\t\tpurchaseType: product.purchaseType,\n\t\tsubscriptionDiscountPercent: product.subscriptionDiscountPercent,\n\t\tsubscriptionIntervals: product.subscriptionIntervals,\n\t\tpreOrderReleaseDate: product.preOrderReleaseDate,\n\t\tpreOrderDepositPercent: product.preOrderDepositPercent,\n\t\tunitPriceAmount: product.unitPriceAmount,\n\t\tunitPriceMeasurement: product.unitPriceMeasurement,\n\t\tunitPriceBaseAmount: product.unitPriceBaseAmount,\n\t\tunitPriceBaseMeasurement: product.unitPriceBaseMeasurement,\n\t\tname: englishTranslation?.name ?? \"\",\n\t\tdescription: englishTranslation?.description ?? \"\",\n\t\tmedia: product.media.map(\n\t\t\t(m: {\n\t\t\t\tid: string;\n\t\t\t\turl: string;\n\t\t\t\tmediaType: string;\n\t\t\t\taltText: string | null;\n\t\t\t\torder: number;\n\t\t\t}) => ({\n\t\t\t\tid: m.id,\n\t\t\t\turl: m.url,\n\t\t\t\tmediaType: m.mediaType,\n\t\t\t\taltText: m.altText,\n\t\t\t\torder: m.order,\n\t\t\t}),\n\t\t),\n\t\tvariants: product.variants.map(\n\t\t\t(v: {\n\t\t\t\tid: string;\n\t\t\t\tsku: string | null;\n\t\t\t\tprice: unknown;\n\t\t\t\tpriceAdjustment: unknown;\n\t\t\t\tstock: number | null;\n\t\t\t\timageUrl: string | null;\n\t\t\t\toptions: unknown;\n\t\t\t\toptionMeta: unknown[];\n\t\t\t}) => ({\n\t\t\t\tid: v.id,\n\t\t\t\tsku: v.sku,\n\t\t\t\tprice: v.price,\n\t\t\t\tpriceAdjustment: v.priceAdjustment,\n\t\t\t\tstock: v.stock,\n\t\t\t\timageUrl: v.imageUrl,\n\t\t\t\toptions: v.options as Record<string, string>,\n\t\t\t\toptionMeta: v.optionMeta,\n\t\t\t}),\n\t\t),\n\t\tshippingInfo: product.shippingInfo\n\t\t\t? {\n\t\t\t\t\tpackageType: product.shippingInfo.packageType,\n\t\t\t\t\tpackagingWeightKg: product.shippingInfo.packagingWeightKg,\n\t\t\t\t\tpackagingLengthCm: product.shippingInfo.packagingLengthCm,\n\t\t\t\t\tpackagingWidthCm: product.shippingInfo.packagingWidthCm,\n\t\t\t\t\tpackagingHeightCm: product.shippingInfo.packagingHeightCm,\n\t\t\t\t\tproductWeightKg: product.shippingInfo.productWeightKg,\n\t\t\t\t\tproductLengthCm: product.shippingInfo.productLengthCm,\n\t\t\t\t\tproductWidthCm: product.shippingInfo.productWidthCm,\n\t\t\t\t\tproductHeightCm: product.shippingInfo.productHeightCm,\n\t\t\t\t}\n\t\t\t: null,\n\t\tseo: {\n\t\t\tmetaTitle: englishTranslation?.metaTitle,\n\t\t\tmetaDescription: englishTranslation?.metaDescription,\n\t\t\tslug: product.slug,\n\t\t},\n\t\tcollectionIds: product.collectionProducts.map(\n\t\t\t(c: { collectionId: string }) => c.collectionId,\n\t\t),\n\t};\n}\n\n// Create product\nexport async function createProduct(input: CreateProductInput) {\n\tconst { tenantId } = await requireStoreAccess();\n\n\tconst validatedInput = CreateProductSchema.parse(input);\n\n\tconst product = await db.$transaction(async (tx) => {\n\t\t// Create the product\n\t\tconst newProduct = await tx.product.create({\n\t\t\tdata: {\n\t\t\t\ttenantId,\n\t\t\t\tslug: validatedInput.slug,\n\t\t\t\tstatus: validatedInput.status,\n\t\t\t\tcategoryId: validatedInput.categoryId,\n\t\t\t\tbrandId: validatedInput.brandId || null,\n\t\t\t\tprice: validatedInput.price,\n\t\t\t\tcompareAtPrice: validatedInput.compareAtPrice,\n\t\t\t\tcostPerItem: validatedInput.costPerItem,\n\t\t\t\tsku: validatedInput.sku,\n\t\t\t\ttrackStock: validatedInput.trackStock,\n\t\t\t\tstock: validatedInput.stock,\n\t\t\t\tlowStockThreshold: validatedInput.lowStockThreshold,\n\t\t\t\t// Purchase options\n\t\t\t\tpurchaseType: validatedInput.purchaseOptions?.type ?? \"ONE_TIME\",\n\t\t\t\tsubscriptionDiscountPercent:\n\t\t\t\t\tvalidatedInput.purchaseOptions?.subscriptionDiscount,\n\t\t\t\tsubscriptionIntervals:\n\t\t\t\t\tvalidatedInput.purchaseOptions?.subscriptionIntervals ?? [],\n\t\t\t\tpreOrderReleaseDate:\n\t\t\t\t\tvalidatedInput.purchaseOptions?.preOrderReleaseDate,\n\t\t\t\tpreOrderDepositPercent:\n\t\t\t\t\tvalidatedInput.purchaseOptions?.preOrderDepositPercent,\n\t\t\t\t// Unit pricing\n\t\t\t\tunitPriceAmount: validatedInput.unitPrice?.unitPriceAmount,\n\t\t\t\tunitPriceMeasurement: validatedInput.unitPrice?.unitPriceMeasurement,\n\t\t\t\tunitPriceBaseAmount: validatedInput.unitPrice?.unitPriceBaseAmount,\n\t\t\t\tunitPriceBaseMeasurement:\n\t\t\t\t\tvalidatedInput.unitPrice?.unitPriceBaseMeasurement,\n\t\t\t},\n\t\t});\n\n\t\t// Create translation (English by default)\n\t\tawait tx.productTranslation.create({\n\t\t\tdata: {\n\t\t\t\tproductId: newProduct.id,\n\t\t\t\tlocaleId: \"en\",\n\t\t\t\tname: validatedInput.name,\n\t\t\t\tdescription: validatedInput.description,\n\t\t\t\tmetaTitle: validatedInput.seo?.metaTitle,\n\t\t\t\tmetaDescription: validatedInput.seo?.metaDescription,\n\t\t\t},\n\t\t});\n\n\t\t// Create media\n\t\tif (validatedInput.media && validatedInput.media.length > 0) {\n\t\t\tawait tx.productMedia.createMany({\n\t\t\t\tdata: validatedInput.media.map((m, index) => ({\n\t\t\t\t\tproductId: newProduct.id,\n\t\t\t\t\turl: m.url,\n\t\t\t\t\tmediaType: m.mediaType,\n\t\t\t\t\taltText: m.altText,\n\t\t\t\t\torder: m.order ?? index,\n\t\t\t\t})),\n\t\t\t});\n\t\t}\n\n\t\t// Create variants\n\t\tif (validatedInput.variants && validatedInput.variants.length > 0) {\n\t\t\tfor (const variant of validatedInput.variants) {\n\t\t\t\tconst createdVariant = await tx.productVariant.create({\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tproductId: newProduct.id,\n\t\t\t\t\t\tsku: variant.sku,\n\t\t\t\t\t\tprice: variant.price,\n\t\t\t\t\t\tpriceAdjustment: variant.priceAdjustment ?? 0,\n\t\t\t\t\t\tstock: variant.stock,\n\t\t\t\t\t\timageUrl: variant.imageUrl,\n\t\t\t\t\t\toptions: variant.options,\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\t// Create variant option meta (for colors)\n\t\t\t\tif (variant.optionMeta && variant.optionMeta.length > 0) {\n\t\t\t\t\tawait tx.variantOptionMeta.createMany({\n\t\t\t\t\t\tdata: variant.optionMeta.map((meta) => ({\n\t\t\t\t\t\t\tvariantId: createdVariant.id,\n\t\t\t\t\t\t\toptionName: meta.optionName,\n\t\t\t\t\t\t\thexColor: meta.hexColor,\n\t\t\t\t\t\t})),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Create shipping info\n\t\tif (validatedInput.shippingInfo) {\n\t\t\tawait tx.productShippingInfo.create({\n\t\t\t\tdata: {\n\t\t\t\t\tproductId: newProduct.id,\n\t\t\t\t\tpackageType: validatedInput.shippingInfo.packageType,\n\t\t\t\t\tpackagingWeightKg: validatedInput.shippingInfo.weight,\n\t\t\t\t\tpackagingLengthCm: validatedInput.shippingInfo.packageLength,\n\t\t\t\t\tpackagingWidthCm: validatedInput.shippingInfo.packageWidth,\n\t\t\t\t\tpackagingHeightCm: validatedInput.shippingInfo.packageHeight,\n\t\t\t\t\tproductWeightKg: validatedInput.shippingInfo.productWeight,\n\t\t\t\t\tproductLengthCm: validatedInput.shippingInfo.productLength,\n\t\t\t\t\tproductWidthCm: validatedInput.shippingInfo.productWidth,\n\t\t\t\t\tproductHeightCm: validatedInput.shippingInfo.productHeight,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\t// Link to collections\n\t\tif (\n\t\t\tvalidatedInput.collectionIds &&\n\t\t\tvalidatedInput.collectionIds.length > 0\n\t\t) {\n\t\t\tawait tx.collectionProduct.createMany({\n\t\t\t\tdata: validatedInput.collectionIds.map((collectionId) => ({\n\t\t\t\t\tproductId: newProduct.id,\n\t\t\t\t\tcollectionId,\n\t\t\t\t})),\n\t\t\t});\n\t\t}\n\n\t\treturn newProduct;\n\t});\n\n\trevalidatePath(\"/admin/products\");\n\n\treturn { success: true, productId: product.id };\n}\n\n// Update product\nexport async function updateProduct(input: UpdateProductInput) {\n\tconst { tenantId } = await requireStoreAccess();\n\n\tconst validatedInput = UpdateProductSchema.parse(input);\n\n\t// Verify product belongs to tenant\n\tconst existingProduct = await db.product.findFirst({\n\t\twhere: { id: validatedInput.id, tenantId },\n\t});\n\tif (!existingProduct) {\n\t\tthrow new Error(\"Product not found\");\n\t}\n\n\tawait db.$transaction(async (tx) => {\n\t\t// Update the main product\n\t\tawait tx.product.update({\n\t\t\twhere: { id: validatedInput.id },\n\t\t\tdata: {\n\t\t\t\t...(validatedInput.slug && { slug: validatedInput.slug }),\n\t\t\t\t...(validatedInput.status && { status: validatedInput.status }),\n\t\t\t\t...(validatedInput.categoryId && {\n\t\t\t\t\tcategoryId: validatedInput.categoryId,\n\t\t\t\t}),\n\t\t\t\tbrandId: validatedInput.brandId || null,\n\t\t\t\t...(validatedInput.price !== undefined && {\n\t\t\t\t\tprice: validatedInput.price,\n\t\t\t\t}),\n\t\t\t\tcompareAtPrice: validatedInput.compareAtPrice,\n\t\t\t\tcostPerItem: validatedInput.costPerItem,\n\t\t\t\tsku: validatedInput.sku,\n\t\t\t\ttrackStock: validatedInput.trackStock,\n\t\t\t\tstock: validatedInput.stock,\n\t\t\t\tlowStockThreshold: validatedInput.lowStockThreshold,\n\t\t\t\t// Purchase options\n\t\t\t\t...(validatedInput.purchaseOptions && {\n\t\t\t\t\tpurchaseType: validatedInput.purchaseOptions.type,\n\t\t\t\t\tsubscriptionDiscountPercent:\n\t\t\t\t\t\tvalidatedInput.purchaseOptions.subscriptionDiscount,\n\t\t\t\t\tsubscriptionIntervals:\n\t\t\t\t\t\tvalidatedInput.purchaseOptions.subscriptionIntervals ?? [],\n\t\t\t\t\tpreOrderReleaseDate:\n\t\t\t\t\t\tvalidatedInput.purchaseOptions.preOrderReleaseDate,\n\t\t\t\t\tpreOrderDepositPercent:\n\t\t\t\t\t\tvalidatedInput.purchaseOptions.preOrderDepositPercent,\n\t\t\t\t}),\n\t\t\t\t// Unit pricing\n\t\t\t\t...(validatedInput.unitPrice && {\n\t\t\t\t\tunitPriceAmount: validatedInput.unitPrice.unitPriceAmount,\n\t\t\t\t\tunitPriceMeasurement: validatedInput.unitPrice.unitPriceMeasurement,\n\t\t\t\t\tunitPriceBaseAmount: validatedInput.unitPrice.unitPriceBaseAmount,\n\t\t\t\t\tunitPriceBaseMeasurement:\n\t\t\t\t\t\tvalidatedInput.unitPrice.unitPriceBaseMeasurement,\n\t\t\t\t}),\n\t\t\t},\n\t\t});\n\n\t\t// Update translation\n\t\tif (\n\t\t\tvalidatedInput.name ||\n\t\t\tvalidatedInput.description ||\n\t\t\tvalidatedInput.seo\n\t\t) {\n\t\t\tawait tx.productTranslation.upsert({\n\t\t\t\twhere: {\n\t\t\t\t\tproductId_localeId: {\n\t\t\t\t\t\tproductId: validatedInput.id,\n\t\t\t\t\t\tlocaleId: \"en\",\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tupdate: {\n\t\t\t\t\t...(validatedInput.name && { name: validatedInput.name }),\n\t\t\t\t\t...(validatedInput.description !== undefined && {\n\t\t\t\t\t\tdescription: validatedInput.description,\n\t\t\t\t\t}),\n\t\t\t\t\t...(validatedInput.seo?.metaTitle !== undefined && {\n\t\t\t\t\t\tmetaTitle: validatedInput.seo.metaTitle,\n\t\t\t\t\t}),\n\t\t\t\t\t...(validatedInput.seo?.metaDescription !== undefined && {\n\t\t\t\t\t\tmetaDescription: validatedInput.seo.metaDescription,\n\t\t\t\t\t}),\n\t\t\t\t},\n\t\t\t\tcreate: {\n\t\t\t\t\tproductId: validatedInput.id,\n\t\t\t\t\tlocaleId: \"en\",\n\t\t\t\t\tname: validatedInput.name ?? \"Untitled\",\n\t\t\t\t\tdescription: validatedInput.description,\n\t\t\t\t\tmetaTitle: validatedInput.seo?.metaTitle,\n\t\t\t\t\tmetaDescription: validatedInput.seo?.metaDescription,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\t// Update media (replace all)\n\t\tif (validatedInput.media) {\n\t\t\tawait tx.productMedia.deleteMany({\n\t\t\t\twhere: { productId: validatedInput.id },\n\t\t\t});\n\n\t\t\tif (validatedInput.media.length > 0) {\n\t\t\t\tawait tx.productMedia.createMany({\n\t\t\t\t\tdata: validatedInput.media.map((m, index) => ({\n\t\t\t\t\t\tproductId: validatedInput.id,\n\t\t\t\t\t\turl: m.url,\n\t\t\t\t\t\tmediaType: m.mediaType,\n\t\t\t\t\t\taltText: m.altText,\n\t\t\t\t\t\torder: m.order ?? index,\n\t\t\t\t\t})),\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t// Update variants (replace all)\n\t\tif (validatedInput.variants) {\n\t\t\t// Delete existing variants and their meta\n\t\t\tconst existingVariants = await tx.productVariant.findMany({\n\t\t\t\twhere: { productId: validatedInput.id },\n\t\t\t\tselect: { id: true },\n\t\t\t});\n\n\t\t\tfor (const v of existingVariants) {\n\t\t\t\tawait tx.variantOptionMeta.deleteMany({ where: { variantId: v.id } });\n\t\t\t}\n\n\t\t\tawait tx.productVariant.deleteMany({\n\t\t\t\twhere: { productId: validatedInput.id },\n\t\t\t});\n\n\t\t\t// Create new variants\n\t\t\tfor (const variant of validatedInput.variants) {\n\t\t\t\tconst createdVariant = await tx.productVariant.create({\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tproductId: validatedInput.id,\n\t\t\t\t\t\tsku: variant.sku,\n\t\t\t\t\t\tprice: variant.price,\n\t\t\t\t\t\tpriceAdjustment: variant.priceAdjustment ?? 0,\n\t\t\t\t\t\tstock: variant.stock,\n\t\t\t\t\t\timageUrl: variant.imageUrl,\n\t\t\t\t\t\toptions: variant.options,\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\tif (variant.optionMeta && variant.optionMeta.length > 0) {\n\t\t\t\t\tawait tx.variantOptionMeta.createMany({\n\t\t\t\t\t\tdata: variant.optionMeta.map((meta) => ({\n\t\t\t\t\t\t\tvariantId: createdVariant.id,\n\t\t\t\t\t\t\toptionName: meta.optionName,\n\t\t\t\t\t\t\thexColor: meta.hexColor,\n\t\t\t\t\t\t})),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Update shipping info\n\t\tif (validatedInput.shippingInfo) {\n\t\t\tawait tx.productShippingInfo.upsert({\n\t\t\t\twhere: { productId: validatedInput.id },\n\t\t\t\tupdate: {\n\t\t\t\t\tpackageType: validatedInput.shippingInfo.packageType,\n\t\t\t\t\tpackagingWeightKg: validatedInput.shippingInfo.weight,\n\t\t\t\t\tpackagingLengthCm: validatedInput.shippingInfo.packageLength,\n\t\t\t\t\tpackagingWidthCm: validatedInput.shippingInfo.packageWidth,\n\t\t\t\t\tpackagingHeightCm: validatedInput.shippingInfo.packageHeight,\n\t\t\t\t\tproductWeightKg: validatedInput.shippingInfo.productWeight,\n\t\t\t\t\tproductLengthCm: validatedInput.shippingInfo.productLength,\n\t\t\t\t\tproductWidthCm: validatedInput.shippingInfo.productWidth,\n\t\t\t\t\tproductHeightCm: validatedInput.shippingInfo.productHeight,\n\t\t\t\t},\n\t\t\t\tcreate: {\n\t\t\t\t\tproductId: validatedInput.id,\n\t\t\t\t\tpackageType: validatedInput.shippingInfo.packageType,\n\t\t\t\t\tpackagingWeightKg: validatedInput.shippingInfo.weight,\n\t\t\t\t\tpackagingLengthCm: validatedInput.shippingInfo.packageLength,\n\t\t\t\t\tpackagingWidthCm: validatedInput.shippingInfo.packageWidth,\n\t\t\t\t\tpackagingHeightCm: validatedInput.shippingInfo.packageHeight,\n\t\t\t\t\tproductWeightKg: validatedInput.shippingInfo.productWeight,\n\t\t\t\t\tproductLengthCm: validatedInput.shippingInfo.productLength,\n\t\t\t\t\tproductWidthCm: validatedInput.shippingInfo.productWidth,\n\t\t\t\t\tproductHeightCm: validatedInput.shippingInfo.productHeight,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\t// Update collection links\n\t\tif (validatedInput.collectionIds) {\n\t\t\tawait tx.collectionProduct.deleteMany({\n\t\t\t\twhere: { productId: validatedInput.id },\n\t\t\t});\n\n\t\t\tif (validatedInput.collectionIds.length > 0) {\n\t\t\t\tawait tx.collectionProduct.createMany({\n\t\t\t\t\tdata: validatedInput.collectionIds.map((collectionId) => ({\n\t\t\t\t\t\tproductId: validatedInput.id,\n\t\t\t\t\t\tcollectionId,\n\t\t\t\t\t})),\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n\n\trevalidatePath(\"/admin/products\");\n\trevalidatePath(`/admin/products/${validatedInput.id}/edit`);\n\n\treturn { success: true };\n}\n\n// Soft delete product (move to trash)\nexport async function deleteProduct(productId: string) {\n\tconst { tenantId } = await requireStoreAccess();\n\n\t// Verify product belongs to tenant\n\tconst product = await db.product.findFirst({\n\t\twhere: { id: productId, tenantId },\n\t});\n\tif (!product) {\n\t\tthrow new Error(\"Product not found\");\n\t}\n\n\tawait db.product.update({\n\t\twhere: { id: productId },\n\t\tdata: { deletedAt: new Date() },\n\t});\n\n\trevalidatePath(\"/admin/products\");\n\trevalidatePath(\"/admin/products/trash\");\n\n\treturn { success: true };\n}\n\n// Restore product from trash\nexport async function restoreProduct(productId: string) {\n\tconst { tenantId } = await requireStoreAccess();\n\n\t// Verify product belongs to tenant\n\tconst product = await db.product.findFirst({\n\t\twhere: { id: productId, tenantId },\n\t});\n\tif (!product) {\n\t\tthrow new Error(\"Product not found\");\n\t}\n\n\tawait db.product.update({\n\t\twhere: { id: productId },\n\t\tdata: { deletedAt: null },\n\t});\n\n\trevalidatePath(\"/admin/products\");\n\trevalidatePath(\"/admin/products/trash\");\n\n\treturn { success: true };\n}\n\n// Bulk restore products\nexport async function restoreProducts(productIds: string[]) {\n\tconst { tenantId } = await requireStoreAccess();\n\n\tawait db.product.updateMany({\n\t\twhere: { id: { in: productIds }, tenantId },\n\t\tdata: { deletedAt: null },\n\t});\n\n\trevalidatePath(\"/admin/products\");\n\trevalidatePath(\"/admin/products/trash\");\n\n\treturn { success: true };\n}\n\n// Permanently delete product\nexport async function permanentlyDeleteProduct(productId: string) {\n\tconst { tenantId } = await requireStoreAccess();\n\n\t// Verify product belongs to tenant\n\tconst product = await db.product.findFirst({\n\t\twhere: { id: productId, tenantId },\n\t});\n\tif (!product) {\n\t\tthrow new Error(\"Product not found\");\n\t}\n\n\tawait db.$transaction(async (tx) => {\n\t\t// Delete related data\n\t\tconst variants = await tx.productVariant.findMany({\n\t\t\twhere: { productId },\n\t\t\tselect: { id: true },\n\t\t});\n\n\t\tfor (const v of variants) {\n\t\t\tawait tx.variantOptionMeta.deleteMany({ where: { variantId: v.id } });\n\t\t}\n\n\t\tawait tx.productVariant.deleteMany({ where: { productId } });\n\t\tawait tx.productMedia.deleteMany({ where: { productId } });\n\t\tawait tx.productShippingInfo.deleteMany({ where: { productId } });\n\t\tawait tx.productTranslation.deleteMany({ where: { productId } });\n\t\tawait tx.collectionProduct.deleteMany({ where: { productId } });\n\n\t\t// Finally delete the product\n\t\tawait tx.product.delete({ where: { id: productId } });\n\t});\n\n\trevalidatePath(\"/admin/products/trash\");\n\n\treturn { success: true };\n}\n\n// Bulk permanently delete products\nexport async function permanentlyDeleteProducts(productIds: string[]) {\n\tawait requireStoreAccess(); // Verify access, individual deletes check ownership\n\n\tfor (const productId of productIds) {\n\t\tawait permanentlyDeleteProduct(productId);\n\t}\n\n\treturn { success: true };\n}\n\n// Get trashed products\nexport async function getTrashedProducts() {\n\tconst { tenantId } = await requireStoreAccess();\n\n\tconst products = await db.product.findMany({\n\t\twhere: {\n\t\t\ttenantId,\n\t\t\tdeletedAt: { not: null },\n\t\t},\n\t\torderBy: { deletedAt: \"desc\" },\n\t\tinclude: {\n\t\t\ttranslations: {\n\t\t\t\twhere: { localeId: \"en\" },\n\t\t\t\ttake: 1,\n\t\t\t},\n\t\t\tmedia: {\n\t\t\t\torderBy: { order: \"asc\" },\n\t\t\t\ttake: 1,\n\t\t\t},\n\t\t},\n\t});\n\n\treturn products.map((p) => ({\n\t\tid: p.id,\n\t\tname: p.translations[0]?.name ?? \"Untitled\",\n\t\tsku: p.sku,\n\t\tprice: p.price,\n\t\tdeletedAt: p.deletedAt ?? new Date(),\n\t\timageUrl: p.media[0]?.url ?? null,\n\t}));\n}\n\n// Clean up old trashed products (called by cron job)\nexport async function cleanupTrashedProducts(retentionDays = 30) {\n\t// This function should be called by a cron job\n\t// Don't require admin - it runs as a system task\n\n\tconst cutoffDate = new Date();\n\tcutoffDate.setDate(cutoffDate.getDate() - retentionDays);\n\n\tconst oldProducts = await db.product.findMany({\n\t\twhere: {\n\t\t\tdeletedAt: { lte: cutoffDate },\n\t\t},\n\t\tselect: { id: true },\n\t});\n\n\tfor (const product of oldProducts) {\n\t\tawait permanentlyDeleteProduct(product.id);\n\t}\n\n\treturn { deleted: oldProducts.length };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1375, "column": 0}, "map": {"version":3,"sources":["file:///Users/bobkata/Projects/boostcart/apps/platform/.next-internal/server/app/%28internal%29/admin/products/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {getUserStores as '003bfcd7ac293af20dc22123ec44e81263e2c95347'} from 'ACTIONS_MODULE0'\nexport {userHasStore as '00b865bde8853c0b2200356e8a44aabbfda99ded8f'} from 'ACTIONS_MODULE0'\nexport {getCurrentTenant as '00f61908051b9076d3d4981917b5b0f4b9a64a3f03'} from 'ACTIONS_MODULE0'\nexport {createStore as '40177cd97a285945b21e6d3751ddbdc14238608821'} from 'ACTIONS_MODULE0'\nexport {checkSlugAvailability as '40ece7c8b327f75aed046925634f22b2bd96f4eb54'} from 'ACTIONS_MODULE0'\nexport {getCurrentTenant as '00f61908051b9076d3d4981917b5b0f4b9a64a3f03'} from 'ACTIONS_MODULE0'\nexport {deleteProduct as '405d7bf5b1e1ff67b41050f9c6b3b647526820a0d9'} from 'ACTIONS_MODULE1'\nexport {getProducts as '400bf41a515368060d000c008be7121072342d4535'} from 'ACTIONS_MODULE1'\n"],"names":[],"mappings":";AAAA;AAMA"}}]
}